<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Balıkesir Edremit Zeytinli'de Geleceğe Yatırım 240m2 Fırsat Arsa - EMLAKSENDE</title>
    <meta name="description" id="pageDescription" content="Balıkesir Edremit Zeytinli'de geleceğe yatırım yapabileceğiniz 240m2 fırsat arsa. Detaylı bilgi için hemen inceleyin!">
    <meta name="keywords" id="pageKeywords" content="balıkesir, edremit, zeytinli, arsa, yatırım, emlak, fırsat">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw3Z28goiYhTyQxY_zx5eEcx_9I9wMkR4&libraries=geometry&callback=initMap" async defer></script>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">
    
    <style>
        :root {
            --bg: #F3F6F9;
            --ink: #0F2947;
            --muted: #6B7A8C;
            --primary: #142A45;
            --primary-ink: #FFFFFF;
            --chip-green: #86B98A;
            --price-mint: #A7D4B7;
            --card: #FFFFFF;
            --stroke: #E3E8EF;
            --shadow: 0 20px 40px rgba(15,41,71,.08);
            --soft: #F1F5F9;
            --success: #5FB487;
            --danger: #D94B4B;
            --tab-green-bg: #E7F5ED;
            --tab-green-border: #A7D6BD;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg);
            color: var(--ink);
            line-height: 1.7;
            max-width: 100vw;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px;
            box-sizing: border-box;
        }



        /* Breadcrumb */
        .breadcrumb {
            font-size: 12px;
            color: #666;
            margin-top: 30px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            line-height: 1.4;
        }

        .breadcrumb i {
            font-size: 14px;
            color: #666;
            margin-right: 4px;
        }

        .breadcrumb span {
            white-space: nowrap;
        }

        .breadcrumb span:last-child {
            color: #999;
            font-weight: 500;
        }

        /* Main Grid */
        .detail-grid {
            display: grid;
            grid-template-columns: minmax(320px, 380px) minmax(380px, 450px) minmax(280px, 1fr);
            gap: clamp(40px, 4vw, 72px);
            align-items: start;
            justify-content: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 clamp(20px, 3vw, 40px);
            box-sizing: border-box;
        }

        /* Icon Rail - Desktop görünümde başlığın altında */
        .icon-rail-desktop {
            display: flex;
            flex-direction: row;
            gap: 16px;
            margin-bottom: 30px;
            justify-content: flex-start;
        }

        /* Icon Rail - Mobile görünümde gallery içinde */
        .icon-rail-mobile {
            position: absolute;
            left: -80px;
            top: 20px;
            display: none; /* Desktop'ta gizli */
            flex-direction: column;
            gap: 20px;
            z-index: 5;
        }

        /* Gallery */
        .gallery {
            position: relative;
            margin-left: -20px; /* Gallery'yi biraz sola ötele - desktop için */
        }

        .icon-btn {
            width: 48px;
            height: 48px;
            background: var(--card);
            border: 1px solid var(--stroke);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--primary);
        }

        .icon-btn:hover {
            opacity: 0.8;
            transform: translateX(1px);
            box-shadow: var(--shadow);
        }

        .icon-btn svg {
            width: 20px;
            height: 20px;
        }

        .main-image-container {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 32px;
        }

                    .main-image {
                width: 100%;
                height: auto;
                aspect-ratio: 4 / 3;
                object-fit: cover;
                display: block;
                cursor: pointer;
            }

        .tapview-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: var(--chip-green);
            color: white;
            padding: 12px 18px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tapview-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(134, 185, 138, 0.3);
        }

        /* Tapu Modal Styles */
        .modal {
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            animation: slideIn 0.3s ease;
        }

        .modal-close:hover {
            background-color: #f3f4f6 !important;
            color: #374151 !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--primary);
        }

        .gallery-nav:hover {
            background: white;
            box-shadow: var(--shadow);
        }

        .gallery-nav.prev {
            left: 16px;
        }

        .gallery-nav.next {
            right: 16px;
        }

        .gallery-nav svg {
            width: 16px;
            height: 16px;
        }

        .thumbnails {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding: 4px 0;
            margin-bottom: 24px;
        }

        .thumbnail {
            flex-shrink: 0;
            width: 114px;
            height: auto;
            aspect-ratio: 4 / 3;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .thumbnail.active {
            border-color: var(--primary);
        }

        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Property Details */
        .property-details {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin-left: clamp(60px, 6vw, 100px);
        }

        .location {
            font-size: clamp(15px, 1.66vw, 18.2px);
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 8px;
        }

        .price {
            font-size: clamp(18.2px, 2.15vw, 26.5px);
            font-weight: 700;
            color: var(--price-mint);
        }

        .features-table {
            background: transparent;
            border-radius: 0;
            padding: 0;
            box-shadow: none;
        }

        .features-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--ink);
        }

        .feature-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .feature-row:last-child {
            margin-bottom: 0;
        }

        .feature-label {
            color: var(--muted);
            font-size: 13.5px;
        }

        .feature-value {
            color: var(--ink);
            font-size: 13.5px;
            font-weight: 500;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .btn-primary {
            flex: 1;
            background: var(--primary);
            color: var(--primary-ink);
            border: none;
            padding: 11.5px 17.3px;
            border-radius: 12px;
            font-size: 12.4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(20, 42, 69, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 28px rgba(20, 42, 69, 0.3);
        }

        .btn-secondary {
            flex: 1;
            background: var(--card);
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 11.5px 17.3px;
            border-radius: 12px;
            font-size: 12.4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: var(--primary-ink);
        }

        .btn-secondary svg {
            width: 16px;
            height: 16px;
            transition: transform 0.3s ease;
        }

        .btn-secondary.active svg {
            transform: rotate(180deg);
        }

        .contact-buttons {
            display: flex;
            gap: 12px;
        }

        .contact-btn {
            width: 44px;
            height: 44px;
            background: rgba(20, 42, 69, 0.1);
            border: none;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--chip-green);
        }

        .contact-btn:hover {
            transform: translateY(-2px);
            background: rgba(20, 42, 69, 0.15);
        }

        .contact-btn svg {
            width: 20px;
            height: 20px;
        }

        /* Details Dropdown */
        .details-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--card);
            border: 1px solid var(--stroke);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow);
            z-index: 10;
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .details-dropdown.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .details-dropdown ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .details-dropdown li {
            padding: 8px 0;
            color: var(--muted);
            font-size: 13px;
            border-bottom: 1px solid var(--stroke);
        }

        .details-dropdown li:last-child {
            border-bottom: none;
        }

        /* Right Panel */
        .valuation-panel {
            background: var(--primary);
            color: var(--primary-ink);
            border-radius: clamp(20px, 3.5vw, 28px);
            padding: clamp(24px, 3vw, 32px) clamp(20px, 2.5vw, 28px);
            box-shadow: 0 24px 48px rgba(20, 42, 69, 0.2);
            position: sticky;
            top: clamp(24px, 4vw, 32px);
            margin-left: clamp(30px, 2vw, 30px); /* Önceden: clamp(60px, 6vw, 120px) */
            width: clamp(280px, 25vw, 320px);
            justify-self: start;
            max-width: 100%;
            box-sizing: border-box;
            overflow: visible; /* Tooltip'lerin tam görünmesi için visible yapıldı */
        }

        .valuation-title {
            text-align: center;
            font-size: clamp(18px, 2.5vw, 20.7px);
            font-weight: 700;
            margin-bottom: clamp(20px, 3vw, 24px);
        }

        .chart-placeholder {
            width: clamp(180px, 20vw, 220px);
            height: clamp(140px, 18vw, 180px);
            background: #ffffff;
            border-radius: clamp(16px, 2.5vw, 20px);
            margin: 0 auto clamp(20px, 3vw, 24px) auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(11px, 1.5vw, 13px);
            color: #666;
            position: relative;
            overflow: visible; /* Tooltip'lerin tam görünmesi için visible yapıldı */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            min-width: 0;
            min-height: 0;
        }

        .fake-chart {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            padding: clamp(16px, 2.5vw, 20px);
            box-sizing: border-box;
            min-width: 0;
        }

        .chart-bar {
            width: clamp(20px, 2.5vw, 24px);
            background: #007AFF;
            border-radius: 4px 4px 0 0;
            animation: growUp 2s ease-out;
            box-shadow: 0 2px 4px rgba(0, 122, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-width: 0;
        }

        .chart-label {
            display: none;
        }

        .chart-bar:hover {
            background: #0056CC;
            transform: scale(1.1);
        }

        .chart-bar:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 9999; /* Daha yüksek z-index */
            margin-bottom: 8px;
            /* Tooltip'in tam görünmesi için overflow kontrolü */
            max-width: 200px;
            word-wrap: break-word;
            white-space: normal;
            text-align: center;
            /* Tooltip'in tam görünmesi için ek özellikler */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            pointer-events: none; /* Tooltip'in hover olaylarını engellemesini önler */
        }

        .chart-bar:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.9);
            margin-bottom: 3px;
            z-index: 9999; /* Arrow'ın da yüksek z-index'e sahip olması */
            pointer-events: none; /* Arrow'ın da hover olaylarını engellemesini önler */
        }

        .chart-bar:nth-child(1) { height: 60%; }
        .chart-bar:nth-child(2) { height: 75%; }
        .chart-bar:nth-child(3) { height: 90%; }

        @keyframes growUp {
            from { height: 0; }
            to { height: var(--final-height); }
        }

        .forecast-title {
            font-size: clamp(15px, 2.2vw, 17.3px);
            font-weight: 600;
            margin-bottom: clamp(14px, 2.5vw, 16px);
            text-align: center;
        }

        .forecast-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .forecast-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: clamp(14px, 2vw, 16.1px);
        }

        .forecast-period {
            color: rgba(255, 255, 255, 0.8);
        }

        .forecast-price {
            font-weight: 600;
        }

        /* Desktop Header Fix */
        @media (min-width: 1200px) {
            .nav-logo {
                margin-left: 0;
            }
            
            .nav-search {
                margin-left: 0;
                justify-content: center;
            }
            
            .nav-menu {
                margin-left: 0px;
            }
            
            .nav {
                padding: 0 40px;
            }
            
            /* Desktop için main image container %30 daha büyük */
            .main-image-container {
                width: 130%; /* %30 daha büyük */
                max-width: 130%;
            }
            
            /* Desktop için property-details'i responsive margin */
            .property-details {
                margin-left: clamp(60px, 6vw, 100px);
            }
        }

        /* Header responsive */
        @media (max-width: 1199px) {
            .nav-right {
                gap: 32px;
            }
            
            .nav-search {
                display: none;
            }
            
            .nav-menu {
                gap: 24px;
            }
            
            /* Header fixes for tablet */
            .nav-logo {
                margin-left: 0;
            }
            
            .nav {
                padding: 0 20px;
            }
            
            /* Tablet görünümde breadcrumb ve page-title'ı main image ile aynı hizada yap */
            .breadcrumb {
                padding-left: clamp(20px, 3vw, 40px); /* main image ile aynı hizada */
            }
            
            .page-title {
                padding-left: clamp(20px, 3vw, 40px); /* main image ile aynı hizada */
            }
        }

        /* Mobile Toggle Button Styles */
        .mobile-toggle {
            display: none;
            flex-direction: column;
            gap: 4px;
            background: transparent;
            padding: 8px;
            border: none;
            cursor: pointer;
        }

        .hamburger-line {
            width: 24px;
            height: 3px;
            background-color: #ffffff;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        /* Hamburger to X animation */
        .mobile-toggle.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .mobile-toggle.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }

        .mobile-toggle.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }

        @media (max-width: 767px) {
            .mobile-toggle {
                display: none !important;
            }
            
            /* Header fixes for mobile */
            .nav-logo {
                margin-left: 0 !important;
                flex-shrink: 0;
            }
            
            .nav-search {
                display: none !important;
            }
            
            .nav {
                justify-content: space-between !important;
                padding: 0 16px !important;
            }
            
            .logo-image {
                height: 50px !important;
            }
            
            /* Mobile Navigation Menu */
            .nav-menu {
                position: fixed;
                top: 80px;
                right: -300px; /* Menüyü tamamen gizlemek için sağa kaydır */
                width: 280px;
                height: 320px;
                background-color: rgba(20, 39, 78, 0.95);
                backdrop-filter: blur(10px);
                flex-direction: column;
                padding: 20px;
                gap: 16px;
                transition: right 0.3s ease;
                border-radius: 12px;
                display: flex;
                z-index: 999;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            }
            
            .nav-menu.active {
                right: 20px; /* Menü açıldığında sağdan 20px içeride göster */
            }
            
            .nav-link {
                padding: 12px 20px !important;
                font-size: 16px !important;
                border-radius: 8px !important;
            }
        }

        /* Responsive */
        @media (max-width: 1279px) {
            .detail-grid {
                grid-template-columns: 1fr minmax(400px, 500px);
                gap: clamp(24px, 3vw, 36px);
                padding: 0 clamp(16px, 2vw, 20px);
            }

            .icon-rail-mobile {
                left: clamp(-60px, -5vw, -70px);
            }

            .valuation-panel {
                grid-column: 1 / -1;
                margin-top: clamp(32px, 4vw, 40px);
                margin-left: 0; /* Tablet'te margin sıfırla */
                width: 100%;
                max-width: 500px;
                margin-left: auto;
                margin-right: auto;
            }
        }

        @media (max-width: 1023px) {
            .detail-grid {
                grid-template-columns: 1fr;
                gap: clamp(24px, 3vw, 32px);
                padding: 0 clamp(16px, 2vw, 24px);
            }

            .icon-rail-desktop {
                display: none; /* Tablet'te gizle */
            }
            
            .icon-rail-mobile {
                position: static;
                flex-direction: row;
                justify-content: center;
                order: 4;
                left: auto;
                top: auto;
                display: flex; /* Tablet'te göster */
            }

            .gallery {
                order: 1;
            }

            .property-details {
                order: 2;
                margin-left: 0;
            }

            .valuation-panel {
                order: 3;
                position: static;
                margin-top: 0;
                width: 100%;
                max-width: 600px;
                margin-left: auto;
                margin-right: auto;
            }
        }

        @media (max-width: 767px) {
            .container {
                padding: 0 clamp(12px, 2vw, 16px);
                max-width: 100%;
                overflow-x: hidden;
            }

            .page-title {
                margin: clamp(16px, 3vw, 20px) 0 clamp(12px, 2vw, 16px) 0;
                font-size: clamp(18px, 4vw, 24px);
                padding-left: clamp(12px, 2vw, 16px); /* main image ile aynı hizada */
            }

            .detail-grid {
                gap: clamp(16px, 3vw, 20px);
                grid-template-columns: 1fr !important;
                max-width: 100%;
                overflow: visible !important;
                padding: 0 clamp(12px, 2vw, 16px);
            }

            .gallery {
                max-width: 100%;
                overflow: hidden;
                display: flex !important;
                flex-direction: column !important;
                margin-left: 0; /* Mobile'da margin sıfırla */
            }

            .main-image-container {
                max-width: 100%;
                overflow: hidden;
            }

            .main-image {
                height: auto;
                width: 100%;
                max-width: 100%;
                aspect-ratio: 4 / 3;
                object-fit: cover;
            }

            .property-details {
                margin-left: 0 !important;
                max-width: 100%;
                overflow: visible !important;
            }

            .action-buttons {
                flex-direction: row;
                justify-content: center;
                gap: 12px;
                max-width: 100%;
                margin-bottom: 80px; /* Sabit menü için boşluk */
            }

            .action-buttons .btn-primary,
            .action-buttons .btn-secondary {
                flex: 1;
                max-width: 150px;
            }

            .contact-buttons {
                display: none; /* Mobilde gizle, sabit menü kullan */
            }

            .mobile-contact-menu {
                display: block !important; /* Mobilde göster */
            }

            body {
                padding-bottom: 80px; /* Sabit menü için ekstra alan */
            }

            .features-table {
                padding: 20px;
                max-width: 100%;
                overflow: visible !important;
            }

            /* Mobil görünümde propertyLocation ve propertyPrice başlıklarını features-title ile aynı hizada yap */
            .property-details > div:first-child {
                padding-left: 20px; /* features-table ile aynı padding */
            }

            .valuation-panel {
                padding: clamp(20px, 3vw, 24px) clamp(16px, 2.5vw, 20px);
                margin-left: 0 !important;
                width: 100% !important;
                max-width: 100%;
                box-sizing: border-box;
            }

            .thumbnails {
                overflow-x: scroll;
                -webkit-overflow-scrolling: touch;
                max-width: 100%;
            }

            .icon-rail-desktop {
                display: none !important; /* Mobile'da gizle */
            }
            
            .icon-rail-mobile {
                position: static !important;
                left: auto !important;
                top: auto !important;
                flex-direction: row !important;
                justify-content: center !important;
                margin: 20px 0;
                max-width: 100%;
                order: 4; /* Thumbnails'in altına taşı */
                display: flex !important; /* Mobile'da göster */
            }

            .main-image-container {
                order: 1; /* Görseli üste al */
            }

            .thumbnails {
                order: 3; /* Thumbnails en alta */
            }

            .breadcrumb {
                font-size: 11px;
                flex-wrap: wrap;
                gap: 4px;
                max-width: 100%;
                overflow-x: hidden;
                padding-left: clamp(12px, 2vw, 16px); /* main image ile aynı hizada */
            }

            .breadcrumb span {
                white-space: normal;
                word-break: break-word;
            }
        }

        /* Additional mobile responsive fixes */
        @media (max-width: 480px) {
            .container {
                padding: 0 clamp(8px, 2vw, 12px);
            }

            .ozellikler-container {
                padding: 0 clamp(8px, 2vw, 12px);
            }

            .detail-grid {
                gap: clamp(12px, 3vw, 16px);
            }

            .main-image {
                height: auto;
                aspect-ratio: 4 / 3;
            }

            .valuation-panel {
                padding: clamp(16px, 3vw, 20px) clamp(12px, 2.5vw, 16px);
                border-radius: clamp(16px, 3vw, 20px);
            }

            .chart-placeholder {
                width: clamp(120px, 25vw, 140px);
                height: clamp(80px, 20vw, 100px);
            }

            .chart-bar {
                width: clamp(16px, 4vw, 20px);
            }

            .page-title {
                font-size: clamp(14px, 4vw, 16px) !important;
                margin-bottom: clamp(16px, 3vw, 20px);
                padding-left: clamp(8px, 2vw, 12px); /* main image ile aynı hizada */
            }

            .breadcrumb {
                font-size: clamp(9px, 2.5vw, 10px);
                margin-top: clamp(16px, 3vw, 20px);
                padding-left: clamp(12px, 2vw, 16px); /* main image ile aynı hizada */
            }

            .property-details {
                gap: clamp(16px, 3vw, 20px);
            }

            .features-table {
                padding: clamp(12px, 3vw, 16px);
            }

            /* Küçük mobil ekranlarda da propertyLocation ve propertyPrice başlıklarını features-title ile aynı hizada yap */
            .property-details > div:first-child {
                padding-left: clamp(12px, 3vw, 16px); /* features-table ile aynı padding */
            }

            .feature-row {
                margin-bottom: clamp(8px, 2vw, 10px);
            }

            .action-buttons {
                gap: clamp(8px, 2vw, 10px);
            }

            .contact-buttons {
                gap: clamp(8px, 2vw, 10px);
            }
        }

        /* ===== DESCRIPTION SECTION ===== */
        .description-section {
            padding: 80px 0 40px 0;
            background-color: var(--bg);
        }

        .description-title {
            text-align: left;
            font-size: clamp(16.9px, 2.31vw, 18.5px);
            font-weight: 700;
            color: #0B2447;
            margin-bottom: 30px;
        }

        .description-card {
            width: 100%;
            margin: 0;
            background: var(--card);
            border-radius: 20px;
            padding: 40px 24px;
            box-shadow: var(--shadow);
        }

        .description-heading {
            font-size: 15.4px;
            font-weight: 600;
            color: #0B2447;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .description-intro {
            font-size: 11.6px;
            color: #555;
            line-height: 1.7;
            margin-bottom: 30px;
            font-style: italic;
        }

        .description-subtitle {
            font-size: 12.3px;
            font-weight: 700;
            color: #0B2447;
            margin: 30px 0 15px 0;
            line-height: 1.4;
        }

        .description-text {
            font-size: 10.8px;
            color: #555;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .description-list {
            list-style: none;
            padding: 0;
            margin: 0 0 25px 0;
        }

        .description-list li {
            font-size: 10.8px;
            color: #555;
            line-height: 1.7;
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
        }

        .description-list li::before {
            content: "·";
            position: absolute;
            left: 0;
            top: 0;
            font-weight: bold;
            color: #0B2447;
            font-size: 18px;
        }

        /* Description responsive */
        @media (max-width: 767px) {
            .description-section {
                padding: 60px 0 30px 0;
            }

            .description-card {
                margin: 0;
                padding: 30px 24px;
                border-radius: 16px;
                max-width: 100%;
                box-sizing: border-box;
                overflow-x: hidden;
            }

            .description-heading {
                font-size: 18px;
                word-wrap: break-word;
            }

            .description-subtitle {
                font-size: 16px;
                margin: 25px 0 12px 0;
                word-wrap: break-word;
            }

            .description-text,
            .description-list li {
                font-size: 13px;
                word-wrap: break-word;
            }

            .description-list li {
                padding-left: 16px;
                margin-bottom: 10px;
            }
        }

        /* ===== ÖZELLIKLER SECTION ===== */
        .ozellikler-section {
            padding: 40px 0 80px 0;
            background-color: var(--bg);
        }

        .ozellikler-card {
            background: var(--card);
            border-radius: 20px;
            padding: 40px 24px;
            box-shadow: var(--shadow);
            margin: 0 auto;
        }

        .ozellikler-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 24px;
            box-sizing: border-box;
        }

        .ozellikler-title {
            font-size: clamp(16px, 1.76vw, 22.4px);
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 40px;
        }

        .ozellikler-grid {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 40px;
            align-items: start;
        }

        .ozellikler-left {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .feature-group {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .feature-group-title {
            font-size: clamp(12.8px, 1.28vw, 14.4px);
            font-weight: 600;
            color: var(--ink);
        }

        .feature-panel {
            background: var(--soft);
            border: 1px solid var(--stroke);
            border-radius: 16px;
            padding: 24px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 18px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 12px;
            line-height: 1.6;
            color: var(--ink);
        }

        .feature-icon {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .feature-icon.available {
            color: #10b981; /* Yeşil - True için */
        }

        .feature-icon.unavailable {
            color: #9ca3af; /* Gri - False için */
        }

        /* Map Card */
        .map-card {
            background: var(--card);
            border: 1px solid var(--stroke);
            border-radius: 18px;
            padding: 12px;
            box-shadow: 0 10px 24px rgba(15,41,71,.06);
            position: sticky;
            top: 32px;
        }

        .map-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .map-tab {
            background: var(--card);
            border: 1px solid var(--stroke);
            border-radius: 12px;
            padding: 8px 16px;
            font-size: 11.2px;
            font-weight: 500;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .map-tab.active {
            background: var(--tab-green-bg);
            border-color: var(--tab-green-border);
            color: var(--ink);
        }

        .map-container {
            position: relative;
            height: 280px;
            border-radius: 12px;
            overflow: hidden;
        }

        .map-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 12px;
        }

        /* Tabs Section */
        .tabs-section {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .feature-tabs {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .feature-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--card);
            border: 1px solid var(--stroke);
            border-radius: 12px;
            padding: 12px 18px;
            font-size: 12px;
            font-weight: 500;
            color: var(--ink);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-tab.active {
            background: var(--tab-green-bg);
            border-color: var(--tab-green-border);
        }

        .feature-tab-icon {
            width: 16px;
            height: 16px;
        }

        .tab-content {
            background: var(--soft);
            border: 1px solid var(--stroke);
            border-radius: 16px;
            padding: 24px;
            min-height: 120px;
        }

        .distance-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .distance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            line-height: 1.6;
            color: var(--ink);
            border-bottom: 1px dotted var(--stroke);
            padding-bottom: 8px;
        }

        .distance-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .distance-label {
            font-weight: 500;
        }

        .distance-value {
            font-weight: 600;
            color: var(--muted);
        }

        /* Responsive */
        @media (max-width: 1279px) {
            .ozellikler-grid {
                grid-template-columns: 1fr;
                gap: 32px;
            }

            .map-card {
                position: static;
                order: 1;
            }

            .ozellikler-left {
                order: 2;
            }
        }

        @media (max-width: 1023px) {
            .feature-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
        }

        @media (max-width: 767px) {
            .ozellikler-container {
                padding: 0 clamp(12px, 2vw, 16px);
                max-width: 100%;
                overflow-x: hidden;
            }

            .ozellikler-section {
                padding: 30px 0 60px 0;
            }

            .ozellikler-card {
                max-width: 100%;
                box-sizing: border-box;
                overflow-x: hidden;
            }

            .ozellikler-title {
                margin-bottom: 32px;
                word-wrap: break-word;
            }

            .ozellikler-grid {
                grid-template-columns: 1fr !important;
                gap: 24px;
                max-width: 100%;
            }

            .feature-grid {
                grid-template-columns: 1fr;
                gap: 14px;
                max-width: 100%;
            }

            .feature-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
                max-width: 100%;
            }

            .feature-tabs::-webkit-scrollbar {
                display: none;
            }

            .feature-tab {
                flex-shrink: 0;
                white-space: nowrap;
            }

            .map-card {
                max-width: 100%;
                box-sizing: border-box;
            }

            .map-container {
                height: 220px;
                max-width: 100%;
            }

            .map-iframe {
                max-width: 100%;
                box-sizing: border-box;
            }

            .tab-content {
                max-width: 100%;
                overflow-x: hidden;
                box-sizing: border-box;
            }
        }












        .whatsapp-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
            color: #ffffff;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
        }

        .whatsapp-btn:hover {
            background: linear-gradient(135deg, #128c7e 0%, #075e54 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(37, 211, 102, 0.4);
        }

        .whatsapp-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .whatsapp-icon svg {
            width: 100%;
            height: 100%;
        }


        .yamanof-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
        }

        .yamanof-text {
            display: flex;
            flex-direction: column;
        }

        .yamanof-title {
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
            line-height: 1.2;
        }

        .yamanof-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.2;
        }

        /* Description Loading State */
        .description-loading {
            padding: 60px 20px;
            text-align: center;
            color: #666;
            font-style: italic;
        }
        
        /* Map Title */
        .map-title {
            font-size: clamp(12.8px, 1.28vw, 14.4px);
            font-weight: 600;
            color: var(--ink);
        }

        /* Image Modal */
        .image-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .image-modal.show {
            display: flex;
        }

        .modal-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .modal-image {
                width: 100%;
            height: auto;
            max-height: 80vh;
            object-fit: contain;
        }

        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--primary);
        }

        .modal-nav:hover {
            background: white;
            transform: translateY(-50%) scale(1.1);
        }

        .modal-nav.prev {
            left: 20px;
        }

        .modal-nav.next {
            right: 20px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
                justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: var(--primary);
        }

        .modal-close:hover {
            background: white;
        }

        /* Mobile Fixed Contact Menu */
        .mobile-contact-menu {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            padding: 16px;
            z-index: 1000;
            border-top: 1px solid #e0e0e0;
        }

        .mobile-contact-buttons {
            display: flex;
            gap: 12px;
            max-width: 100%;
        }

        .mobile-contact-btn {
            flex: 1;
            padding: 14px 16px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .mobile-contact-btn.primary {
            background: var(--primary);
            color: white;
        }

        .mobile-contact-btn.whatsapp {
            background: #25d366;
            color: white;
        }

        .mobile-contact-btn.phone {
            background: #007AFF;
            color: white;
        }

        .mobile-contact-btn:hover {
            transform: translateY(-2px);
        }

        /* Desktop için mobil menüyü gizle */
        @media (min-width: 768px) {
            .mobile-contact-menu {
                display: none !important;
            }
            
            .mobile-toggle {
                display: none !important;
            }
            
            .nav-menu {
                position: static !important;
                transform: none !important;
                background-color: transparent !important;
                flex-direction: row !important;
                padding: 0 !important;
                gap: 24px !important;
                display: flex !important;
                width: auto !important;
                border-top: none !important;
            }
            
            body {
                padding-bottom: 0;
            }
        }
    </style>
    </style>
</head>

<body>
   

                <!-- Mobile Menu Toggle -->
                <button class="mobile-toggle" id="mobileToggle" aria-label="Menü">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </nav>
        </div>
    </header>



    <main class="container">
        <div class="breadcrumb">
            <i class="fas fa-home"></i>
            <span>İlanlar</span> > 
            <span id="breadcrumbCity">Yükleniyor...</span> > 
            <span id="breadcrumbDistrict">...</span> > 
            <span id="breadcrumbNeighborhood">...</span> > 
            <span id="breadcrumbTitle">İlan detayları yükleniyor...</span>
        </div>
        <h1 class="page-title" style="font-size: 23px; margin-bottom: 20px;" id="pageTitle">Yükleniyor...</h1>
        
        <!-- Icon Rail - Desktop görünümde başlığın altında -->
        <div class="icon-rail-desktop">
            <button class="icon-btn" aria-label="Yazdır">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 8H5C3.34 8 2 9.34 2 11V17H6V21H18V17H22V11C22 9.34 20.66 8 19 8ZM16 19H8V14H16V19ZM19 12C18.45 12 18 11.55 18 11S18.45 10 19 10 20 10.45 20 11 19.55 12 19 12ZM18 3H6V7H18V3Z"/>
                </svg>
            </button>
            <button class="icon-btn" aria-label="Paylaş">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12S8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5S19.66 2 18 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12S4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.92 18 21.92S20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z"/>
                </svg>
            </button>
        </div>
        
        <div class="detail-grid">
            <!-- Gallery -->
            <div class="gallery">
                <!-- Icon Rail - Mobile görünümde gallery içinde -->
                <div class="icon-rail-mobile">
                    <button class="icon-btn" aria-label="Yazdır">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 8H5C3.34 8 2 9.34 2 11V17H6V21H18V17H22V11C22 9.34 20.66 8 19 8ZM16 19H8V14H16V19ZM19 12C18.45 12 18 11.55 18 11S18.45 10 19 10 20 10.45 20 11 19.55 12 19 12ZM18 3H6V7H18V3Z"/>
                        </svg>
                    </button>
                    <button class="icon-btn" aria-label="Paylaş">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12S8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5S19.66 2 18 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12S4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.92 18 21.92S20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z"/>
                        </svg>
                    </button>
                </div>
                <div class="main-image-container">
                    <img id="mainImage" class="main-image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjQwMCIgaGVpZ2h0PSIzMDAiIGZpbGw9IiNGNUY1RjUiLz48dGV4dCB4PSIyMDAiIHk9IjE1MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE2IiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+R8O2cnNlbCBZw7xrbGVuaXlvci4uLjwvdGV4dD48L3N2Zz4=" alt="Görsel Yükleniyor">
                    <button class="tapview-btn">Tapuyu Görüntüle</button>
                    <button class="gallery-nav prev" aria-label="Önceki Görsel">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12Z"/>
                        </svg>
                    </button>
                    <button class="gallery-nav next" aria-label="Sonraki Görsel">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8.59 16.59L10 18L16 12L10 6L8.59 7.41L13.17 12Z"/>
                        </svg>
                    </button>
                </div>
                <div class="thumbnails" id="thumbnailsContainer">
                    <div style="padding: 20px; text-align: center; color: #999; font-size: 14px;">
                        Görseller yükleniyor...
                    </div>
                </div>
            </div>

            <!-- Property Details -->
            <div class="property-details">
                <div>
                    <h2 class="location" id="propertyLocation">Konum yükleniyor...</h2>
                    <div class="price" id="propertyPrice">Fiyat yükleniyor...</div>
                </div>

                <div class="features-table">
                    <h3 class="features-title">İlan Bilgileri</h3>
                    <div class="feature-row">
                        <span class="feature-label">İlan No</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">İmar Durumu</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Metrekare</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Metrekare Fiyat</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Ada No</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Parsel No</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Kaks</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Gabari</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                    <div class="feature-row">
                        <span class="feature-label">Tapu Durumu</span>
                        <span class="feature-value">Yükleniyor...</span>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-primary">İletişime Geç</button>
                    <div style="position: relative;">
                        <button class="btn-secondary" id="detailsBtn">
                            Detayları Gör
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7.41 8.59L12 13.17L16.59 8.59L18 10L12 16L6 10L7.41 8.59Z"/>
                            </svg>
                        </button>
                        <div class="details-dropdown" id="detailsDropdown">
                            <ul>
                                <li>Kat Planları</li>
                                <li>Çevre Analizi</li>
                                <li>Yasal Durumlar</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="contact-buttons">
                    <button class="contact-btn" aria-label="Telefon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6.62 10.79C8.06 13.62 10.38 15.94 13.21 17.38L15.41 15.18C15.68 14.91 16.08 14.82 16.43 14.94C17.55 15.31 18.76 15.51 20 15.51C20.55 15.51 21 15.96 21 16.51V20C21 20.55 20.55 21 20 21C10.61 21 3 13.39 3 4C3 3.45 3.45 3 4 3H7.5C8.05 3 8.5 3.45 8.5 4C8.5 5.25 8.7 6.45 9.07 7.57C9.18 7.92 9.1 8.31 8.82 8.59L6.62 10.79Z"/>
                        </svg>
                    </button>
                    <button class="contact-btn" aria-label="WhatsApp">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.472 14.382C17.175 14.233 15.714 13.515 15.442 13.415C15.171 13.316 14.973 13.267 14.774 13.565C14.576 13.862 14.009 14.531 13.836 14.729C13.663 14.928 13.49 14.952 13.193 14.803C12.896 14.654 11.939 14.341 10.747 13.266C9.83 12.428 9.233 11.407 9.06 11.11C8.887 10.812 9.042 10.653 9.191 10.505C9.326 10.37 9.49 10.154 9.639 9.981C9.787 9.807 9.836 9.685 9.935 9.486C10.034 9.288 9.985 9.115 9.91 8.966C9.836 8.817 9.239 7.355 8.984 6.759C8.737 6.18 8.487 6.259 8.305 6.249C8.132 6.24 7.934 6.238 7.736 6.238C7.538 6.238 7.218 6.312 6.946 6.61C6.675 6.907 5.935 7.625 5.935 9.087C5.935 10.549 7 11.961 7.148 12.159C7.297 12.358 9.393 15.359 12.47 16.646C13.179 16.952 13.731 17.135 14.163 17.261C14.875 17.488 15.53 17.456 16.041 17.371C16.612 17.277 17.77 16.645 18.018 15.951C18.266 15.257 18.266 14.666 18.192 14.517C18.118 14.368 17.92 14.293 17.622 14.145L17.472 14.382ZM12.05 21.785H12.046C10.171 21.784 8.334 21.281 6.741 20.336L6.38 20.125L2.639 21.107L3.633 17.469L3.403 17.094C2.378 15.455 1.833 13.543 1.834 11.582C1.836 6.085 6.172 1.75 11.67 1.75C14.339 1.751 16.84 2.781 18.707 4.648C20.574 6.516 21.603 9.017 21.602 11.686C21.6 17.183 17.264 21.518 11.767 21.518L12.05 21.785Z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Valuation Panel -->
            <div class="valuation-panel">
                <h3 class="valuation-title">Mülk Değerlendirmesi</h3>
                <div class="chart-placeholder">
                    <div class="fake-chart">
                        <div class="chart-bar" data-year="1">
                            <span class="chart-label">1. sene</span>
                        </div>
                        <div class="chart-bar" data-year="2">
                            <span class="chart-label">2. sene</span>
                        </div>
                        <div class="chart-bar" data-year="3">
                            <span class="chart-label">3. sene</span>
                        </div>
                    </div>
                </div>
                <h4 class="forecast-title">Ön Görülen Fiyat Artışı</h4>
                <div class="forecast-list">
                    <div class="forecast-item">
                        <span class="forecast-period">3. Ay</span>
                        <span class="forecast-price">Yükleniyor...</span>
                    </div>
                    <div class="forecast-item">
                        <span class="forecast-period">6. Ay</span>
                        <span class="forecast-price">Yükleniyor...</span>
                    </div>
                    <div class="forecast-item">
                        <span class="forecast-period">12. Ay</span>
                        <span class="forecast-price">Yükleniyor...</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Description Section -->
    <section class="description-section">
        <div class="container">
            <div class="description-card">
                <h2 class="description-title">Açıklama</h2>
                <div id="dynamicDescription">
                    <!-- Dynamic content will be loaded here from Firebase -->
                    <div class="description-loading">
                        <p>Açıklama yükleniyor...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Özellikler Section -->
    <section id="ozellikler" class="ozellikler-section">
        <div class="ozellikler-container">
            <div class="ozellikler-card">
            <h2 class="ozellikler-title">Özellikler</h2>
            
            <div class="ozellikler-grid">
                <!-- Left Content -->
                <div class="ozellikler-left">
                    <!-- Alt yapı -->
                    <div class="feature-group">
                        <h3 class="feature-group-title">Alt yapı</h3>
                        <div class="feature-panel">
                            <div class="feature-grid">
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Elektrik</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Sanayi Elektriği</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Su</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Telefon</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Doğalgaz</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Kanalizasyon</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Arıtma</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Sondaj & Kuyu</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon available" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m5 9 2 2 6-6" stroke="currentColor" stroke-width="2" fill="none"/>
                                    </svg>
                                    <span>Zemin Etüdü</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon available" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m5 9 2 2 6-6" stroke="currentColor" stroke-width="2" fill="none"/>
                                    </svg>
                                    <span>Yolu Açılmış</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Yolu Açılmamış</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Yolu Yok</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Konum -->
                    <div class="feature-group">
                        <h3 class="feature-group-title">Konum</h3>
                        <div class="feature-panel">
                            <div class="feature-grid">
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Anayola Yakın</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Denize Sıfır</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>İtfaiye Yakın</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Havalimanı Yakın</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Toplu Ulaşıma Yakın</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Denize Yakın</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Hastane Yakın</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Su Kaynağına Yakın</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Genel Özellikler -->
                    <div class="feature-group">
                        <h3 class="feature-group-title">Genel Özellikler</h3>
                        <div class="feature-panel">
                            <div class="feature-grid">
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>İfrazlı</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon unavailable" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    <span>Parselli</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon available" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m5 9 2 2 6-6" stroke="currentColor" stroke-width="2" fill="none"/>
                                    </svg>
                                    <span>Projeli</span>
                                </div>
                                <div class="feature-item">
                                    <svg class="feature-icon available" aria-hidden="true" viewBox="0 0 18 18" fill="currentColor">
                                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                        <path d="m5 9 2 2 6-6" stroke="currentColor" stroke-width="2" fill="none"/>
                                    </svg>
                                    <span>Köşe Parselli</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Çevre -->
                    <div class="feature-group">
                        <h3 class="feature-group-title">Çevre</h3>
                        <div class="tabs-section">
                            <div class="feature-tabs">
                                <button class="feature-tab active" role="tab" aria-selected="true" data-tab="ulasim">
                                    <svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.5 8a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z"/>
                                    </svg>
                                    <span>Ulaşım</span>
                                </button>
                                <button class="feature-tab" role="tab" aria-selected="false" data-tab="egitim">
                                    <svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M8.5 1a.5.5 0 0 0-1 0v1.293l-6.146 6.147a.5.5 0 0 0 .708.708L8 3.207l5.938 5.941a.5.5 0 0 0 .708-.708L8.5 2.293V1z"/>
                                    </svg>
                                    <span>Eğitim Kurumları</span>
                                </button>
                                <button class="feature-tab" role="tab" aria-selected="false" data-tab="saglik">
                                    <svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.5 8a.5.5 0 0 1 .5-.5h2.5V5a.5.5 0 0 1 1 0v2.5H11a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V8.5H5a.5.5 0 0 1-.5-.5z"/>
                                    </svg>
                                    <span>Sağlık Kurumları</span>
                                </button>
                                <button class="feature-tab" role="tab" aria-selected="false" data-tab="alisveris">
                                    <svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/>
                                    </svg>
                                    <span>Alışveriş</span>
                                </button>
                            </div>
                            <div class="tab-content" id="tabContent">
                                <div class="distance-list" id="ulasimContent">
                                    <div class="distance-item">
                                        <span class="distance-label">Otogar</span>
                                        <span class="distance-value">10 Km</span>
                                    </div>
                                    <div class="distance-item">
                                        <span class="distance-label">Havalimanı</span>
                                        <span class="distance-value">19 Km</span>
                                    </div>
                                </div>
                                <div class="distance-list" id="egitimContent" style="display: none;">
                                    <div style="padding: 20px; text-align: center; color: var(--muted);">
                                        Eğitim kurumları bilgisi yükleniyor...
                                    </div>
                                </div>
                                <div class="distance-list" id="saglikContent" style="display: none;">
                                    <div style="padding: 20px; text-align: center; color: var(--muted);">
                                        Sağlık kurumları bilgisi yükleniyor...
                                    </div>
                                </div>
                                <div class="distance-list" id="alisverisContent" style="display: none;">
                                    <div style="padding: 20px; text-align: center; color: var(--muted);">
                                        Alışveriş merkezleri bilgisi yükleniyor...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Map -->
                <div class="map-card">
                    <h3 class="map-title" style="margin-bottom: 16px;">Konum Haritası</h3>
                    <div class="map-tabs">
                        <button class="map-tab active" data-map="satellite">Harita</button>
                        <button class="map-tab" data-map="roadmap">Uydu</button>
                    </div>
                    <div class="map-container">
                        <div id="map" class="map-iframe"></div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

   

    <!-- Image Modal -->
    <div class="image-modal" id="imageModal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">&times;</button>
            <img class="modal-image" id="modalImage" src="" alt="Büyük Görsel">
            <button class="modal-nav prev" id="modalPrev">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                    <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12Z"/>
                </svg>
            </button>
            <button class="modal-nav next" id="modalNext">
                <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                    <path d="M8.59 16.59L10 18L16 12L10 6L8.59 7.41L13.17 12Z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Mobile Contact Menu -->
    <div class="mobile-contact-menu" id="mobileContactMenu">
        <div class="mobile-contact-buttons">
            <button class="mobile-contact-btn whatsapp" id="mobileWhatsappBtn">
                <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.051 3.488"/>
                </svg>
                WhatsApp
            </button>
            <button class="mobile-contact-btn phone" id="mobilePhoneBtn">
                <svg viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                    <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                </svg>
                Ara
            </button>
        </div>
    </div>

    <script>
        // Google Maps API callback function - Global scope'da tanımlanmalı
        function initMap() {
            console.log('🌐 Google Maps API loaded successfully');
            console.log('🔧 Google Maps object available:', typeof google !== 'undefined' && google.maps);
            // Map will be initialized when property data is loaded
        }
        
        // Details dropdown and other non-gallery functionality
        const detailsBtn = document.getElementById('detailsBtn');
        const detailsDropdown = document.getElementById('detailsDropdown');

        // Details dropdown
        detailsBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const isOpen = detailsDropdown.classList.contains('show');
            detailsDropdown.classList.toggle('show');
            detailsBtn.classList.toggle('active');
        });

        document.addEventListener('click', () => {
            detailsDropdown.classList.remove('show');
            detailsBtn.classList.remove('active');
        });

        detailsDropdown.addEventListener('click', (e) => {
            e.stopPropagation();
        });

        // Icon buttons
        document.querySelectorAll('.icon-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const label = btn.getAttribute('aria-label');
                console.log(`${label} tıklandı`);
            });
        });

        // Contact buttons
        document.querySelectorAll('.contact-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const label = btn.getAttribute('aria-label');
                if (label === 'WhatsApp') {
                    window.open('https://wa.me/905524709898?text=Merhaba, bu ilanla ilgili bilgi almak istiyorum.', '_blank');
                } else if (label === 'Telefon') {
                    window.location.href = 'tel:+905524709898';
                }
            });
        });

        // Action buttons
        document.querySelector('.btn-primary').addEventListener('click', () => {
            alert('İletişime geçme seçeneklerini görebilirsiniz.');
        });

        document.querySelector('.tapview-btn').addEventListener('click', () => {
            showTapuModal();
        });

        // Tapu Modal Functions
        function showTapuModal() {
            const modal = document.getElementById('tapuModal');
            const imageContainer = document.getElementById('tapuImageContainer');
            const noImageContainer = document.getElementById('tapuNoImage');
            const tapuImage = document.getElementById('tapuImage');
            
            console.log('🔍 Tapu Modal - İlan verisi:', window.currentIlanData);
            console.log('🔍 Tapu Modal - Tapu görseli:', window.currentIlanData?.tapuGorseli);
            
            // İlan verisinden tapu görseli URL'sini al
            if (window.currentIlanData && window.currentIlanData.tapuGorseli && window.currentIlanData.tapuGorseli.url) {
                console.log('✅ Tapu görseli bulundu:', window.currentIlanData.tapuGorseli.url);
                tapuImage.src = window.currentIlanData.tapuGorseli.url;
                imageContainer.style.display = 'block';
                noImageContainer.style.display = 'none';
            } else {
                console.log('❌ Tapu görseli bulunamadı');
                imageContainer.style.display = 'none';
                noImageContainer.style.display = 'block';
            }
            
            modal.style.display = 'flex';
            
            // ESC tuşu ile kapatma
            document.addEventListener('keydown', handleEscKey);
            
            // Modal dışına tıklayınca kapatma
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeTapuModal();
                }
            });
        }
        
        function closeTapuModal() {
            const modal = document.getElementById('tapuModal');
            modal.style.display = 'none';
            document.removeEventListener('keydown', handleEscKey);
        }
        
        function handleEscKey(e) {
            if (e.key === 'Escape') {
                closeTapuModal();
            }
        }

        // Özellikler Section Functionality
        // Feature tabs functionality
        const featureTabs = document.querySelectorAll('.feature-tab');
        const tabContents = {
            'ulasim': document.getElementById('ulasimContent'),
            'egitim': document.getElementById('egitimContent'),
            'saglik': document.getElementById('saglikContent'),
            'alisveris': document.getElementById('alisverisContent')
        };

        featureTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;
                
                // Update active tab
                featureTabs.forEach(t => {
                    t.classList.remove('active');
                    t.setAttribute('aria-selected', 'false');
                });
                tab.classList.add('active');
                tab.setAttribute('aria-selected', 'true');
                
                // Show corresponding content
                Object.values(tabContents).forEach(content => {
                    content.style.display = 'none';
                });
                if (tabContents[tabId]) {
                    tabContents[tabId].style.display = 'flex';
                }
            });
        });

        // Map tabs functionality
        const mapTabs = document.querySelectorAll('.map-tab');
        
        mapTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const mapType = tab.dataset.map;
                
                // Update active map tab
                mapTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Switch map type
                if (window.propertyMap) {
                    if (mapType === 'satellite') {
                        window.propertyMap.setMapTypeId(google.maps.MapTypeId.SATELLITE);
                    } else {
                        window.propertyMap.setMapTypeId(google.maps.MapTypeId.ROADMAP);
                    }
                }
            });
        });

        // Footer functionality
        const newsletterBtn = document.getElementById('newsletterBtn');
        const newsletterEmail = document.getElementById('newsletterEmail');
        
        if (newsletterBtn && newsletterEmail) {
            newsletterBtn.addEventListener('click', () => {
                const email = newsletterEmail.value.trim();
                if (email) {
                    console.log('Newsletter subscription:', email);
                    alert('Başarıyla abone oldunuz!');
                    newsletterEmail.value = '';
                } else {
                    alert('Lütfen geçerli bir email adresi girin.');
                }
            });
        }

        // WhatsApp button functionality
        document.querySelectorAll('.whatsapp-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const whatsappUrl = 'https://wa.me/905524709898?text=Merhaba, emlak ilanı hakkında bilgi almak istiyorum.';
                window.open(whatsappUrl, '_blank');
            });
        });

        // Mobile contact menu functionality
        const mobileWhatsappBtn = document.getElementById('mobileWhatsappBtn');
        const mobilePhoneBtn = document.getElementById('mobilePhoneBtn');

        if (mobileWhatsappBtn) {
            mobileWhatsappBtn.addEventListener('click', () => {
                const whatsappUrl = 'https://wa.me/905524709898?text=Merhaba, emlak ilanı hakkında bilgi almak istiyorum.';
                window.open(whatsappUrl, '_blank');
            });
        }

        if (mobilePhoneBtn) {
            mobilePhoneBtn.addEventListener('click', () => {
                window.location.href = 'tel:+905524709898';
            });
        }

        // Image modal functionality
        const imageModal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const modalClose = document.getElementById('modalClose');
        const modalPrev = document.getElementById('modalPrev');
        const modalNext = document.getElementById('modalNext');
        let modalPhotosArray = [];
        let modalCurrentIndex = 0;

        function openImageModal(imageUrl, photos, currentIndex) {
            modalPhotosArray = photos;
            modalCurrentIndex = currentIndex;
            modalImage.src = imageUrl;
            imageModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal() {
            imageModal.classList.remove('show');
            document.body.style.overflow = '';
        }

        function showModalImage(index) {
            if (index < 0 || index >= modalPhotosArray.length) return;
            modalCurrentIndex = index;
            modalImage.src = modalPhotosArray[index].url;
        }

        if (modalClose) {
            modalClose.addEventListener('click', closeImageModal);
        }

        if (modalPrev) {
            modalPrev.addEventListener('click', () => {
                const newIndex = modalCurrentIndex === 0 ? modalPhotosArray.length - 1 : modalCurrentIndex - 1;
                showModalImage(newIndex);
            });
        }

        if (modalNext) {
            modalNext.addEventListener('click', () => {
                const newIndex = modalCurrentIndex === modalPhotosArray.length - 1 ? 0 : modalCurrentIndex + 1;
                showModalImage(newIndex);
            });
        }

        // Close modal with ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeImageModal();
            }
        });

        // Close modal by clicking outside
        imageModal.addEventListener('click', (e) => {
            if (e.target === imageModal) {
                closeImageModal();
            }
        });

        // Social media tracking
        document.querySelectorAll('.social-icon').forEach(icon => {
            icon.addEventListener('click', (e) => {
                e.preventDefault();
                const platform = icon.getAttribute('aria-label');
                console.log(`Social media click: ${platform}`);
                // Here you would typically add analytics tracking
            });
        });

        // Footer link tracking
        document.querySelectorAll('.footer-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const linkText = link.textContent;
                console.log(`Footer link click: ${linkText}`);
                // Here you would typically handle navigation or analytics
            });
        });

        // ===== FIREBASE INTEGRATION FOR DETAIL PAGE ===== //
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBhY-cgBNBGFd5o9e6l4_L4xYjOFAhyH0M",
            authDomain: "emlaksende-8646a.firebaseapp.com",
            databaseURL: "https://emlaksende-8646a-default-rtdb.firebaseio.com",
            projectId: "emlaksende-8646a",
            storageBucket: "emlaksende-8646a.firebasestorage.app",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abc123def456ghi789"
        };

        // Initialize Firebase
        if (typeof firebase !== 'undefined') {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            
            const database = firebase.database();
            
            // Get property ID from URL parameters
            function getPropertyIdFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get('id');
            }
            
            // Load property details from Firebase
            function loadPropertyDetails() {
                const propertyId = getPropertyIdFromUrl();
                
                if (!propertyId) {
                    console.error('Property ID not found in URL');
                    document.body.innerHTML = '<h1>İlan bulunamadı</h1><p>İlan ID\'si bulunamadı.</p>';
                    return;
                }
                
                console.log('Loading property details for ID:', propertyId);
                
                database.ref(`ilanlar/${propertyId}`).once('value')
                    .then(async (snapshot) => {
                        if (!snapshot.exists()) {
                            document.body.innerHTML = '<h1>İlan bulunamadı</h1><p>Bu ilan artık mevcut değil.</p>';
                            return;
                        }
                        
                        const propertyData = snapshot.val();
                        propertyData.id = propertyId;
                        
                        console.log('📊 Loaded property data:', propertyData);
                        console.log('🏗️ Arsa sınırları in loaded data:', propertyData.arsa_sinirlari);
                        await updatePageWithPropertyData(propertyData);
                    })
                    .catch((error) => {
                        console.error('Error loading property details:', error);
                        document.body.innerHTML = '<h1>Hata</h1><p>İlan yüklenirken bir hata oluştu.</p>';
                    });
            }
            
            // Update page content with property data
            async function updatePageWithPropertyData(property) {
                // İlan verisini global olarak sakla (tapu modal için)
                window.currentIlanData = property;
                
                // Update page title
                const pageTitle = document.querySelector('.page-title');
                if (pageTitle) {
                    pageTitle.textContent = property.baslik || 'İlan Detayı';
                }
                
                // Update breadcrumb
                const breadcrumbCity = document.getElementById('breadcrumbCity');
                const breadcrumbDistrict = document.getElementById('breadcrumbDistrict');
                const breadcrumbNeighborhood = document.getElementById('breadcrumbNeighborhood');
                const breadcrumbTitle = document.getElementById('breadcrumbTitle');
                
                if (breadcrumbCity) breadcrumbCity.textContent = property.sehir ? property.sehir.charAt(0).toUpperCase() + property.sehir.slice(1) : 'Şehir';
                if (breadcrumbDistrict) breadcrumbDistrict.textContent = property.ilce ? property.ilce.charAt(0).toUpperCase() + property.ilce.slice(1) : 'İlçe';
                if (breadcrumbNeighborhood) breadcrumbNeighborhood.textContent = property.mahalle ? property.mahalle.charAt(0).toUpperCase() + property.mahalle.slice(1) : 'Mahalle';
                if (breadcrumbTitle) breadcrumbTitle.textContent = property.baslik || 'İlan Detayı';
                
                // Update main title
                const h1Title = document.querySelector('h1.page-title');
                if (h1Title) {
                    h1Title.textContent = property.baslik || 'İlan Detayı';
                }
                
                // Update location
                const locationElement = document.getElementById('propertyLocation');
                if (locationElement) {
                    const location = `${property.sehir ? property.sehir.charAt(0).toUpperCase() + property.sehir.slice(1) : ''}, ${property.ilce ? property.ilce.charAt(0).toUpperCase() + property.ilce.slice(1) : ''}`;
                    locationElement.textContent = location;
                }
                
                // Update price
                const priceElement = document.getElementById('propertyPrice');
                if (priceElement) {
                    const formattedPrice = new Intl.NumberFormat('tr-TR').format(property.toplamFiyat || 0);
                    priceElement.textContent = `${formattedPrice}₺`;
                }
                
                // Update property details
                await updatePropertyFeatures(property);
                
                // Update images
                updatePropertyImages(property);
                
                // Update valuation panel
                updateValuationPanel(property);
                
                // Update description section
                updateDescriptionSection(property);
                
                // Update features section  
                updateFeaturesSection(property);
                
                // Update environment section (Çevre)
                updateEnvironmentSection(property);
                
                // Update map with location
                console.log('🗺️ About to call updateMapWithLocation with property data:', {
                    location: property.location,
                    arsa_sinirlari: property.arsa_sinirlari
                });
                updateMapWithLocation(property);
            }
            
            // Update property features
            async function updatePropertyFeatures(property) {
                const featureRows = document.querySelectorAll('.feature-row');
                
                for (const row of featureRows) {
                    const label = row.querySelector('.feature-label');
                    const value = row.querySelector('.feature-value');
                    
                    if (!label || !value) continue;
                    
                    const labelText = label.textContent.trim();
                    
                    switch (labelText) {
                        case 'İlan No':
                            value.textContent = property.ilanNo || 'N/A';
                            break;
                        case 'İmar Durumu':
                            value.textContent = await getImarDurumuText(property.imarDurumuId);
                            break;
                        case 'Metrekare':
                            value.textContent = property.metrekare ? `${property.metrekare.toLocaleString('tr-TR')} m²` : 'N/A';
                            break;
                        case 'Metrekare Fiyat':
                            value.textContent = property.metrekareFiyat ? `${property.metrekareFiyat.toLocaleString('tr-TR')}₺` : 'N/A';
                            break;
                        case 'Ada No':
                            value.textContent = property.adaNo || 'N/A';
                            break;
                        case 'Parsel No':
                            value.textContent = property.parselNo || 'N/A';
                            break;
                        case 'Kaks':
                            value.textContent = await getKaksText(property.kaksId);
                            break;
                        case 'Gabari':
                            value.textContent = await getGabariText(property.gabariId);
                            break;
                        case 'Tapu Durumu':
                            value.textContent = await getTapuDurumuText(property.tapuDurumuId);
                            break;
                    }
                }
            }
            
            // Update property images
            function updatePropertyImages(property) {
                let photosArray = [];
                
                // Handle both array and object formats
                if (property.photos) {
                    if (Array.isArray(property.photos)) {
                        photosArray = property.photos;
                    } else if (typeof property.photos === 'object') {
                        // Convert object to array and sort by order
                        photosArray = Object.values(property.photos).sort((a, b) => (a.order || 0) - (b.order || 0));
                    }
                }
                
                if (photosArray.length === 0) {
                    console.log('No photos found for this property');
                    return;
                }
                
                const mainImage = document.getElementById('mainImage');
                const prevBtn = document.querySelector('.gallery-nav.prev');
                const nextBtn = document.querySelector('.gallery-nav.next');
                
                // Find primary photo or use first one
                const primaryPhoto = photosArray.find(photo => photo && photo.isPrimary) || photosArray[0];
                let currentImageIndex = 0;
                
                if (mainImage && primaryPhoto) {
                    mainImage.src = primaryPhoto.url;
                    // Find index of primary photo
                    currentImageIndex = photosArray.findIndex(photo => photo === primaryPhoto);
                    if (currentImageIndex === -1) currentImageIndex = 0;
                    
                    // Add click listener to main image for modal
                    mainImage.addEventListener('click', () => {
                        openImageModal(primaryPhoto.url, photosArray, currentImageIndex);
                    });
                }
                
                // Update thumbnails
                const thumbnailsContainer = document.getElementById('thumbnailsContainer');
                if (thumbnailsContainer) {
                    thumbnailsContainer.innerHTML = '';
                    
                    photosArray.forEach((photo, index) => {
                        if (!photo || !photo.url) return;
                        
                        const thumbnailButton = document.createElement('button');
                        thumbnailButton.className = `thumbnail ${index === currentImageIndex ? 'active' : ''}`;
                        thumbnailButton.setAttribute('data-image', photo.url);
                        thumbnailButton.setAttribute('aria-pressed', index === currentImageIndex ? 'true' : 'false');
                        
                        thumbnailButton.innerHTML = `<img src="${photo.url}" alt="Görsel ${index + 1}">`;
                        
                        thumbnailButton.addEventListener('click', () => {
                            setActiveImage(index);
                        });
                        
                        // Add double click for modal
                        thumbnailButton.addEventListener('dblclick', () => {
                            openImageModal(photo.url, photosArray, index);
                        });
                        
                        thumbnailsContainer.appendChild(thumbnailButton);
                    });
                }
                
                // Set active image function
                function setActiveImage(index) {
                    if (index < 0 || index >= photosArray.length) return;
                    
                    currentImageIndex = index;
                    
                    if (mainImage) {
                        mainImage.src = photosArray[index].url;
                        // Update click listener for modal
                        mainImage.onclick = () => {
                            openImageModal(photosArray[index].url, photosArray, index);
                        };
                    }
                    
                    // Update active state
                    document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                        thumb.classList.toggle('active', i === index);
                        thumb.setAttribute('aria-pressed', i === index ? 'true' : 'false');
                    });
                }
                
                // Update navigation buttons
                if (prevBtn) {
                    prevBtn.onclick = () => {
                        const newIndex = currentImageIndex === 0 ? photosArray.length - 1 : currentImageIndex - 1;
                        setActiveImage(newIndex);
                    };
                }
                
                if (nextBtn) {
                    nextBtn.onclick = () => {
                        const newIndex = currentImageIndex === photosArray.length - 1 ? 0 : currentImageIndex + 1;
                        setActiveImage(newIndex);
                    };
                }
                
                // Update keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowLeft') {
                        const newIndex = currentImageIndex === 0 ? photosArray.length - 1 : currentImageIndex - 1;
                        setActiveImage(newIndex);
                    } else if (e.key === 'ArrowRight') {
                        const newIndex = currentImageIndex === photosArray.length - 1 ? 0 : currentImageIndex + 1;
                        setActiveImage(newIndex);
                    }
                });
                
                // Make setActiveImage available globally for thumbnail clicks
                window.setActiveImageForGallery = setActiveImage;
            }
            
            // Update valuation panel
            function updateValuationPanel(property) {
                const forecastItems = document.querySelectorAll('.forecast-item');
                
                if (property.priceProjections && forecastItems.length >= 3) {
                    // Year 1
                    if (property.priceProjections.year1 && forecastItems[0]) {
                        const priceSpan = forecastItems[0].querySelector('.forecast-price');
                        if (priceSpan) {
                            const formattedPrice = new Intl.NumberFormat('tr-TR').format(property.priceProjections.year1.projectedPrice || 0);
                            priceSpan.textContent = `${formattedPrice}₺`;
                        }
                    }
                    
                    // Year 2
                    if (property.priceProjections.year2 && forecastItems[1]) {
                        const priceSpan = forecastItems[1].querySelector('.forecast-price');
                        if (priceSpan) {
                            const formattedPrice = new Intl.NumberFormat('tr-TR').format(property.priceProjections.year2.projectedPrice || 0);
                            priceSpan.textContent = `${formattedPrice}₺`;
                        }
                    }
                    
                    // Year 3
                    if (property.priceProjections.year3 && forecastItems[2]) {
                        const priceSpan = forecastItems[2].querySelector('.forecast-price');
                        if (priceSpan) {
                            const formattedPrice = new Intl.NumberFormat('tr-TR').format(property.priceProjections.year3.projectedPrice || 0);
                            priceSpan.textContent = `${formattedPrice}₺`;
                        }
                    }
                }
                
                // Update chart with real data
                updateChart(property);
            }
            
            // Update chart with real data
            function updateChart(property) {
                const chartBars = document.querySelectorAll('.chart-bar');
                
                if (!property.priceProjections || chartBars.length === 0) return;
                
                // Get price projections for 3 years
                const currentPrice = property.toplamFiyat || 0;
                const year1Price = property.priceProjections.year1?.projectedPrice || currentPrice;
                const year2Price = property.priceProjections.year2?.projectedPrice || currentPrice;
                const year3Price = property.priceProjections.year3?.projectedPrice || currentPrice;
                
                // Find the maximum price for scaling
                const maxPrice = Math.max(currentPrice, year1Price, year2Price, year3Price);
                
                // Update each bar height based on year data
                chartBars.forEach((bar, index) => {
                    let price;
                    switch(index) {
                        case 0: // 1. Yıl
                            price = year1Price;
                            break;
                        case 1: // 2. Yıl
                            price = year2Price;
                            break;
                        case 2: // 3. Yıl
                            price = year3Price;
                            break;
                        default:
                            price = currentPrice;
                    }
                    
                    // Calculate percentage height
                    const percentage = maxPrice > 0 ? (price / maxPrice) * 100 : 0;
                    // Ensure minimum 20% height and maximum 90% height
                    const height = Math.max(20, Math.min(90, percentage));
                    bar.style.height = `${height}%`;
                    
                    // Add tooltip with price information
                    const formattedPrice = new Intl.NumberFormat('tr-TR').format(price);
                    bar.title = `${index + 1}. Yıl: ${formattedPrice}₺`;
                    bar.setAttribute('data-tooltip', `${index + 1}. Yıl: ${formattedPrice}₺`);
                });
            }
            
            // Helper functions for lookup values
            function getImarDurumuText(id) {
                if (!id) return 'Belirtilmemiş';
                // Firebase'den imar durumu lookup
                return new Promise((resolve) => {
                    database.ref(`imar_durumu/${id}`).once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            resolve(data ? data.name : 'Belirtilmemiş');
                        })
                        .catch(() => resolve('Belirtilmemiş'));
                });
            }
            
            function getKaksText(id) {
                if (!id) return 'Belirtilmemiş';
                // Firebase'den kaks lookup
                return new Promise((resolve) => {
                    database.ref(`kaks/${id}`).once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            resolve(data ? data.value : 'Belirtilmemiş');
                        })
                        .catch(() => resolve('Belirtilmemiş'));
                });
            }
            
            function getGabariText(id) {
                if (!id) return 'Belirtilmemiş';
                // Firebase'den gabari lookup
                return new Promise((resolve) => {
                    database.ref(`gabari/${id}`).once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            resolve(data ? data.value : 'Belirtilmemiş');
                        })
                        .catch(() => resolve('Belirtilmemiş'));
                });
            }
            
            function getTapuDurumuText(id) {
                if (!id) return 'Belirtilmemiş';
                // Firebase'den tapu durumu lookup
                return new Promise((resolve) => {
                    database.ref(`tapu_durumu/${id}`).once('value')
                        .then(snapshot => {
                            const data = snapshot.val();
                            resolve(data ? data.name : 'Belirtilmemiş');
                        })
                        .catch(() => resolve('Belirtilmemiş'));
                });
            }
            
            // Update description section
            function updateDescriptionSection(property) {
                const descriptionCard = document.getElementById('dynamicDescription');
                if (!descriptionCard) return;
                
                // Use the aciklama field from Firebase, or show default
                const description = property.aciklama || '<p>Bu ilan için henüz açıklama eklenmemiş.</p>';
                
                console.log('Updating description with:', description);
                
                // Directly insert the HTML content (since it contains HTML tags)
                descriptionCard.innerHTML = description;
            }
            
            // Update features section (Alt yapı, Konum, Genel Özellikler)
            function updateFeaturesSection(property) {
                console.log('Updating features with property data:', property);
                
                // Update Alt yapı (Infrastructure)
                updateInfrastructureFeatures(property.altyapi_ozellikleri || {});
                
                // Update Konum (Location)
                updateLocationFeatures(property.konum_ozellikleri || {});
                
                // Update Genel Özellikler (General Features)
                updateGeneralFeatures(property.genel_ozellikler || {});
            }
            
            // Update infrastructure features
            function updateInfrastructureFeatures(altyapi) {
                const infrastructureMap = {
                    'Elektrik': altyapi.elektrik,
                    'Sanayi Elektriği': altyapi.sanayi_elektrik,
                    'Su': altyapi.su,
                    'Telefon': altyapi.telefon,
                    'Doğalgaz': altyapi.doganlaz, // Firebase: doganlaz
                    'Kanalizasyon': altyapi.kanalizasyon,
                    'Arıtma': altyapi.aritma, // Firebase: aritma
                    'Sondaj & Kuyu': altyapi.sondaj_kuyu,
                    'Zemin Etüdü': altyapi.zemin_etudu,
                    'Yolu Açılmış': altyapi.yolu_acilmis, // Firebase: yolu_acilmis
                    'Yolu Açılmamış': altyapi.yolu_var === false, // Firebase: yolu_var
                    'Yolu Yok': altyapi.yolu_var === false
                };
                
                updateFeatureItems('Alt yapı', infrastructureMap);
            }
            
            // Update location features  
            function updateLocationFeatures(konum) {
                console.log('🏠 KONUM ÖZELLIK GÜNCELLEME BAŞLADI');
                console.log('📍 TRUE OLAN DEĞERLERİ:', {
                    ana_yola_yakin: konum.ana_yola_yakin === true,
                    hastaneye_yakin: konum.hastaneye_yakin === true
                });
                
                // ✅ HTML'deki SPAN TEXT ile birebir eşleşen mapping
                const locationMap = {
                    'Anayola Yakın': konum.ana_yola_yakin,           // Firebase: ana_yola_yakin
                    'Denize Sıfır': konum.denize_sifir,             // Firebase: denize_sifir  
                    'İtfaiye Yakın': konum.itfaiyeye_yakin,         // Firebase: itfaiyeye_yakin
                    'Havalimanı Yakın': konum.havalimanina_yakin,   // Firebase: havalimanina_yakin
                    'Toplu Ulaşıma Yakın': konum.toplu_tasimaya_yakin, // Firebase: toplu_tasimaya_yakin
                    'Denize Yakın': konum.denize_yakin,             // Firebase: denize_yakin
                    'Hastane Yakın': konum.hastaneye_yakin,         // Firebase: hastaneye_yakin
                    'Su Kaynağına Yakın': konum.su_kaynagina_yakin  // Firebase: su_kaynagina_yakin
                };
                
                updateFeatureItems('Konum', locationMap);
            }
            
            // Update general features
            function updateGeneralFeatures(genel) {
                const generalMap = {
                    'İfrazlı': genel.ifrazli,
                    'Parselli': genel.parselli,
                    'Projeli': genel.projeli,
                    'Köşe Parselli': genel.kose_parselli
                };
                
                updateFeatureItems('Genel Özellikler', generalMap);
            }
            
            // Helper function to update feature items
            function updateFeatureItems(groupTitle, featureMap) {
                console.log(`🔍 Looking for group: "${groupTitle}"`);
                console.log('📊 Feature map:', featureMap);
                
                // Find the feature group by title
                const groupTitles = document.querySelectorAll('.feature-group-title');
                let targetGroup = null;
                
                groupTitles.forEach(title => {
                    const titleText = title.textContent.trim();
                    console.log(`📋 Found group title: "${titleText}"`);
                    if (titleText === groupTitle) {
                        targetGroup = title.closest('.feature-group');
                        console.log(`✅ Target group found for: "${groupTitle}"`);
                    }
                });
                
                if (!targetGroup) {
                    console.error(`❌ No target group found for: "${groupTitle}"`);
                    return;
                }
                
                // Find all feature items in this group
                const featureItems = targetGroup.querySelectorAll('.feature-item');
                console.log(`🔗 Found ${featureItems.length} feature items in "${groupTitle}"`);
                
                featureItems.forEach((item, index) => {
                    const span = item.querySelector('span');
                    if (!span) return;
                    
                    const featureName = span.textContent.trim();
                    const icon = item.querySelector('.feature-icon');
                    
                    console.log(`🏷️ Processing feature: "${featureName}"`);
                    
                    if (featureMap.hasOwnProperty(featureName)) {
                        const isAvailable = featureMap[featureName];
                        
                        console.log(`🔧 PROCESSING: ${featureName}`);
                        console.log(`   Raw value: ${featureMap[featureName]}`);
                        console.log(`   Type: ${typeof featureMap[featureName]}`);
                        console.log(`   Is Available: ${isAvailable}`);
                        console.log(`   Strict equals true: ${featureMap[featureName] === true}`);
                        console.log(`   Boolean conversion: ${Boolean(featureMap[featureName])}`);
                        
                        // Update icon class and SVG content
                        if (icon) {
                            console.log(`   Icon found for: ${featureName}`);
                            icon.classList.remove('available', 'unavailable');
                            icon.classList.add(isAvailable ? 'available' : 'unavailable');
                            
                            // Update SVG content based on availability
                            if (isAvailable) {
                                // Green checkmark
                                icon.innerHTML = `
                                    <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                    <path d="m5 9 2 2 6-6" stroke="currentColor" stroke-width="2" fill="none"/>
                                `;
                                console.log(`   ✅ Updated to GREEN checkmark`);
                            } else {
                                // Gray X mark
                                icon.innerHTML = `
                                    <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="2" fill="none"/>
                                    <path d="m6 6 6 6m0-6-6 6" stroke="currentColor" stroke-width="2"/>
                                `;
                                console.log(`   ❌ Updated to GRAY X mark`);
                            }
                            
                            console.log(`   Final class: ${icon.className}`);
                        } else {
                            console.log(`   ⚠️ No icon found for: ${featureName}`);
                        }
                        
                        console.log(`✅ ${groupTitle} - ${featureName}: ${isAvailable ? 'AVAILABLE ✓' : 'UNAVAILABLE ✗'}`);
                    } else {
                        console.log(`⚠️ Feature "${featureName}" not found in map for group "${groupTitle}"`);
                        console.log(`   Available keys: ${Object.keys(featureMap).join(', ')}`);
                    }
                });
            }
            
            // Update environment section (Çevre)
            function updateEnvironmentSection(property) {
                console.log('🌍 Updating environment section with property:', property);
                
                // Get cevreler data
                const cevreler = property.cevreler || {};
                
                if (Object.keys(cevreler).length === 0) {
                    console.log('❌ No cevreler data found');
                    return;
                }
                
                console.log('🏘️ Cevreler data:', cevreler);
                
                // Group environments by category
                const categorizedEnvironments = groupEnvironmentsByCategory(cevreler);
                console.log('📂 Categorized environments:', categorizedEnvironments);
                
                // Update tabs and content
                updateEnvironmentTabs(categorizedEnvironments);
                updateEnvironmentContent(categorizedEnvironments);
            }
            
            // Group environments by category
            function groupEnvironmentsByCategory(cevreler) {
                const categories = {};
                
                Object.values(cevreler).forEach(cevre => {
                    if (!cevre.active) return; // Only include active environments
                    
                    const categoryName = cevre.kategoriName || 'Diğer';
                    
                    if (!categories[categoryName]) {
                        categories[categoryName] = [];
                    }
                    
                    categories[categoryName].push({
                        name: cevre.name,
                        distance: cevre.distance,
                        kategoriId: cevre.kategoriId
                    });
                });
                
                return categories;
            }
            
            // Update environment tabs
            function updateEnvironmentTabs(categorizedEnvironments) {
                const tabsContainer = document.querySelector('.feature-tabs');
                if (!tabsContainer) return;
                
                console.log('🏷️ Updating environment tabs');
                
                // Clear existing tabs
                tabsContainer.innerHTML = '';
                
                const categories = Object.keys(categorizedEnvironments);
                
                categories.forEach((categoryName, index) => {
                    const tabButton = document.createElement('button');
                    tabButton.className = `feature-tab ${index === 0 ? 'active' : ''}`;
                    tabButton.setAttribute('role', 'tab');
                    tabButton.setAttribute('aria-selected', index === 0 ? 'true' : 'false');
                    tabButton.setAttribute('data-tab', categoryName.toLowerCase().replace(/\s+/g, ''));
                    
                    // Get appropriate icon for category
                    const iconSVG = getCategoryIcon(categoryName);
                    
                    tabButton.innerHTML = `
                        ${iconSVG}
                        <span>${categoryName}</span>
                    `;
                    
                    // Add click handler
                    tabButton.addEventListener('click', () => {
                        showEnvironmentCategory(categoryName, categorizedEnvironments);
                    });
                    
                    tabsContainer.appendChild(tabButton);
                });
            }
            
            // Update environment content
            function updateEnvironmentContent(categorizedEnvironments) {
                const tabContent = document.getElementById('tabContent');
                if (!tabContent) return;
                
                console.log('📋 Updating environment content');
                
                // Show first category by default
                const firstCategory = Object.keys(categorizedEnvironments)[0];
                if (firstCategory) {
                    showEnvironmentCategory(firstCategory, categorizedEnvironments);
                }
            }
            
            // Show specific environment category
            function showEnvironmentCategory(categoryName, categorizedEnvironments) {
                const tabContent = document.getElementById('tabContent');
                if (!tabContent) return;
                
                console.log(`🎯 Showing category: ${categoryName}`);
                
                const environments = categorizedEnvironments[categoryName] || [];
                
                // Update active tab
                document.querySelectorAll('.feature-tab').forEach(tab => {
                    tab.classList.remove('active');
                    tab.setAttribute('aria-selected', 'false');
                });
                
                const activeTab = document.querySelector(`[data-tab="${categoryName.toLowerCase().replace(/\s+/g, '')}"]`);
                if (activeTab) {
                    activeTab.classList.add('active');
                    activeTab.setAttribute('aria-selected', 'true');
                }
                
                // Create content
                if (environments.length === 0) {
                    tabContent.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: var(--muted);">
                            Bu kategori için çevre bilgisi bulunmamaktadır.
                        </div>
                    `;
                    return;
                }
                
                const contentHTML = `
                    <div class="distance-list">
                        ${environments.map(env => `
                            <div class="distance-item">
                                <span class="distance-label">${env.name}</span>
                                <span class="distance-value">${env.distance} Km</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                tabContent.innerHTML = contentHTML;
            }
            
            // Get category icon
            function getCategoryIcon(categoryName) {
                const icons = {
                    'Ulaşım': `<svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.5 8a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z"/>
                    </svg>`,
                    'Eğitim Kurumları': `<svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8.5 1a.5.5 0 0 0-1 0v1.293l-6.146 6.147a.5.5 0 0 0 .708.708L8 3.207l5.938 5.941a.5.5 0 0 0 .708-.708L8.5 2.293V1z"/>
                    </svg>`,
                    'Sağlık Kurumları': `<svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.5 8a.5.5 0 0 1 .5-.5h2.5V5a.5.5 0 0 1 1 0v2.5H11a.5.5 0 0 1 0 1H8.5V11a.5.5 0 0 1-1 0V8.5H5a.5.5 0 0 1-.5-.5z"/>
                    </svg>`,
                    'Alışveriş': `<svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/>
                    </svg>`
                };
                
                return icons[categoryName] || `<svg class="feature-tab-icon" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zM4.5 8a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5z"/>
                </svg>`;
            }
            
            // Update map with location and boundaries
            function updateMapWithLocation(property) {
                console.log('🗺️ updateMapWithLocation called with property:', property);
                
                if (!property.location) {
                    console.log('❌ No location data found');
                    return;
                }
                
                const lat = property.location.lat;
                const lng = property.location.lng;
                
                if (!lat || !lng) {
                    console.log('❌ No valid coordinates found for property');
                    return;
                }
                
                console.log(`📍 Updating map with coordinates: ${lat}, ${lng}`);
                
                // Process boundary data - handle both array and object formats from Firebase
                let arsaSinirlariArray = [];
                if (property.arsa_sinirlari) {
                    console.log('🔍 Raw arsa_sinirlari data:', property.arsa_sinirlari);
                    console.log('🔍 Type of arsa_sinirlari:', typeof property.arsa_sinirlari);
                    console.log('🔍 Keys in arsa_sinirlari:', Object.keys(property.arsa_sinirlari));
                    
                    if (Array.isArray(property.arsa_sinirlari)) {
                        arsaSinirlariArray = property.arsa_sinirlari;
                        console.log('🏗️ Arsa sınırları (array format):', arsaSinirlariArray);
                    } else if (typeof property.arsa_sinirlari === 'object') {
                        // Convert object to array if Firebase returned it as an object with numeric keys
                        // Filter out empty/undefined values and ensure we have valid lat/lng pairs
                        const allValues = Object.values(property.arsa_sinirlari);
                        console.log('🔍 All values from arsa_sinirlari:', allValues);
                        
                        arsaSinirlariArray = allValues.filter(point => {
                            const isValid = point && typeof point === 'object' && 
                                   typeof point.lat === 'number' && 
                                   typeof point.lng === 'number' &&
                                   !isNaN(point.lat) && !isNaN(point.lng);
                            if (!isValid) {
                                console.log('⚠️ Filtered out invalid point:', point);
                            }
                            return isValid;
                        });
                        console.log('🏗️ Arsa sınırları (object format converted to array):', arsaSinirlariArray);
                    }
                    console.log('📊 Sınır noktası sayısı:', arsaSinirlariArray.length);
                } else {
                    console.log('❌ Arsa sınırları bulunamadı');
                }
                
                // Initialize map if not already done
                if (!window.propertyMap) {
                    console.log('🗺️ Initializing new map...');
                    initPropertyMap(lat, lng);
                } else {
                    console.log('🗺️ Updating existing map...');
                    // Update existing map
                    const center = new google.maps.LatLng(lat, lng);
                    window.propertyMap.setCenter(center);
                    
                    // Update marker position
                    if (window.propertyMarker) {
                        window.propertyMarker.setPosition(center);
                    }
                }
                
                // Draw property boundaries if available
                if (arsaSinirlariArray.length >= 3) { // Check length after conversion
                    console.log('🎯 Drawing property boundaries...');
                    drawPropertyBoundaries(arsaSinirlariArray);
                } else {
                    console.log('❌ Not enough boundaries to draw (less than 3 points)');
                }
            }
            
            // Initialize property map
            function initPropertyMap(lat, lng) {
                console.log('🗺️ initPropertyMap called with coordinates:', lat, lng);
                
                const mapElement = document.getElementById('map');
                if (!mapElement) {
                    console.log('❌ Map element not found');
                    return;
                }
                
                console.log('✅ Map element found');
                
                const center = new google.maps.LatLng(lat, lng);
                console.log('📍 Created center point:', center);
                
                try {
                    window.propertyMap = new google.maps.Map(mapElement, {
                        center: center,
                        zoom: 16,
                        mapTypeId: google.maps.MapTypeId.ROADMAP,
                        mapTypeControl: false,
                        streetViewControl: false,
                        fullscreenControl: false
                    });
                    
                    console.log('✅ Google Maps initialized successfully');
                    
                    // Initialize boundary markers array
                    window.boundaryMarkers = [];
                    
                    // Add marker for property location
                    window.propertyMarker = new google.maps.Marker({
                        position: center,
                        map: window.propertyMap,
                        title: 'Arsa Konumu',
                        icon: {
                            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                                <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="16" cy="16" r="8" fill="#142A45" stroke="#FFFFFF" stroke-width="2"/>
                                    <circle cx="16" cy="16" r="3" fill="#FFFFFF"/>
                                </svg>
                            `),
                            scaledSize: new google.maps.Size(32, 32),
                            anchor: new google.maps.Point(16, 16)
                        }
                    });
                    
                    console.log('✅ Property marker added successfully');
                } catch (error) {
                    console.error('❌ Error initializing Google Maps:', error);
                }
            }
            
            // Draw property boundaries (Kullanıcının önerdiği yöntem + mevcut kod)
            function drawPropertyBoundaries(boundaries) {
                console.log('🎨 drawPropertyBoundaries called with:', boundaries);
                
                if (!window.propertyMap) {
                    console.log('❌ Property map not initialized');
                    return;
                }
                
                if (!boundaries) {
                    console.log('❌ No boundaries data provided');
                    return;
                }
                
                if (boundaries.length < 3) {
                    console.log('❌ Not enough boundary points (minimum 3 required)');
                    return;
                }
                
                console.log('✅ All checks passed, drawing polygon...');
                
                // Clear existing elements
                if (window.propertyPolygon) {
                    console.log('🗑️ Clearing existing polygon');
                    window.propertyPolygon.setMap(null);
                }
                
                if (window.propertyPolyline) {
                    console.log('🗑️ Clearing existing polyline');
                    window.propertyPolyline.setMap(null);
                }
                
                if (window.boundaryMarkers) {
                    window.boundaryMarkers.forEach(marker => marker.setMap(null));
                }
                window.boundaryMarkers = [];
                
                // Kullanıcının önerdiği yöntem: Koordinatları bir dizide topla
                let boundaryCoords = [];
                
                // Firebase'den gelen noktaları işlerken
                boundaries.forEach((point, index) => {
                    let lat = point.lat;
                    let lng = point.lng;
                    let pos = {lat: lat, lng: lng};
                    
                    console.log(`📍 Processing boundary point ${index + 1}:`, pos);
                    console.log(`🔍 Point ${index + 1} details:`, {
                        originalPoint: point,
                        lat: lat,
                        lng: lng,
                        latType: typeof lat,
                        lngType: typeof lng,
                        latValid: !isNaN(lat) && lat !== null && lat !== undefined,
                        lngValid: !isNaN(lng) && lng !== null && lng !== undefined
                    });
                    
                    // Marker ekle
                    const marker = new google.maps.Marker({
                        position: pos,
                        map: window.propertyMap,
                        title: `Sınır Noktası ${index + 1}`,
                        icon: {
                            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                                <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="10" cy="10" r="6" fill="#2b6cff" stroke="#FFFFFF" stroke-width="2"/>
                                    <text x="10" y="13" text-anchor="middle" fill="white" font-size="8" font-weight="bold">${index + 1}</text>
                                </svg>
                            `),
                            scaledSize: new google.maps.Size(20, 20),
                            anchor: new google.maps.Point(10, 10)
                        }
                    });
                    window.boundaryMarkers.push(marker);
                    
                    // Koordinatları polygon için sakla
                    boundaryCoords.push(pos);
                });
                
                console.log('📐 Collected boundary coordinates:', boundaryCoords);
                console.log('🔍 Boundary coordinates details:', {
                    length: boundaryCoords.length,
                    firstCoord: boundaryCoords[0],
                    lastCoord: boundaryCoords[boundaryCoords.length - 1],
                    allCoords: boundaryCoords
                });
                
                // Noktalar geldikten sonra polygon çiz (kullanıcının önerdiği yöntem)
                if (boundaryCoords.length >= 3) {
                    console.log('🎯 Drawing polygon with collected coordinates...');
                    
                    try {
                        // Google Maps LatLng objelerine dönüştür
                        const googleMapsCoords = boundaryCoords.map(coord => 
                            new google.maps.LatLng(coord.lat, coord.lng)
                        );
                        
                        console.log('🗺️ Google Maps coordinates:', googleMapsCoords);
                        console.log('🔍 First Google Maps coord:', googleMapsCoords[0]);
                        console.log('🔍 Last Google Maps coord:', googleMapsCoords[googleMapsCoords.length - 1]);
                        
                        // Koordinatların çok küçük olup olmadığını kontrol et
                        const coordDifferences = [];
                        for (let i = 0; i < googleMapsCoords.length - 1; i++) {
                            const diff = {
                                latDiff: Math.abs(googleMapsCoords[i].lat() - googleMapsCoords[i + 1].lat()),
                                lngDiff: Math.abs(googleMapsCoords[i].lng() - googleMapsCoords[i + 1].lng())
                            };
                            coordDifferences.push(diff);
                        }
                        console.log('🔍 Coordinate differences between consecutive points:', coordDifferences);
                        
                        // Eğer koordinatlar çok yakınsa, bunları büyüt
                        const minDiff = 0.0001; // Minimum fark
                        let needsAdjustment = false;
                        coordDifferences.forEach((diff, index) => {
                            if (diff.latDiff < minDiff || diff.lngDiff < minDiff) {
                                console.log(`⚠️ Points ${index + 1} and ${index + 2} are too close, adjusting...`);
                                needsAdjustment = true;
                            }
                        });
                        
                        // Eğer koordinatlar çok yakınsa, bunları büyüt
                        if (needsAdjustment) {
                            console.log('🔧 Adjusting coordinates to make them more visible...');
                            const adjustedCoords = googleMapsCoords.map((coord, index) => {
                                const adjustment = 0.0002; // 0.0002 derece = yaklaşık 20 metre
                                return new google.maps.LatLng(
                                    coord.lat() + (index * adjustment * 0.1),
                                    coord.lng() + (index * adjustment * 0.1)
                                );
                            });
                            googleMapsCoords = adjustedCoords;
                            console.log('🔧 Adjusted coordinates:', googleMapsCoords);
                        }
                        
                                                // Ana polygon çiz - daha görünür renklerle
                    window.propertyPolygon = new google.maps.Polygon({
                            paths: googleMapsCoords,
                            strokeColor: "#FF0000", // Kırmızı çizgi - daha görünür
                        strokeOpacity: 1.0, // Tam opak
                        strokeWeight: 5, // Daha kalın çizgi
                            fillColor: "#FF0000", // Kırmızı doldurma
                        fillOpacity: 0.3, // Daha opak doldurma
                            map: window.propertyMap,
                            clickable: true,
                            zIndex: 1000
                        });
                        
                        console.log('✅ Polygon created successfully with user method');
                        console.log('🔍 Polygon object:', window.propertyPolygon);
                        console.log('🔍 Polygon map:', window.propertyPolygon.getMap());
                        console.log('🔍 Polygon paths:', window.propertyPolygon.getPath());
                        console.log('🔍 Polygon paths array:', window.propertyPolygon.getPath().getArray());
                        console.log('🔍 Polygon visible:', window.propertyPolygon.getVisible());
                        
                        // Polygon'ın gerçekten haritada olup olmadığını basit test ile kontrol et
                        const polygonMap = window.propertyPolygon.getMap();
                        if (polygonMap) {
                            console.log('✅ Polygon is attached to map');
                            console.log('🔍 Map center:', polygonMap.getCenter());
                            console.log('🔍 Map zoom:', polygonMap.getZoom());
                            
                            // Polygon'ın gerçekten görünür olup olmadığını test et
                            console.log('🔍 Testing polygon visibility...');
                            const paths = window.propertyPolygon.getPath();
                            const pathArray = paths.getArray();
                            console.log('🔍 Polygon has', pathArray.length, 'points');
                            
                            if (pathArray.length > 0) {
                                const firstPoint = pathArray[0];
                                console.log('🔍 First point:', firstPoint.lat(), firstPoint.lng());
                                console.log('🔍 Last point:', pathArray[pathArray.length - 1].lat(), pathArray[pathArray.length - 1].lng());
                            }
                        } else {
                            console.log('❌ Polygon is NOT attached to map');
                        }
                        
                        // Ek olarak polyline da çiz (mevcut kod)
                        window.propertyPolyline = new google.maps.Polyline({
                            path: googleMapsCoords,
                            strokeColor: '#00FF00', // Yeşil çizgi
                            strokeOpacity: 1.0,
                            strokeWeight: 4,
                            map: window.propertyMap,
                            zIndex: 999
                        });
                        
                        console.log('✅ Polyline created successfully');
                        
                        // Haritayı polygon'a sığdır
                        const bounds = new google.maps.LatLngBounds();
                        googleMapsCoords.forEach(coord => bounds.extend(coord));
                        console.log('🔍 Bounds object:', bounds);
                        console.log('🔍 Bounds center:', bounds.getCenter());
                        console.log('🔍 Bounds northeast:', bounds.getNorthEast());
                        console.log('🔍 Bounds southwest:', bounds.getSouthWest());
                        
                        window.propertyMap.fitBounds(bounds, 40);
                        
                        console.log('🎯 Map fitted to polygon bounds');
                        console.log('🔍 Current map center:', window.propertyMap.getCenter());
                        console.log('🔍 Current map zoom:', window.propertyMap.getZoom());
                        console.log('✅ Polygon drawing completed successfully with both methods');
                        
                        // Test: Polygon'ın gerçekten haritada olup olmadığını kontrol et
                        setTimeout(() => {
                            console.log('🔍 After 1 second - Polygon check:');
                            console.log('🔍 Polygon exists:', !!window.propertyPolygon);
                            console.log('🔍 Polygon map:', window.propertyPolygon ? window.propertyPolygon.getMap() : 'null');
                            console.log('🔍 Polygon visible:', window.propertyPolygon ? window.propertyPolygon.getVisible() : 'null');
                            console.log('🔍 Polygon paths count:', window.propertyPolygon ? window.propertyPolygon.getPath().getLength() : 'null');
                            
                            // Haritada polygon'ı bulmaya çalış (getOverlays method'u yok, alternatif yöntem)
                            console.log('🔍 Map overlays: getOverlays method not available in Google Maps API');
                            console.log('🔍 Checking polygon properties instead...');
                            
                            // Polygon'ın gerçekten haritada olup olmadığını test et
                            if (window.propertyPolygon) {
                                const polygonMap = window.propertyPolygon.getMap();
                                console.log('🔍 Polygon map reference:', polygonMap);
                                console.log('🔍 Polygon map === window.propertyMap:', polygonMap === window.propertyMap);
                                
                                // Polygon'ı haritadan kaldır ve tekrar ekle
                                if (polygonMap) {
                                    console.log('🔍 Testing polygon removal and re-addition...');
                                    window.propertyPolygon.setMap(null);
                                    setTimeout(() => {
                                        window.propertyPolygon.setMap(window.propertyMap);
                                        console.log('🔍 Polygon re-added to map');
                                    }, 1000);
                                }
                            }
                            
                            // Alternatif yöntem: Haritaya yeni bir test polygon ekle - farklı konumda
                            try {
                                const testPolygon = new google.maps.Polygon({
                                    paths: [
                                        {lat: boundaryCoords[0].lat + 0.002, lng: boundaryCoords[0].lng + 0.002},
                                        {lat: boundaryCoords[0].lat + 0.002, lng: boundaryCoords[0].lng - 0.002},
                                        {lat: boundaryCoords[0].lat - 0.002, lng: boundaryCoords[0].lng}
                                    ],
                                    strokeColor: "#00FF00", // Yeşil - farklı renk
                                    strokeOpacity: 1.0,
                                    strokeWeight: 8, // Daha kalın
                                    fillColor: "#00FF00",
                                    fillOpacity: 0.6, // Daha opak
                                    map: window.propertyMap
                                });
                                console.log('🔍 Test green polygon added for debugging');
                                console.log('🔍 Test polygon position:', testPolygon.getPath().getArray());
                                
                                // Test polygon'ı 5 saniye sonra kaldır
                                setTimeout(() => {
                                    if (testPolygon) {
                                        testPolygon.setMap(null);
                                        console.log('🔍 Test polygon removed after 5 seconds');
                                    }
                                }, 5000);
                                
                            } catch (testError) {
                                console.error('❌ Error creating test polygon:', testError);
                            }
                            
                        }, 1000);
                        
                    } catch (error) {
                        console.error('❌ Error creating polygon:', error);
                        console.error('❌ Error details:', {
                            message: error.message,
                            stack: error.stack,
                            boundaryCoords: boundaryCoords
                        });
                    }
                } else {
                    console.log('❌ Not enough coordinates collected for polygon');
                }
            }
            

            
            // Load property details when page loads
            document.addEventListener('DOMContentLoaded', () => {
                console.log('🚀 DOM loaded, starting property details loading...');
                loadPropertyDetails();
            });
            
        } else {
            console.error('Firebase SDK not loaded');
        }
    </script>
    
    <!-- Include Components Script -->
    <script src="include-components.js"></script>
    
    <!-- Tapu Görseli Modal -->
    <div id="tapuModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 90vw; max-height: 90vh; background: white; border-radius: 12px; padding: 0; overflow: hidden;">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                <h3 style="margin: 0; color: #1f2937; font-size: 1.25rem; font-weight: 600;">Tapu Belgesi</h3>
                <button class="modal-close" onclick="closeTapuModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6b7280; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 1.5rem; text-align: center; max-height: 70vh; overflow-y: auto;">
                <div id="tapuImageContainer" style="display: none;">
                    <img id="tapuImage" style="max-width: 100%; max-height: 60vh; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
                </div>
                <div id="tapuNoImage" style="display: none; padding: 2rem; color: #6b7280;">
                    <svg width="64" height="64" fill="currentColor" viewBox="0 0 20 20" style="margin: 0 auto 1rem; opacity: 0.5;">
                        <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                    </svg>
                    <p style="margin: 0; font-size: 1.1rem;">Bu ilan için tapu görseli bulunmamaktadır.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SEO Management Script -->
    <script>
        // ===== SEO MANAGEMENT FOR DETAY.HTML =====
        function loadPageSEO() {
            if (typeof firebase === 'undefined' || !firebase.database) {
                console.error('Firebase not available for SEO');
                return;
            }
            
            const database = firebase.database();
            const currentPage = 'detay.html';
            const safePageId = currentPage.replace(/\./g, '_DOT_').replace(/[#$\[\]]/g, '_');
            
            console.log('Loading SEO for detay page:', safePageId);
            
            database.ref(`sayfalar/${safePageId}`).once('value')
                .then((snapshot) => {
                    const seoData = snapshot.val();
                    if (seoData) {
                        console.log('SEO data loaded for detay:', seoData);
                        updatePageSEO(seoData);
                    } else {
                        console.log('No SEO data found for detay page');
                    }
                })
                .catch((error) => {
                    console.error('Error loading SEO data for detay:', error);
                });
        }
        
        function updatePageSEO(seoData) {
            try {
                // Update page title
                if (seoData.seo_title) {
                    const titleElement = document.getElementById('pageTitle');
                    if (titleElement) {
                        titleElement.textContent = seoData.seo_title;
                        document.title = seoData.seo_title;
                    }
                }
                
                // Update meta description
                if (seoData.seo_description) {
                    const descElement = document.getElementById('pageDescription');
                    if (descElement) {
                        descElement.setAttribute('content', seoData.seo_description);
                    }
                }
                
                // Update meta keywords
                if (seoData.seo_keywords) {
                    const keywordsElement = document.getElementById('pageKeywords');
                    if (keywordsElement) {
                        keywordsElement.setAttribute('content', seoData.seo_keywords);
                    }
                }
                
                console.log('SEO data updated successfully for detay page');
            } catch (error) {
                console.error('Error updating SEO data for detay:', error);
            }
        }
        
        // Load SEO when page is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for Firebase to be initialized
            setTimeout(() => {
                loadPageSEO();
            }, 1000);
        });
    </script>
</body>
</html>