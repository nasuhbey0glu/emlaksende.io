<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emlaksende Admin Paneli</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <!-- Google Maps API -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw3Z28goiYhTyQxY_zx5eEcx_9I9wMkR4&callback=initMap&libraries=places"></script>
    

    
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-bg: #0f172a;
            --dark-secondary: #1e293b;
            --sidebar-bg: #1e293b;
            --sidebar-item-hover: #334155;
            --main-bg: #f8fafc;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--main-bg);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transform: translateX(0);
            transition: transform 0.3s ease;
        }

        .sidebar.collapsed {
            transform: translateX(-280px);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .sidebar-logo {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            padding: 0 1.5rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-light);
            opacity: 0.7;
        }

        .nav-item {
            margin-bottom: 0.25rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.2s ease;
            position: relative;
        }

        .nav-link:hover {
            background: var(--sidebar-item-hover);
            color: white;
        }

        .nav-link.active {
            background: var(--primary-color);
            color: white;
        }

        .nav-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: white;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .nav-text {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .nav-submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: rgba(0, 0, 0, 0.2);
        }

        .nav-submenu.open {
            max-height: 500px;
        }

        .nav-submenu .nav-link {
            padding-left: 3.5rem;
            font-size: 0.85rem;
        }

        .nav-arrow {
            margin-left: auto;
            width: 16px;
            height: 16px;
            transform: rotate(0deg);
            transition: transform 0.2s ease;
        }

        .nav-link.expanded .nav-arrow {
            transform: rotate(90deg);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        /* Header */
        .main-header {
            background: var(--card-bg);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-sm);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: background-color 0.2s ease;
        }

        .menu-toggle:hover {
            background: var(--border-color);
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-search {
            position: relative;
        }

        .search-input {
            padding: 0.5rem 0.75rem 0.5rem 2.5rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--main-bg);
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 250px;
            transition: border-color 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            color: var(--text-secondary);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }

        .user-menu:hover {
            background: var(--border-color);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .user-role {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Main Body */
        .main-body {
            flex: 1;
            padding: 2rem;
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: between;
            margin-bottom: 1rem;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .card-icon.primary { background: rgba(37, 99, 235, 0.1); color: var(--primary-color); }
        .card-icon.success { background: rgba(16, 185, 129, 0.1); color: var(--success-color); }
        .card-icon.warning { background: rgba(245, 158, 11, 0.1); color: var(--warning-color); }
        .card-icon.danger { background: rgba(239, 68, 68, 0.1); color: var(--danger-color); }

        .card-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .card-change {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.8rem;
        }

        .card-change.positive { color: var(--success-color); }
        .card-change.negative { color: var(--danger-color); }

        /* Content Area */
        .content-area {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            min-height: 400px;
        }

        .content-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .content-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--secondary-color);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-280px);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }

            .main-header {
                padding: 1rem;
            }

            .main-body {
                padding: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .search-input {
                width: 200px;
            }

            .user-info {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .header-search {
                display: none;
            }

            .search-input {
                width: 150px;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* File Upload Styles */
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            background: var(--main-bg);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 1.5rem;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(37, 99, 235, 0.05);
        }

        .upload-area.dragover {
            border-color: var(--primary-color);
            background: rgba(37, 99, 235, 0.1);
            transform: scale(1.02);
        }

        .upload-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 1rem;
            color: var(--text-secondary);
        }

        .upload-text {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .file-input {
            display: none;
        }

        .upload-progress {
            margin-top: 1rem;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .uploaded-image {
            margin-top: 1.5rem;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            display: none;
        }

        .uploaded-image img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .image-actions {
            padding: 1rem;
            background: var(--card-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .image-url {
            font-size: 0.85rem;
            color: var(--text-secondary);
            word-break: break-all;
            flex: 1;
            margin-right: 1rem;
        }

        .btn-copy {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .btn-copy:hover {
            background: #059669;
        }

        .btn-delete {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 0.5rem;
            transition: all 0.2s ease;
        }

        .btn-delete:hover {
            background: #dc2626;
        }

        /* İlan listesi butonları için ek stiller */
        .btn-delete {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 0.5rem;
            transition: all 0.2s ease;
        }

        .btn-delete:hover {
            background: #dc2626;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
        }

        /* İlan kartları için hover efekti */
        .ilan-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .alert.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .alert.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-color);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        /* Map Styles */
        .map-container {
            position: relative;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            height: 300px;
            background: var(--main-bg);
        }

        .map-canvas {
            width: 100%;
            height: 100%;
        }

        .map-overlay {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 0.5rem;
            border-radius: 6px;
            box-shadow: var(--shadow-md);
            font-size: 0.8rem;
            color: var(--text-secondary);
            z-index: 1000;
        }

        .coordinates-display {
            background: var(--main-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .coordinates-info {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .clear-location-btn {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .clear-location-btn:hover {
            background: #dc2626;
        }

        /* Photo Upload Styles */
        .photo-upload-container {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            background: var(--main-bg);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .photo-upload-container:hover {
            border-color: var(--primary-color);
            background: rgba(37, 99, 235, 0.05);
        }

        .photo-upload-container.dragover {
            border-color: var(--primary-color);
            background: rgba(37, 99, 235, 0.1);
            transform: scale(1.02);
        }

        .photo-upload-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 1rem;
            color: var(--text-secondary);
        }

        .photo-upload-text {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .photo-upload-hint {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .photo-input {
            display: none;
        }

        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .photo-item {
            position: relative;
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .photo-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .photo-item.uploading {
            opacity: 0.7;
        }

        .photo-preview {
            width: 100%;
            height: 120px;
            object-fit: cover;
            background: var(--main-bg);
        }

        .photo-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .photo-item:hover .photo-overlay {
            opacity: 1;
        }

        .photo-actions {
            display: flex;
            gap: 0.5rem;
        }

        .photo-action-btn {
            background: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-primary);
        }

        .photo-action-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .photo-action-btn.delete:hover {
            background: var(--danger-color);
        }

        .photo-info {
            padding: 0.75rem;
            background: var(--card-bg);
        }

        .photo-name {
            font-size: 0.8rem;
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 0.25rem;
            word-break: break-word;
        }

        .photo-size {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .photo-order {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .photo-primary-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: var(--success-color);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .photo-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .photo-progress-bar {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .photos-summary {
            background: var(--main-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .photos-count {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .photos-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-photo-action {
            background: var(--border-color);
            color: var(--text-primary);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn-photo-action:hover {
            background: var(--secondary-color);
            color: white;
        }

        .btn-photo-action.primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-photo-action.danger {
            background: var(--danger-color);
            color: white;
        }

        /* Features Styles */
        .features-container {
            background: var(--main-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .features-category {
            margin-bottom: 2rem;
        }

        .features-category:last-child {
            margin-bottom: 0;
        }

        .features-category-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .feature-item:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        .feature-label {
            font-size: 0.9rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .feature-toggle {
            position: relative;
            width: 44px;
            height: 24px;
            background: var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-toggle.active {
            background: var(--success-color);
        }

        .feature-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .feature-toggle.active::after {
            transform: translateX(20px);
        }

        .features-summary {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.05) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .features-summary-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .features-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
        }

        .feature-summary-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .feature-summary-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-light);
        }

        .feature-summary-indicator.active {
            background: var(--success-color);
        }

        .features-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-feature-action {
            background: var(--border-color);
            color: var(--text-primary);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn-feature-action:hover {
            background: var(--secondary-color);
            color: white;
        }

        .btn-feature-action.primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-feature-action.danger {
            background: var(--danger-color);
            color: white;
        }

        /* Çevreler Styles */
        .cevreler-container {
            background: var(--main-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .cevre-kategori {
            margin-bottom: 2rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .cevre-kategori:last-child {
            margin-bottom: 0;
        }

        .cevre-kategori-header {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .cevre-kategori-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cevre-list {
            padding: 1rem 1.5rem;
        }

        .cevre-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: var(--main-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .cevre-item:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        .cevre-item:last-child {
            margin-bottom: 0;
        }

        .cevre-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .cevre-name {
            font-size: 0.9rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .cevre-toggle {
            position: relative;
            width: 44px;
            height: 24px;
            background: var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .cevre-toggle.active {
            background: var(--success-color);
        }

        .cevre-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .cevre-toggle.active::after {
            transform: translateX(20px);
        }

        .cevre-distance {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            opacity: 0;
            transition: all 0.3s ease;
            transform: translateX(-10px);
        }

        .cevre-toggle.active + .cevre-distance {
            opacity: 1;
            transform: translateX(0);
        }

        .cevre-distance input {
            width: 80px;
            padding: 0.25rem 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.8rem;
            text-align: center;
        }

        .cevre-distance-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .cevreler-summary {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.05) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .cevreler-summary-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cevreler-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
        }

        .cevre-summary-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
            padding: 0.5rem;
            background: var(--card-bg);
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .cevre-summary-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-light);
        }

        .cevre-summary-indicator.active {
            background: var(--success-color);
        }

        .cevre-summary-distance {
            font-weight: 600;
            color: var(--primary-color);
        }

        .cevreler-loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .cevreler-error {
            text-align: center;
            padding: 2rem;
            color: var(--danger-color);
        }

        /* Rich Text Editor Styles */
        .editor-container {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .editor-toolbar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--main-bg);
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .editor-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
        }

        .editor-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .editor-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .editor-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .editor-separator {
            width: 1px;
            height: 24px;
            background: var(--border-color);
            margin: 0 0.5rem;
        }

        .editor-content {
            min-height: 200px;
            padding: 1rem;
            outline: none;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--card-bg);
        }

        .editor-content:focus {
            background: var(--card-bg);
        }

        .editor-content[contenteditable="true"]:empty:before {
            content: "İlan açıklamasını buraya yazın...";
            color: var(--text-light);
            font-style: italic;
        }

        .editor-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 1rem;
            background: var(--main-bg);
            border-top: 1px solid var(--border-color);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .editor-word-count {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .editor-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-editor-action {
            background: var(--border-color);
            color: var(--text-primary);
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .btn-editor-action:hover {
            background: var(--secondary-color);
            color: white;
        }

        .btn-editor-action.primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-editor-action.danger {
            background: var(--danger-color);
            color: white;
        }

        /* Editor Content Styles */
        .editor-content strong {
            font-weight: 600;
        }

        .editor-content em {
            font-style: italic;
        }

        .editor-content ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }

        .editor-content ol {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }

        .editor-content li {
            margin: 0.25rem 0;
        }

        .editor-content h3 {
            margin: 1rem 0 0.5rem 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .editor-content h4 {
            margin: 0.75rem 0 0.5rem 0;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .editor-content p {
            margin: 0.5rem 0;
        }

        .editor-content blockquote {
            margin: 1rem 0;
            padding: 0.75rem 1rem;
            background: var(--main-bg);
            border-left: 4px solid var(--primary-color);
            font-style: italic;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">E</div>
                <div class="sidebar-title">Emlaksende</div>
            </div>
            
            <nav class="sidebar-nav">
                <!-- Ana Sayfa Yönetimi -->
                <div class="nav-section">
                    <div class="nav-section-title">Ana Sayfa Yönetimi</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" data-submenu="homepage">
                            <svg class="nav-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                            </svg>
                            <span class="nav-text">Ana Sayfa</span>
                            <svg class="nav-arrow" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                            </svg>
                        </a>
                        <div class="nav-submenu" id="homepage-submenu">
                            <a href="#" class="nav-link" data-page="ana-resim">
                                <span class="nav-text">Ana Resim</span>
                            </a>
                            <a href="#" class="nav-link" data-page="musteri-yorumlari">
                                <span class="nav-text">Müşteri Yorumları</span>
                            </a>
                            <a href="#" class="nav-link" data-page="soru-cevap">
                                <span class="nav-text">Soru-Cevap</span>
                            </a>
                            <a href="#" class="nav-link" data-page="hakkimizda">
                                <span class="nav-text">Hakkımızda</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- İlan Yönetimi -->
                <div class="nav-section">
                    <div class="nav-section-title">İlan Yönetimi</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" data-submenu="listings">
                            <svg class="nav-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M4 3a2 2 0 100 4h12a2 2 0 100-4H4z"/>
                                <path fill-rule="evenodd" d="M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" clip-rule="evenodd"/>
                            </svg>
                            <span class="nav-text">İlan Yönetimi</span>
                            <svg class="nav-arrow" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                            </svg>
                        </a>
                        <div class="nav-submenu" id="listings-submenu">
                            <a href="#" class="nav-link active" data-page="ilanlar">
                                <span class="nav-text">İlanlar</span>
                            </a>
                            <a href="#" class="nav-link" data-page="cevreler-kategorileri">
                                <span class="nav-text">Çevreler Kategorileri</span>
                            </a>
                            <a href="#" class="nav-link" data-page="cevreler">
                                <span class="nav-text">Çevreler</span>
                            </a>
                            <a href="#" class="nav-link" data-page="imar-durumlari">
                                <span class="nav-text">İmar Durumları</span>
                            </a>
                            <a href="#" class="nav-link" data-page="tapu-durumlari">
                                <span class="nav-text">Tapu Durumları</span>
                            </a>
                            <a href="#" class="nav-link" data-page="gabari">
                                <span class="nav-text">Gabari</span>
                            </a>
                            <a href="#" class="nav-link" data-page="kaks">
                                <span class="nav-text">KAKS</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Diğer Menüler -->
                <div class="nav-section">
                    <div class="nav-section-title">Diğer</div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" data-page="proje-yonetimi">
                            <svg class="nav-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V4a2 2 0 00-2-2H6zm1 2a1 1 0 000 2h6a1 1 0 100-2H7zm6 7a1 1 0 011 1v3a1 1 0 11-2 0v-3a1 1 0 011-1zm-3 3a1 1 0 100 2h.01a1 1 0 100-2H10zm-4 1a1 1 0 011-1h.01a1 1 0 110 2H7a1 1 0 01-1-1zm1-4a1 1 0 100 2h.01a1 1 0 100-2H7zm2 0a1 1 0 100 2h.01a1 1 0 100-2H9zm2 0a1 1 0 100 2h.01a1 1 0 100-2H11z" clip-rule="evenodd"/>
                            </svg>
                            <span class="nav-text">Proje Yönetimi</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" data-page="ozellikler">
                            <svg class="nav-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                            </svg>
                            <span class="nav-text">Özellikler</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" data-page="sayfalar">
                            <svg class="nav-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z" clip-rule="evenodd"/>
                            </svg>
                            <span class="nav-text">Sayfalar</span>
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="#" class="nav-link" data-page="kullanicilar">
                            <svg class="nav-icon" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                            </svg>
                            <span class="nav-text">Kullanıcılar</span>
                        </a>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                        </svg>
                    </button>
                    <h1 class="page-title" id="pageTitle">İlanlar</h1>
                </div>
                
                <div class="header-right">
                    <div class="header-search">
                        <svg class="search-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                        </svg>
                        <input type="text" class="search-input" placeholder="Ara...">
                    </div>
                    
                    <div class="user-menu">
                        <div class="user-avatar">A</div>
                        <div class="user-info">
                            <div class="user-name">Admin</div>
                            <div class="user-role">Yönetici</div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Body -->
            <div class="main-body">
                <!-- Dashboard Stats -->
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-icon primary">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M4 3a2 2 0 100 4h12a2 2 0 100-4H4z"/>
                                <path fill-rule="evenodd" d="M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="card-title">Toplam İlan</div>
                        <div class="card-value">156</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                            </svg>
                            +12% bu ay
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-icon success">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="card-title">Aktif İlan</div>
                        <div class="card-value">134</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                            </svg>
                            +8% bu ay
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-icon warning">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="card-title">Bekleyen İlan</div>
                        <div class="card-value">18</div>
                        <div class="card-change negative">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M14.707 12.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 14.586V3a1 1 0 012 0v11.586l2.293-2.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                            -5% bu ay
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-icon danger">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="card-title">Reddedilen İlan</div>
                        <div class="card-value">4</div>
                        <div class="card-change negative">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M14.707 12.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 14.586V3a1 1 0 012 0v11.586l2.293-2.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                            -2% bu ay
                        </div>
                    </div>
                </div>

                <!-- Content Area -->
                <div class="content-area fade-in" id="contentArea">
                    <div class="content-header">
                        <h2 class="content-title">İlan Listesi</h2>
                        <button class="btn btn-primary">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                            Yeni İlan Ekle
                        </button>
                    </div>
                    
                    <div style="padding: 2rem; text-align: center; color: var(--text-secondary);">
                        <p>Bu sayfa geliştirme aşamasındadır. Seçilen menü öğesine göre içerik dinamik olarak yüklenecektir.</p>
                        <div style="margin-top: 2rem;">
                            <div class="loading"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Firebase Configuration - Web App Config
        const firebaseConfig = {
            apiKey: "AIzaSyBZ1_56GJ5tOhK5Eth6cXscv8jnM4bpdEI",
            authDomain: "emlaksende-8646a.firebaseapp.com",
            databaseURL: "https://emlaksende-8646a-default-rtdb.firebaseio.com/",
            projectId: "emlaksende-8646a",
            storageBucket: "emlaksende-8646a.firebasestorage.app",
            messagingSenderId: "861976091519",
            appId: "1:861976091519:web:a24b7811322e3fc97dd84a"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const storage = firebase.storage();
        const database = firebase.database();

        // Storage reference
        const storageRef = storage.ref();

        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const menuToggle = document.getElementById('menuToggle');
            const pageTitle = document.getElementById('pageTitle');
            const contentArea = document.getElementById('contentArea');
            
            // Menu items
            const navLinks = document.querySelectorAll('.nav-link');
            const submenuToggles = document.querySelectorAll('[data-submenu]');
            
            // Mobile menu toggle
            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('open');
                mainContent.classList.toggle('expanded');
            });

            // Submenu toggles
            submenuToggles.forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    const submenuId = this.getAttribute('data-submenu') + '-submenu';
                    const submenu = document.getElementById(submenuId);
                    
                    if (submenu) {
                        // Close all other submenus
                        document.querySelectorAll('.nav-submenu').forEach(menu => {
                            if (menu !== submenu) {
                                menu.classList.remove('open');
                            }
                        });
                        
                        // Remove expanded class from all nav links
                        document.querySelectorAll('.nav-link').forEach(link => {
                            if (link !== this) {
                                link.classList.remove('expanded');
                            }
                        });
                        
                        // Toggle current submenu
                        submenu.classList.toggle('open');
                        this.classList.toggle('expanded');
                    }
                });
            });

            // Page navigation
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    if (!this.hasAttribute('data-submenu')) {
                        e.preventDefault();
                        
                        // Remove active class from all links
                        navLinks.forEach(navLink => {
                            navLink.classList.remove('active');
                        });
                        
                        // Add active class to clicked link
                        this.classList.add('active');
                        
                        // Update page title
                        const pageName = this.getAttribute('data-page');
                        const pageText = this.querySelector('.nav-text').textContent;
                        
                        if (pageName) {
                            updatePageContent(pageName, pageText);
                        }
                        
                        // Close mobile menu
                        sidebar.classList.remove('open');
                        mainContent.classList.remove('expanded');
                    }
                });
            });

            // Update page content
            function updatePageContent(pageName, pageTitle) {
                // Update page title
                document.getElementById('pageTitle').textContent = pageTitle;
                
                // Add fade effect
                contentArea.style.opacity = '0';
                contentArea.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    // Update content based on page
                    updateContentArea(pageName, pageTitle);
                    
                    // Fade in
                    contentArea.style.opacity = '1';
                    contentArea.style.transform = 'translateY(0)';
                }, 150);
            }

            // Update content area
            function updateContentArea(pageName, pageTitle) {
                const contentTemplates = {
                    'ilanlar': `
                        <div class="content-header">
                            <h2 class="content-title">İlan Listesi</h2>
                            <button class="btn btn-primary" onclick="showAddIlanForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni İlan Ekle
                            </button>
                        </div>
                        
                        <div id="ilanAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="ilanForm" style="display: none; margin-bottom: 2rem;">
                            <div style="background: var(--card-bg); border-radius: 12px; padding: 2rem; box-shadow: var(--shadow-md); border: 1px solid var(--border-color);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                                    <h3 style="margin: 0; color: var(--text-primary);" id="ilanFormTitle">Yeni İlan Ekle</h3>
                                    <button class="btn btn-secondary" onclick="hideIlanForm()">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                        </svg>
                                        Kapat
                                    </button>
                                </div>
                                
                                <!-- Form Content -->
                                <form id="ilanFormContent" style="display: grid; gap: 1.5rem;">
                                    <!-- Row 1: Başlık ve İlan No -->
                                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Başlık *</label>
                                            <input type="text" id="ilanBaslik" placeholder="İlan başlığını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">İlan No *</label>
                                            <input type="text" id="ilanNo" placeholder="Örn: 426986" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;">
                                        </div>
                                    </div>
                                    
                                    <!-- Row 2: Proje (Opsiyonel) -->
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Proje <span style="color: var(--text-secondary); font-weight: 400;">(Opsiyonel)</span></label>
                                        <select id="ilanProje" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;">
                                            <option value="">Proje Seçin</option>
                                            <option value="yok">Proje Yok</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Row 3: Metrekare, M2 Fiyat, Toplam Fiyat -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Metrekare *</label>
                                            <input type="number" id="ilanMetrekare" placeholder="250.32" step="0.01" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="calculateTotalPrice()">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">M² Fiyat *</label>
                                            <input type="number" id="ilanMetrekareFiyat" placeholder="789" step="0.01" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="calculateTotalPrice()">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Toplam Fiyat</label>
                                            <input type="text" id="ilanToplamFiyat" placeholder="Otomatik hesaplanacak" readonly style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: var(--main-bg); color: var(--text-secondary);">
                                        </div>
                                    </div>
                                    
                                    <!-- Row 4: Ada No, Parsel No -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Ada No *</label>
                                            <input type="text" id="ilanAdaNo" placeholder="104" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;">
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Parsel No *</label>
                                            <input type="text" id="ilanParselNo" placeholder="467" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;">
                                        </div>
                                    </div>
                                    
                                    <!-- Row 5: KAKS, Gabari -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">KAKS *</label>
                                            <select id="ilanKaks" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;">
                                                <option value="">KAKS Seçin</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Gabari *</label>
                                            <select id="ilanGabari" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;">
                                                <option value="">Gabari Seçin</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 6: Tapu Durumu, İmar Durumu -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Tapu Durumu *</label>
                                            <select id="ilanTapuDurumu" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;">
                                                <option value="">Tapu Durumu Seçin</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">İmar Durumu *</label>
                                            <select id="ilanImarDurumu" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;">
                                                <option value="">İmar Durumu Seçin</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 7: Şehir, İlçe, Mahalle -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Şehir *</label>
                                            <select id="ilanSehir" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;" onchange="loadIlceler()">
                                                <option value="">Şehir Seçin</option>
                                                <option value="istanbul">İstanbul</option>
                                                <option value="ankara">Ankara</option>
                                                <option value="izmir">İzmir</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">İlçe *</label>
                                            <select id="ilanIlce" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;" onchange="loadMahalleler()" disabled>
                                                <option value="">İlçe Seçin</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Mahalle *</label>
                                            <select id="ilanMahalle" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; background: white;" disabled>
                                                <option value="">Mahalle Seçin</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 8: Harita Konumu -->
                                    <div style="margin-top: 1rem;">
                                        <label style="display: block; margin-bottom: 1rem; color: var(--text-primary); font-weight: 500; font-size: 1.1rem;">📍 Harita Konumu</label>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                            <!-- Koordinat Girişleri -->
                                            <div style="grid-column: 1 / 3;">
                                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                                    <div>
                                                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Enlem (Latitude) *</label>
                                                        <input type="number" id="ilanLats" placeholder="41.0082" step="any" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="updateMapFromInputs()">
                                                    </div>
                                                    <div>
                                                        <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Boylam (Longitude) *</label>
                                                        <input type="number" id="ilanLangs" placeholder="28.9784" step="any" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="updateMapFromInputs()">
                                                    </div>
                                                </div>
                                                
                                                <!-- Koordinat Bilgisi -->
                                                <div class="coordinates-display" id="coordinatesDisplay" style="display: none;">
                                                    <div class="coordinates-info">
                                                        <strong>Seçilen Konum:</strong><br>
                                                        <span id="selectedCoordinates">Henüz konum seçilmedi</span>
                                                    </div>
                                                    <button type="button" class="clear-location-btn" onclick="clearMapLocation()">
                                                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                        </svg>
                                                        Temizle
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <!-- Harita -->
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Haritadan Konum Seç</label>
                                                <div class="map-container">
                                                    <div class="map-overlay">
                                                        Haritaya tıklayarak konum seçin
                                                    </div>
                                                    <div id="ilanMap" class="map-canvas"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 9: Öngörülen Fiyat Artışı -->
                                    <div style="margin-top: 2rem;">
                                        <label style="display: block; margin-bottom: 1rem; color: var(--text-primary); font-weight: 500; font-size: 1.1rem;">📈 Öngörülen Fiyat Artışı</label>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">1. Sene Artış Oranı</label>
                                                <div style="position: relative;">
                                                    <input type="number" id="ilan1SeneArtis" placeholder="15" step="0.1" min="0" max="100" style="width: 100%; padding: 0.75rem 2.5rem 0.75rem 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="calculateFuturePrices()">
                                                    <span style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary); font-size: 0.9rem; pointer-events: none;">%</span>
                                                </div>
                                                <div style="margin-top: 0.5rem; padding: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Tahmini Fiyat:</div>
                                                    <div id="fiyat1Sene" style="font-weight: 600; color: var(--primary-color); font-size: 0.9rem;">Hesaplanacak</div>
                                                </div>
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">2. Sene Artış Oranı</label>
                                                <div style="position: relative;">
                                                    <input type="number" id="ilan2SeneArtis" placeholder="12" step="0.1" min="0" max="100" style="width: 100%; padding: 0.75rem 2.5rem 0.75rem 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="calculateFuturePrices()">
                                                    <span style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary); font-size: 0.9rem; pointer-events: none;">%</span>
                                                </div>
                                                <div style="margin-top: 0.5rem; padding: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Tahmini Fiyat:</div>
                                                    <div id="fiyat2Sene" style="font-weight: 600; color: var(--success-color); font-size: 0.9rem;">Hesaplanacak</div>
                                                </div>
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">3. Sene Artış Oranı</label>
                                                <div style="position: relative;">
                                                    <input type="number" id="ilan3SeneArtis" placeholder="10" step="0.1" min="0" max="100" style="width: 100%; padding: 0.75rem 2.5rem 0.75rem 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;" oninput="calculateFuturePrices()">
                                                    <span style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary); font-size: 0.9rem; pointer-events: none;">%</span>
                                                </div>
                                                <div style="margin-top: 0.5rem; padding: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                                    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 0.25rem;">Tahmini Fiyat:</div>
                                                    <div id="fiyat3Sene" style="font-weight: 600; color: var(--warning-color); font-size: 0.9rem;">Hesaplanacak</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Fiyat Artış Özeti -->
                                        <div style="margin-top: 1rem; padding: 1rem; background: linear-gradient(135deg, rgba(37, 99, 235, 0.05) 0%, rgba(16, 185, 129, 0.05) 100%); border: 1px solid rgba(37, 99, 235, 0.2); border-radius: 8px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                                <h4 style="margin: 0; color: var(--text-primary); font-size: 0.95rem;">📊 Fiyat Artış Özeti</h4>
                                                <button type="button" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 0.8rem;" onclick="resetPriceProjections()">
                                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20" style="margin-right: 0.25rem;">
                                                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Sıfırla
                                                </button>
                                            </div>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 1rem; font-size: 0.85rem;">
                                                <div style="text-align: center;">
                                                    <div style="color: var(--text-secondary); margin-bottom: 0.25rem;">Mevcut Fiyat</div>
                                                    <div id="mevcutFiyatOzet" style="font-weight: 600; color: var(--text-primary);">-</div>
                                                </div>
                                                <div style="text-align: center;">
                                                    <div style="color: var(--text-secondary); margin-bottom: 0.25rem;">1. Sene</div>
                                                    <div id="birSeneOzet" style="font-weight: 600; color: var(--primary-color);">-</div>
                                                </div>
                                                <div style="text-align: center;">
                                                    <div style="color: var(--text-secondary); margin-bottom: 0.25rem;">2. Sene</div>
                                                    <div id="ikiSeneOzet" style="font-weight: 600; color: var(--success-color);">-</div>
                                                </div>
                                                <div style="text-align: center;">
                                                    <div style="color: var(--text-secondary); margin-bottom: 0.25rem;">3. Sene</div>
                                                    <div id="ucSeneOzet" style="font-weight: 600; color: var(--warning-color);">-</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 10: İlan Fotoğrafları -->
                                    <div style="margin-top: 2rem;">
                                        <label style="display: block; margin-bottom: 1rem; color: var(--text-primary); font-weight: 500; font-size: 1.1rem;">📸 İlan Fotoğrafları</label>
                                        
                                        <!-- Fotoğraf Yükleme Alanı -->
                                        <div class="photo-upload-container" id="photoUploadArea">
                                            <input type="file" id="photoInput" class="photo-input" accept="image/*" multiple>
                                            <svg class="photo-upload-icon" fill="none" stroke="currentColor" viewBox="0 0 48 48">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M24 12V36M12 24h24M24 4a8 8 0 00-8 8v8a8 8 0 008 8 8 8 0 008-8v-8a8 8 0 00-8-8z"/>
                                            </svg>
                                            <div class="photo-upload-text">Fotoğraf yüklemek için tıklayın veya sürükleyip bırakın</div>
                                            <div class="photo-upload-hint">PNG, JPG, JPEG dosyaları desteklenir (Max 10MB/foto, 20 foto)</div>
                                        </div>
                                        
                                        <!-- Yüklenen Fotoğraflar -->
                                        <div id="photosContainer" style="display: none;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                                <h4 style="margin: 0; color: var(--text-primary); font-size: 1rem;">Yüklenen Fotoğraflar</h4>
                                                <div style="display: flex; gap: 0.5rem;">
                                                    <button type="button" class="btn-photo-action" onclick="sortPhotos()">
                                                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                            <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1zM3 16a1 1 0 011-1h4a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                        </svg>
                                                        Sırala
                                                    </button>
                                                    <button type="button" class="btn-photo-action danger" onclick="clearAllPhotos()">
                                                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                            <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                                        </svg>
                                                        Tümünü Sil
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <div class="photos-grid" id="photosGrid">
                                                <!-- Fotoğraflar buraya dinamik olarak eklenecek -->
                                            </div>
                                            
                                            <!-- Fotoğraf Özeti -->
                                            <div class="photos-summary">
                                                <div class="photos-count" id="photosCount">
                                                    <strong>0</strong> fotoğraf yüklendi
                                                </div>
                                                <div class="photos-actions">
                                                    <button type="button" class="btn-photo-action primary" onclick="addMorePhotos()">
                                                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                                        </svg>
                                                        Daha Fazla Ekle
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 11: İlan Özellikleri -->
                                    <div style="margin-top: 2rem;">
                                        <label style="display: block; margin-bottom: 1rem; color: var(--text-primary); font-weight: 500; font-size: 1.1rem;">⚙️ İlan Özellikleri</label>
                                        
                                        <div class="features-container">
                                            <!-- Alt Yapı Özellikleri -->
                                            <div class="features-category">
                                                <div class="features-category-title">
                                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Alt Yapı
                                                </div>
                                                <div class="features-grid">
                                                    <div class="feature-item">
                                                        <span class="feature-label">Elektrik</span>
                                                        <div class="feature-toggle" data-feature="elektrik" onclick="toggleFeature('elektrik')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Sanayi Elektriği</span>
                                                        <div class="feature-toggle" data-feature="sanayi_elektrik" onclick="toggleFeature('sanayi_elektrik')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Su</span>
                                                        <div class="feature-toggle" data-feature="su" onclick="toggleFeature('su')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Telefon</span>
                                                        <div class="feature-toggle" data-feature="telefon" onclick="toggleFeature('telefon')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Doğalgaz</span>
                                                        <div class="feature-toggle" data-feature="doganlaz" onclick="toggleFeature('doganlaz')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Kanalizasyon</span>
                                                        <div class="feature-toggle" data-feature="kanalizasyon" onclick="toggleFeature('kanalizasyon')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Arıtma</span>
                                                        <div class="feature-toggle" data-feature="aritma" onclick="toggleFeature('aritma')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Sondaj Kuyu</span>
                                                        <div class="feature-toggle" data-feature="sondaj_kuyu" onclick="toggleFeature('sondaj_kuyu')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Zemin Etüdü</span>
                                                        <div class="feature-toggle" data-feature="zemin_etudu" onclick="toggleFeature('zemin_etudu')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Yolu Açılmış</span>
                                                        <div class="feature-toggle" data-feature="yolu_acilmis" onclick="toggleFeature('yolu_acilmis')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Yolu Var</span>
                                                        <div class="feature-toggle" data-feature="yolu_var" onclick="toggleFeature('yolu_var')"></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Konum Özellikleri -->
                                            <div class="features-category">
                                                <div class="features-category-title">
                                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Konum
                                                </div>
                                                <div class="features-grid">
                                                    <div class="feature-item">
                                                        <span class="feature-label">Ana Yola Yakın</span>
                                                        <div class="feature-toggle" data-feature="ana_yola_yakin" onclick="toggleFeature('ana_yola_yakin')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Denize Sıfır</span>
                                                        <div class="feature-toggle" data-feature="denize_sifir" onclick="toggleFeature('denize_sifir')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">İtfaiyeye Yakın</span>
                                                        <div class="feature-toggle" data-feature="itfaiyeye_yakin" onclick="toggleFeature('itfaiyeye_yakin')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Havalimanına Yakın</span>
                                                        <div class="feature-toggle" data-feature="havalimanina_yakin" onclick="toggleFeature('havalimanina_yakin')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Toplu Taşımaya Yakın</span>
                                                        <div class="feature-toggle" data-feature="toplu_tasimaya_yakin" onclick="toggleFeature('toplu_tasimaya_yakin')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Denize Yakın</span>
                                                        <div class="feature-toggle" data-feature="denize_yakin" onclick="toggleFeature('denize_yakin')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Hastaneye Yakın</span>
                                                        <div class="feature-toggle" data-feature="hastaneye_yakin" onclick="toggleFeature('hastaneye_yakin')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Su Kaynağına Yakın</span>
                                                        <div class="feature-toggle" data-feature="su_kaynagina_yakin" onclick="toggleFeature('su_kaynagina_yakin')"></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Genel Özellikler -->
                                            <div class="features-category">
                                                <div class="features-category-title">
                                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Genel Özellikler
                                                </div>
                                                <div class="features-grid">
                                                    <div class="feature-item">
                                                        <span class="feature-label">İfrazlı</span>
                                                        <div class="feature-toggle" data-feature="ifrazli" onclick="toggleFeature('ifrazli')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Parselli</span>
                                                        <div class="feature-toggle" data-feature="parselli" onclick="toggleFeature('parselli')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Projeli</span>
                                                        <div class="feature-toggle" data-feature="projeli" onclick="toggleFeature('projeli')"></div>
                                                    </div>
                                                    <div class="feature-item">
                                                        <span class="feature-label">Köşe Parselli</span>
                                                        <div class="feature-toggle" data-feature="kose_parselli" onclick="toggleFeature('kose_parselli')"></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Özellikler Özeti -->
                                            <div class="features-summary">
                                                <div class="features-summary-title">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Seçilen Özellikler Özeti
                                                </div>
                                                <div class="features-summary-grid" id="featuresSummary">
                                                    <div class="feature-summary-item">
                                                        <div class="feature-summary-indicator"></div>
                                                        <span>Henüz özellik seçilmedi</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Özellikler Aksiyonları -->
                                            <div class="features-actions">
                                                <button type="button" class="btn-feature-action primary" onclick="selectAllFeatures()">
                                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Tümünü Seç
                                                </button>
                                                <button type="button" class="btn-feature-action" onclick="deselectAllFeatures()">
                                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Tümünü Kaldır
                                                </button>
                                                <button type="button" class="btn-feature-action danger" onclick="resetFeatures()">
                                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4 2a1 1 0 000 2h2a1 1 0 000-2H4zM3 8a1 1 0 000 2h2a1 1 0 000-2H3zm1 4a1 1 0 100 2h2a1 1 0 100-2H4zm1 4a1 1 0 100 2h2a1 1 0 100-2H5z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Sıfırla
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 12: İlan Çevreleri -->
                                    <div style="margin-top: 2rem;">
                                        <label style="display: block; margin-bottom: 1rem; color: var(--text-primary); font-weight: 500; font-size: 1.1rem;">🏢 İlan Çevreleri</label>
                                        
                                        <div class="cevreler-container">
                                            <div id="cevrelerLoading" class="cevreler-loading">
                                                <div class="loading"></div>
                                                <p style="margin-top: 1rem;">Çevreler yükleniyor...</p>
                                            </div>
                                            
                                            <div id="cevrelerContent" style="display: none;">
                                                <!-- Çevreler kategorilere göre buraya dinamik olarak yüklenecek -->
                                            </div>
                                            
                                            <div id="cevrelerError" class="cevreler-error" style="display: none;">
                                                <p>Çevreler yüklenirken hata oluştu.</p>
                                                <button type="button" class="btn btn-secondary" onclick="loadCevreler()" style="margin-top: 1rem;">
                                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M4 2a1 1 0 000 2h2a1 1 0 000-2H4zM3 8a1 1 0 000 2h2a1 1 0 000-2H3zm1 4a1 1 0 100 2h2a1 1 0 100-2H4zm1 4a1 1 0 100 2h2a1 1 0 100-2H5z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Tekrar Dene
                                                </button>
                                            </div>

                                            <!-- Çevreler Özeti -->
                                            <div class="cevreler-summary">
                                                <div class="cevreler-summary-title">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                                                    </svg>
                                                    Seçilen Çevreler Özeti
                                                </div>
                                                <div class="cevreler-summary-grid" id="cevrelerSummary">
                                                    <div class="cevre-summary-item">
                                                        <div class="cevre-summary-indicator"></div>
                                                        <span>Henüz çevre seçilmedi</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 13: İlan Açıklaması -->
                                    <div style="margin-top: 2rem;">
                                        <label style="display: block; margin-bottom: 1rem; color: var(--text-primary); font-weight: 500; font-size: 1.1rem;">📝 İlan Açıklaması</label>
                                        
                                        <div class="editor-container">
                                            <!-- Toolbar -->
                                            <div class="editor-toolbar">
                                                <button type="button" class="editor-btn" onclick="execCommand('bold')" title="Kalın (Ctrl+B)">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M12 6a1 1 0 011 1v2a1 1 0 11-2 0V7a1 1 0 011-1zM8 6a1 1 0 011 1v6a1 1 0 11-2 0V7a1 1 0 011-1zM6 4a1 1 0 000 2h8a1 1 0 100-2H6z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('italic')" title="İtalik (Ctrl+I)">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M8 3a1 1 0 01.707.293l4 4a1 1 0 01-1.414 1.414L10 6.414V16a1 1 0 11-2 0V6.414L5.707 8.707a1 1 0 01-1.414-1.414l4-4A1 1 0 018 3z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('underline')" title="Altı Çizili (Ctrl+U)">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                
                                                <div class="editor-separator"></div>
                                                
                                                <button type="button" class="editor-btn" onclick="execCommand('insertUnorderedList')" title="Madde İşareti">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('insertOrderedList')" title="Numaralı Liste">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                
                                                <div class="editor-separator"></div>
                                                
                                                <button type="button" class="editor-btn" onclick="execCommand('formatBlock', 'h3')" title="Başlık 3">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('formatBlock', 'h4')" title="Başlık 4">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('formatBlock', 'p')" title="Paragraf">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                
                                                <div class="editor-separator"></div>
                                                
                                                <button type="button" class="editor-btn" onclick="execCommand('justifyLeft')" title="Sola Hizala">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('justifyCenter')" title="Ortala">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                                <button type="button" class="editor-btn" onclick="execCommand('justifyRight')" title="Sağa Hizala">
                                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"/>
                                                    </svg>
                                                </button>
                                            </div>
                                            
                                            <!-- Content Area -->
                                            <div class="editor-content" 
                                                 id="ilanAciklama" 
                                                 contenteditable="true" 
                                                 oninput="updateEditorStats()"
                                                 onkeydown="handleEditorKeydown(event)"
                                                 onpaste="handleEditorPaste(event)"></div>
                                            
                                            <!-- Stats Bar -->
                                            <div class="editor-stats">
                                                <div class="editor-word-count">
                                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                                        <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                                    </svg>
                                                    <span id="wordCount">0 kelime</span>
                                                </div>
                                                <div class="editor-actions">
                                                    <button type="button" class="btn-editor-action" onclick="clearEditor()">
                                                        <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20" style="margin-right: 0.25rem;">
                                                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                                        </svg>
                                                        Temizle
                                                    </button>
                                                    <button type="button" class="btn-editor-action primary" onclick="insertSampleText()">
                                                        <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20" style="margin-right: 0.25rem;">
                                                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                                        </svg>
                                                        Örnek Metin
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Form Actions -->
                                    <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                                        <button type="button" class="btn btn-secondary" onclick="hideIlanForm()">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                            </svg>
                                            İptal
                                        </button>
                                        <button type="button" class="btn btn-primary" onclick="saveIlan()">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                            </svg>
                                            İlanı Kaydet
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- İlan Listesi -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut İlanlar</h3>
                            </div>
                            <div id="ilanList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">İlanlar yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'ana-resim': `
                        <div class="content-header">
                            <h2 class="content-title">Ana Resim Yönetimi</h2>
                        </div>
                        
                        <div id="uploadAlert" class="alert"></div>
                        
                        <div class="upload-area" id="uploadArea">
                            <input type="file" id="fileInput" class="file-input" accept="image/*">
                            <svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 48 48">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M24 12V36M12 24h24M24 4a8 8 0 00-8 8v8a8 8 0 008 8 8 8 0 008-8v-8a8 8 0 00-8-8z"/>
                            </svg>
                            <div class="upload-text">Resim yüklemek için tıklayın veya sürükleyip bırakın</div>
                            <div class="upload-hint">PNG, JPG, JPEG dosyaları desteklenir (Max 5MB)</div>
                            
                            <div class="upload-progress" id="uploadProgress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                                <div class="progress-text" id="progressText">Yükleniyor... 0%</div>
                            </div>
                        </div>
                        
                        <div class="uploaded-image" id="uploadedImage">
                            <img id="previewImage" src="" alt="Yüklenen resim">
                            <div class="image-actions">
                                <span class="image-url" id="imageUrl"></span>
                                <button class="btn-copy" id="copyUrlBtn">URL Kopyala</button>
                                <button class="btn-delete" id="deleteImageBtn">Sil</button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 2rem; padding: 1.5rem; background: var(--card-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);">Mevcut Ana Resim</h3>
                            <div id="currentMainImage">
                                <p style="color: var(--text-secondary);">Ana sayfa resmi yüklenmedi.</p>
                            </div>
                        </div>
                    `,
                    'musteri-yorumlari': `
                        <div class="content-header">
                            <h2 class="content-title">Müşteri Yorumları</h2>
                            <button class="btn btn-primary">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni Yorum Ekle
                            </button>
                        </div>
                        <div style="padding: 2rem; text-align: center; color: var(--text-secondary);">
                            <p>Müşteri yorumlarını buradan yönetebilir, yeni yorumlar ekleyebilir ve mevcut yorumları düzenleyebilirsiniz.</p>
                        </div>
                    `,
                    'imar-durumlari': `
                        <div class="content-header">
                            <h2 class="content-title">İmar Durumları</h2>
                            <button class="btn btn-primary" onclick="showAddImarForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni İmar Durumu Ekle
                            </button>
                        </div>
                        
                        <div id="imarAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="imarForm" style="display: none; margin-bottom: 2rem; padding: 1.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" id="imarFormTitle">Yeni İmar Durumu Ekle</h3>
                            <div style="display: flex; gap: 1rem; align-items: end;">
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">İmar Durumu</label>
                                    <input type="text" id="imarNameInput" placeholder="İmar durumu adını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem;">
                                </div>
                                <button class="btn btn-primary" onclick="saveImar()" id="saveImarBtn">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Kaydet
                                </button>
                                <button class="btn btn-secondary" onclick="hideImarForm()">İptal</button>
                            </div>
                        </div>
                        
                        <!-- List -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut İmar Durumları</h3>
                            </div>
                            <div id="imarList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">İmar durumları yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'tapu-durumlari': `
                        <div class="content-header">
                            <h2 class="content-title">Tapu Durumları</h2>
                            <button class="btn btn-primary" onclick="showAddTapuForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni Tapu Durumu Ekle
                            </button>
                        </div>
                        
                        <div id="tapuAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="tapuForm" style="display: none; margin-bottom: 2rem; padding: 1.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" id="tapuFormTitle">Yeni Tapu Durumu Ekle</h3>
                            <div style="display: flex; gap: 1rem; align-items: end;">
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Tapu Durumu</label>
                                    <input type="text" id="tapuNameInput" placeholder="Tapu durumu adını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem;">
                                </div>
                                <button class="btn btn-primary" onclick="saveTapu()" id="saveTapuBtn">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Kaydet
                                </button>
                                <button class="btn btn-secondary" onclick="hideTapuForm()">İptal</button>
                            </div>
                        </div>
                        
                        <!-- List -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut Tapu Durumları</h3>
                            </div>
                            <div id="tapuList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">Tapu durumları yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'cevreler-kategorileri': `
                        <div class="content-header">
                            <h2 class="content-title">Çevre Kategorileri</h2>
                            <button class="btn btn-primary" onclick="showAddCevreKategoriForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni Kategori Ekle
                            </button>
                        </div>
                        
                        <div id="cevreKategoriAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="cevreKategoriForm" style="display: none; margin-bottom: 2rem; padding: 1.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" id="cevreKategoriFormTitle">Yeni Çevre Kategorisi Ekle</h3>
                            <div style="display: flex; gap: 1rem; align-items: end;">
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Kategori Adı</label>
                                    <input type="text" id="cevreKategoriNameInput" placeholder="Kategori adını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem;">
                                </div>
                                <button class="btn btn-primary" onclick="saveCevreKategori()" id="saveCevreKategoriBtn">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Kaydet
                                </button>
                                <button class="btn btn-secondary" onclick="hideCevreKategoriForm()">İptal</button>
                            </div>
                        </div>
                        
                        <!-- List -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut Çevre Kategorileri</h3>
                            </div>
                            <div id="cevreKategoriList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">Çevre kategorileri yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'cevreler': `
                        <div class="content-header">
                            <h2 class="content-title">Çevreler</h2>
                            <button class="btn btn-primary" onclick="showAddCevreForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni Çevre Ekle
                            </button>
                        </div>
                        
                        <div id="cevreAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="cevreForm" style="display: none; margin-bottom: 2rem; padding: 1.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" id="cevreFormTitle">Yeni Çevre Ekle</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 1rem; align-items: end;">
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Çevre Adı</label>
                                    <input type="text" id="cevreNameInput" placeholder="Çevre adını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem;">
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Kategori</label>
                                    <select id="cevreKategoriSelect" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem; background: white;">
                                        <option value="">Kategori Seçin</option>
                                    </select>
                                </div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn btn-primary" onclick="saveCevre()" id="saveCevreBtn">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                        </svg>
                                        Kaydet
                                    </button>
                                    <button class="btn btn-secondary" onclick="hideCevreForm()">İptal</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- List -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut Çevreler</h3>
                            </div>
                            <div id="cevreList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">Çevreler yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'gabari': `
                        <div class="content-header">
                            <h2 class="content-title">Gabari Değerleri</h2>
                            <button class="btn btn-primary" onclick="showAddGabariForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni Gabari Ekle
                            </button>
                        </div>
                        
                        <div id="gabariAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="gabariForm" style="display: none; margin-bottom: 2rem; padding: 1.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" id="gabariFormTitle">Yeni Gabari Değeri Ekle</h3>
                            <div style="display: flex; gap: 1rem; align-items: end;">
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Gabari Değeri</label>
                                    <input type="text" id="gabariValueInput" placeholder="Örn: 2.50, 3.00, 4.50..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem;">
                                </div>
                                <button class="btn btn-primary" onclick="saveGabari()" id="saveGabariBtn">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Kaydet
                                </button>
                                <button class="btn btn-secondary" onclick="hideGabariForm()">İptal</button>
                            </div>
                        </div>
                        
                        <!-- List -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut Gabari Değerleri</h3>
                            </div>
                            <div id="gabariList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">Gabari değerleri yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'kaks': `
                        <div class="content-header">
                            <h2 class="content-title">KAKS Değerleri</h2>
                            <button class="btn btn-primary" onclick="showAddKaksForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni KAKS Ekle
                            </button>
                        </div>
                        
                        <div id="kaksAlert" class="alert"></div>
                        
                        <!-- Add/Edit Form -->
                        <div id="kaksForm" style="display: none; margin-bottom: 2rem; padding: 1.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" id="kaksFormTitle">Yeni KAKS Değeri Ekle</h3>
                            <div style="display: flex; gap: 1rem; align-items: end;">
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">KAKS Değeri</label>
                                    <input type="text" id="kaksValueInput" placeholder="Örn: 0.15, 0.30, 0.45..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.9rem;">
                                </div>
                                <button class="btn btn-primary" onclick="saveKaks()" id="saveKaksBtn">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    Kaydet
                                </button>
                                <button class="btn btn-secondary" onclick="hideKaksForm()">İptal</button>
                            </div>
                        </div>
                        
                        <!-- List -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut KAKS Değerleri</h3>
                            </div>
                            <div id="kaksList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">KAKS değerleri yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `,
                    'proje-yonetimi': `
                        <div class="content-header">
                            <h2 class="content-title">Proje Yönetimi</h2>
                            <button class="btn btn-primary" onclick="showAddProjeForm()">
                                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Yeni Proje Ekle
                            </button>
                        </div>
                        
                        <div id="projeAlert" class="alert"></div>
                        
                        <!-- Add/Edit Proje Form -->
                        <div id="projeForm" style="display: none; margin-bottom: 2rem;">
                            <div style="background: var(--card-bg); border-radius: 12px; padding: 2rem; box-shadow: var(--shadow-md); border: 1px solid var(--border-color);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                                    <h3 style="margin: 0; color: var(--text-primary);" id="projeFormTitle">Yeni Proje Ekle</h3>
                                    <button class="btn btn-secondary" onclick="hideProjeForm()">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                        </svg>
                                        Kapat
                                    </button>
                                </div>
                                
                                <!-- Form Content -->
                                <form id="projeFormContent" style="display: grid; gap: 1.5rem;">
                                    <!-- Temel Bilgiler -->
                                    <div style="background: var(--main-bg); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem;">📋 Temel Bilgiler</h4>
                                        
                                        <div style="display: grid; gap: 1rem;">
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Proje Başlığı *</label>
                                                <input type="text" id="projeBaslik" placeholder="Proje başlığını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;">
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">Proje Açıklaması *</label>
                                                <textarea id="projeAciklama" placeholder="Proje açıklamasını girin..." style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.95rem; min-height: 120px; resize: vertical;"></textarea>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- İlan Seçimi -->
                                    <div style="background: var(--main-bg); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem;">🏠 Proje İlanları</h4>
                                        
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                            <!-- Aktif İlanlar -->
                                            <div>
                                                <h5 style="margin: 0 0 0.5rem 0; color: var(--text-primary);">Aktif İlanlar</h5>
                                                <div id="aktifIlanlar" style="background: white; border: 2px dashed var(--border-color); border-radius: 8px; min-height: 300px; max-height: 400px; overflow-y: auto; padding: 1rem;">
                                                    <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                                        <div class="loading"></div>
                                                        <p style="margin-top: 1rem;">İlanlar yükleniyor...</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Proje İlanları -->
                                            <div>
                                                <h5 style="margin: 0 0 0.5rem 0; color: var(--text-primary);">Proje İlanları</h5>
                                                <div id="projeIlanlari" style="background: white; border: 2px dashed var(--success-color); border-radius: 8px; min-height: 300px; max-height: 400px; overflow-y: auto; padding: 1rem;" ondrop="dropIlan(event)" ondragover="allowDrop(event)">
                                                    <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                                        <svg width="48" height="48" fill="currentColor" viewBox="0 0 20 20" style="opacity: 0.3;">
                                                            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                                                        </svg>
                                                        <p>İlanları buraya sürükleyin</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Altyapı Özellikleri -->
                                    <div style="background: var(--main-bg); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem;">🔧 Altyapı Özellikleri</h4>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_elektrik" style="margin: 0;">
                                                <span>Elektrik</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_sanayi_elektrik" style="margin: 0;">
                                                <span>Sanayi Elektriği</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_su" style="margin: 0;">
                                                <span>Su</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_telefon" style="margin: 0;">
                                                <span>Telefon</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_dogalgaz" style="margin: 0;">
                                                <span>Doğalgaz</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_kanalizasyon" style="margin: 0;">
                                                <span>Kanalizasyon</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_aritma" style="margin: 0;">
                                                <span>Arıtma</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_sondaj_kuyu" style="margin: 0;">
                                                <span>Sondaj & Kuyu</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_zemin_etudu" style="margin: 0;">
                                                <span>Zemin Etüdü</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_yolu_acilmis" style="margin: 0;">
                                                <span>Yolu Açılmış</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Konum Özellikleri -->
                                    <div style="background: var(--main-bg); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem;">📍 Konum Özellikleri</h4>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_ana_yola_yakin" style="margin: 0;">
                                                <span>Anayola Yakın</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_denize_sifir" style="margin: 0;">
                                                <span>Denize Sıfır</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_itfaiyeye_yakin" style="margin: 0;">
                                                <span>İtfaiye Yakın</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_havalimanina_yakin" style="margin: 0;">
                                                <span>Havalimanı Yakın</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_toplu_tasimaya_yakin" style="margin: 0;">
                                                <span>Toplu Ulaşıma Yakın</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_denize_yakin" style="margin: 0;">
                                                <span>Denize Yakın</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_hastaneye_yakin" style="margin: 0;">
                                                <span>Hastane Yakın</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_su_kaynagina_yakin" style="margin: 0;">
                                                <span>Su Kaynağına Yakın</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Genel Özellikler -->
                                    <div style="background: var(--main-bg); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                        <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem;">⚙️ Genel Özellikler</h4>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_ifrazli" style="margin: 0;">
                                                <span>İfrazlı</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_parselli" style="margin: 0;">
                                                <span>Parselli</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_projeli" style="margin: 0;">
                                                <span>Projeli</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                                <input type="checkbox" id="proje_kose_parselli" style="margin: 0;">
                                                <span>Köşe Parselli</span>
                                            </label>
                                        </div>
                                    </div>
                                </form>
                                
                                <div style="display: flex; gap: 1rem; margin-top: 2rem; justify-content: flex-end;">
                                    <button class="btn btn-primary" onclick="saveProje()" style="min-width: 120px;">
                                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                        </svg>
                                        Kaydet
                                    </button>
                                    <button class="btn btn-secondary" onclick="hideProjeForm()">İptal</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Proje Listesi -->
                        <div style="background: var(--card-bg); border-radius: 8px; overflow: hidden; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--main-bg);">
                                <h3 style="margin: 0; color: var(--text-primary);">Mevcut Projeler</h3>
                            </div>
                            <div id="projeList" style="padding: 1rem;">
                                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                    <div class="loading"></div>
                                    <p style="margin-top: 1rem;">Projeler yükleniyor...</p>
                                </div>
                            </div>
                        </div>
                    `
                };

                const template = contentTemplates[pageName] || `
                    <div class="content-header">
                        <h2 class="content-title">${pageTitle}</h2>
                        <button class="btn btn-primary">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                            Yeni Ekle
                        </button>
                    </div>
                    <div style="padding: 2rem; text-align: center; color: var(--text-secondary);">
                        <p>${pageTitle} yönetim sayfası geliştirme aşamasındadır.</p>
                        <div style="margin-top: 2rem;">
                            <div class="loading"></div>
                        </div>
                    </div>
                `;

                contentArea.innerHTML = template;
                
                // Auto-load data when page is displayed
                setTimeout(() => {
                    switch(pageName) {
                        case 'ana-resim':
                            // Already handled by existing code
                            break;
                        case 'ilanlar':
                            loadIlanList();
                            break;
                        case 'imar-durumlari':
                            loadImarList();
                            break;
                        case 'tapu-durumlari':
                            loadTapuList();
                            break;
                        case 'cevreler-kategorileri':
                            loadCevreKategoriList();
                            break;
                        case 'cevreler':
                            loadCevreList();
                            break;
                        case 'gabari':
                            loadGabariList();
                            break;
                        case 'kaks':
                            loadKaksList();
                            break;
                        case 'proje-yonetimi':
                            loadProjeList();
                            break;
                    }
                }, 100);
            }

            // Search functionality
            const searchInput = document.querySelector('.search-input');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                // Implement search functionality here
                console.log('Searching for:', searchTerm);
            });

            // Auto-expand listings submenu on load
            const listingsSubmenu = document.getElementById('listings-submenu');
            const listingsToggle = document.querySelector('[data-submenu="listings"]');
            if (listingsSubmenu && listingsToggle) {
                listingsSubmenu.classList.add('open');
                listingsToggle.classList.add('expanded');
            }

            // Responsive handling
            function handleResize() {
                if (window.innerWidth > 768) {
                    sidebar.classList.remove('open');
                    mainContent.classList.remove('expanded');
                }
            }

            window.addEventListener('resize', handleResize);

            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 768 && 
                    !sidebar.contains(e.target) && 
                    !menuToggle.contains(e.target) && 
                    sidebar.classList.contains('open')) {
                    sidebar.classList.remove('open');
                    mainContent.classList.remove('expanded');
                }
            });

            // Initialize smooth transitions
            contentArea.style.transition = 'opacity 0.3s ease, transform 0.3s ease';

            // Initialize file upload functionality
            initializeFileUpload();
        });

        // File Upload Functions
        function initializeFileUpload() {
            // Initialize upload functionality when ana-resim page is loaded
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList') {
                        const uploadArea = document.getElementById('uploadArea');
                        if (uploadArea && !uploadArea.classList.contains('initialized')) {
                            setupFileUpload();
                            uploadArea.classList.add('initialized');
                        }
                    }
                });
            });

            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
        }

        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const uploadedImage = document.getElementById('uploadedImage');
            const previewImage = document.getElementById('previewImage');
            const imageUrl = document.getElementById('imageUrl');
            const copyUrlBtn = document.getElementById('copyUrlBtn');
            const deleteImageBtn = document.getElementById('deleteImageBtn');
            const uploadAlert = document.getElementById('uploadAlert');

            if (!uploadArea) return;

            // Click to upload
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });

            // File input change
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });

            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload(files[0]);
                }
            });

            // Copy URL button
            if (copyUrlBtn) {
                copyUrlBtn.addEventListener('click', () => {
                    const url = imageUrl.textContent;
                    navigator.clipboard.writeText(url).then(() => {
                        showAlert('URL başarıyla kopyalandı!', 'success');
                    });
                });
            }

            // Delete image button
            if (deleteImageBtn) {
                deleteImageBtn.addEventListener('click', () => {
                    if (confirm('Bu resmi silmek istediğinizden emin misiniz?')) {
                        deleteCurrentImage();
                    }
                });
            }

            // Load existing main image
            loadCurrentMainImage();
        }

        function handleFileUpload(file) {
            // File validation
            if (!file.type.startsWith('image/')) {
                showAlert('Lütfen geçerli bir resim dosyası seçin.', 'error');
                return;
            }

            if (file.size > 5 * 1024 * 1024) { // 5MB limit
                showAlert('Dosya boyutu 5MB\'dan küçük olmalıdır.', 'error');
                return;
            }

            // Show progress
            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            uploadProgress.style.display = 'block';
            progressFill.style.width = '0%';
            progressText.textContent = 'Yükleniyor... 0%';

            // Create filename with timestamp
            const timestamp = new Date().getTime();
            const fileName = `main-images/ana-resim-${timestamp}.${file.name.split('.').pop()}`;

            // Upload to Firebase Storage
            const uploadTask = storageRef.child(fileName).put(file);

            uploadTask.on('state_changed',
                (snapshot) => {
                    // Progress monitoring
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    progressFill.style.width = progress + '%';
                    progressText.textContent = `Yükleniyor... ${Math.round(progress)}%`;
                },
                (error) => {
                    // Error handling
                    console.error('Upload error:', error);
                    showAlert('Resim yüklenirken bir hata oluştu.', 'error');
                    uploadProgress.style.display = 'none';
                },
                () => {
                    // Upload completed successfully
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        progressText.textContent = 'Yükleme tamamlandı!';
                        
                        setTimeout(() => {
                            uploadProgress.style.display = 'none';
                            showUploadedImage(downloadURL, fileName);
                            saveMainImageToDatabase(downloadURL, fileName);
                            showAlert('Ana resim başarıyla yüklendi!', 'success');
                        }, 1000);
                    });
                }
            );
        }

        function showUploadedImage(url, fileName) {
            const uploadedImage = document.getElementById('uploadedImage');
            const previewImage = document.getElementById('previewImage');
            const imageUrl = document.getElementById('imageUrl');

            if (uploadedImage && previewImage && imageUrl) {
                previewImage.src = url;
                imageUrl.textContent = url;
                uploadedImage.style.display = 'block';
                
                // Update current main image display
                updateCurrentMainImageDisplay(url);
            }
        }

        function saveMainImageToDatabase(downloadURL, fileName) {
            // Save image info to Realtime Database
            const mainImageRef = database.ref('site-settings/main-image');
            mainImageRef.set({
                url: downloadURL,
                fileName: fileName,
                uploadedAt: firebase.database.ServerValue.TIMESTAMP,
                isActive: true
            }).then(() => {
                console.log('Main image saved to Realtime Database');
            }).catch((error) => {
                console.error('Error saving to Realtime Database:', error);
            });
        }

        function loadCurrentMainImage() {
            const currentMainImage = document.getElementById('currentMainImage');
            if (!currentMainImage) return;

            const mainImageRef = database.ref('site-settings/main-image');
            mainImageRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data && data.url) {
                        updateCurrentMainImageDisplay(data.url);
                    }
                })
                .catch((error) => {
                    console.error('Error loading current image:', error);
                });
        }

        function updateCurrentMainImageDisplay(imageUrl) {
            const currentMainImage = document.getElementById('currentMainImage');
            if (currentMainImage) {
                currentMainImage.innerHTML = `
                    <img src="${imageUrl}" alt="Ana sayfa resmi" style="width: 100%; max-width: 400px; height: 200px; object-fit: cover; border-radius: 8px; box-shadow: var(--shadow-md);">
                    <p style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Ana sayfa resmi aktif</p>
                `;
            }
        }

        function deleteCurrentImage() {
            const imageUrl = document.getElementById('imageUrl');
            if (!imageUrl || !imageUrl.textContent) return;

            // Get filename from Realtime Database first
            const mainImageRef = database.ref('site-settings/main-image');
            mainImageRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data && data.fileName) {
                        const fileName = data.fileName;
                        
                        // Delete from Storage
                        storageRef.child(fileName).delete().then(() => {
                            console.log('File deleted from storage');
                            
                            // Delete from Realtime Database
                            mainImageRef.remove()
                                .then(() => {
                                    // Reset UI
                                    const uploadedImage = document.getElementById('uploadedImage');
                                    const currentMainImage = document.getElementById('currentMainImage');
                                    
                                    uploadedImage.style.display = 'none';
                                    currentMainImage.innerHTML = '<p style="color: var(--text-secondary);">Ana sayfa resmi yüklenmedi.</p>';
                                    
                                    showAlert('Ana resim başarıyla silindi.', 'success');
                                });
                        }).catch((error) => {
                            console.error('Error deleting file:', error);
                            showAlert('Resim silinirken bir hata oluştu.', 'error');
                        });
                    }
                });
        }

        function showAlert(message, type) {
            const alert = document.getElementById('uploadAlert');
            if (alert) {
                alert.textContent = message;
                alert.className = `alert ${type}`;
                alert.style.display = 'block';
                
                setTimeout(() => {
                    alert.style.display = 'none';
                }, 5000);
            }
        }

        // ===== GENERIC ALERT FUNCTION =====
        function showGenericAlert(alertId, message, type) {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.textContent = message;
                alert.className = `alert ${type}`;
                alert.style.display = 'block';
                
                setTimeout(() => {
                    alert.style.display = 'none';
                }, 5000);
            }
        }

        // ===== İMAR DURUMLARI CRUD =====
        let editingImarId = null;

        function showAddImarForm() {
            const form = document.getElementById('imarForm');
            const title = document.getElementById('imarFormTitle');
            const input = document.getElementById('imarNameInput');
            
            if (form && title && input) {
                title.textContent = 'Yeni İmar Durumu Ekle';
                input.value = '';
                form.style.display = 'block';
                editingImarId = null;
                input.focus();
            }
        }

        function hideImarForm() {
            const form = document.getElementById('imarForm');
            if (form) {
                form.style.display = 'none';
                editingImarId = null;
            }
        }

        function saveImar() {
            const input = document.getElementById('imarNameInput');
            const name = input.value.trim();
            
            if (!name) {
                showGenericAlert('imarAlert', 'İmar durumu adı boş olamaz.', 'error');
                return;
            }

            const imarRef = database.ref('imar_durumu');
            
            if (editingImarId) {
                // Update existing
                imarRef.child(editingImarId).set({
                    name: name,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('imarAlert', 'İmar durumu başarıyla güncellendi.', 'success');
                    hideImarForm();
                    loadImarList();
                }).catch((error) => {
                    showGenericAlert('imarAlert', 'Güncelleme sırasında hata oluştu.', 'error');
                });
            } else {
                // Add new
                imarRef.push({
                    name: name,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('imarAlert', 'İmar durumu başarıyla eklendi.', 'success');
                    hideImarForm();
                    loadImarList();
                }).catch((error) => {
                    showGenericAlert('imarAlert', 'Ekleme sırasında hata oluştu.', 'error');
                });
            }
        }

        function editImar(id, name) {
            const form = document.getElementById('imarForm');
            const title = document.getElementById('imarFormTitle');
            const input = document.getElementById('imarNameInput');
            
            if (form && title && input) {
                title.textContent = 'İmar Durumu Düzenle';
                input.value = name;
                form.style.display = 'block';
                editingImarId = id;
                input.focus();
            }
        }

        function deleteImar(id, name) {
            if (confirm(`"${name}" imar durumunu silmek istediğinizden emin misiniz?`)) {
                database.ref('imar_durumu').child(id).remove()
                    .then(() => {
                        showGenericAlert('imarAlert', 'İmar durumu başarıyla silindi.', 'success');
                        loadImarList();
                    })
                    .catch((error) => {
                        showGenericAlert('imarAlert', 'Silme sırasında hata oluştu.', 'error');
                    });
            }
        }

        function loadImarList() {
            const imarList = document.getElementById('imarList');
            if (!imarList) return;

            imarList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">İmar durumları yükleniyor...</p>
                </div>
            `;

            database.ref('imar_durumu').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const item = data[key];
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                    <span style="font-weight: 500; color: var(--text-primary);">${item.name}</span>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-secondary" onclick="editImar('${key}', '${item.name}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteImar('${key}', '${item.name}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        imarList.innerHTML = html;
                    } else {
                        imarList.innerHTML = `
                            <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                <p>Henüz hiç imar durumu eklenmemiş.</p>
                            </div>
                        `;
                    }
                })
                .catch((error) => {
                    imarList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>İmar durumları yüklenirken hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // ===== TAPU DURUMLARI CRUD =====
        let editingTapuId = null;

        function showAddTapuForm() {
            const form = document.getElementById('tapuForm');
            const title = document.getElementById('tapuFormTitle');
            const input = document.getElementById('tapuNameInput');
            
            if (form && title && input) {
                title.textContent = 'Yeni Tapu Durumu Ekle';
                input.value = '';
                form.style.display = 'block';
                editingTapuId = null;
                input.focus();
            }
        }

        function hideTapuForm() {
            const form = document.getElementById('tapuForm');
            if (form) {
                form.style.display = 'none';
                editingTapuId = null;
            }
        }

        function saveTapu() {
            const input = document.getElementById('tapuNameInput');
            const name = input.value.trim();
            
            if (!name) {
                showGenericAlert('tapuAlert', 'Tapu durumu adı boş olamaz.', 'error');
                return;
            }

            const tapuRef = database.ref('tapu_durumu');
            
            if (editingTapuId) {
                // Update existing
                tapuRef.child(editingTapuId).set({
                    name: name,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('tapuAlert', 'Tapu durumu başarıyla güncellendi.', 'success');
                    hideTapuForm();
                    loadTapuList();
                }).catch((error) => {
                    showGenericAlert('tapuAlert', 'Güncelleme sırasında hata oluştu.', 'error');
                });
            } else {
                // Add new
                tapuRef.push({
                    name: name,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('tapuAlert', 'Tapu durumu başarıyla eklendi.', 'success');
                    hideTapuForm();
                    loadTapuList();
                }).catch((error) => {
                    showGenericAlert('tapuAlert', 'Ekleme sırasında hata oluştu.', 'error');
                });
            }
        }

        function editTapu(id, name) {
            const form = document.getElementById('tapuForm');
            const title = document.getElementById('tapuFormTitle');
            const input = document.getElementById('tapuNameInput');
            
            if (form && title && input) {
                title.textContent = 'Tapu Durumu Düzenle';
                input.value = name;
                form.style.display = 'block';
                editingTapuId = id;
                input.focus();
            }
        }

        function deleteTapu(id, name) {
            if (confirm(`"${name}" tapu durumunu silmek istediğinizden emin misiniz?`)) {
                database.ref('tapu_durumu').child(id).remove()
                    .then(() => {
                        showGenericAlert('tapuAlert', 'Tapu durumu başarıyla silindi.', 'success');
                        loadTapuList();
                    })
                    .catch((error) => {
                        showGenericAlert('tapuAlert', 'Silme sırasında hata oluştu.', 'error');
                    });
            }
        }

        function loadTapuList() {
            const tapuList = document.getElementById('tapuList');
            if (!tapuList) return;

            tapuList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">Tapu durumları yükleniyor...</p>
                </div>
            `;

            database.ref('tapu_durumu').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const item = data[key];
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                    <span style="font-weight: 500; color: var(--text-primary);">${item.name}</span>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-secondary" onclick="editTapu('${key}', '${item.name}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteTapu('${key}', '${item.name}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        tapuList.innerHTML = html;
                    } else {
                        tapuList.innerHTML = `
                            <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                <p>Henüz hiç tapu durumu eklenmemiş.</p>
                            </div>
                        `;
                    }
                })
                .catch((error) => {
                    tapuList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>Tapu durumları yüklenirken hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // ===== ÇEVRE KATEGORİLERİ CRUD =====
        let editingCevreKategoriId = null;

        function showAddCevreKategoriForm() {
            const form = document.getElementById('cevreKategoriForm');
            const title = document.getElementById('cevreKategoriFormTitle');
            const input = document.getElementById('cevreKategoriNameInput');
            
            if (form && title && input) {
                title.textContent = 'Yeni Çevre Kategorisi Ekle';
                input.value = '';
                form.style.display = 'block';
                editingCevreKategoriId = null;
                input.focus();
            }
        }

        function hideCevreKategoriForm() {
            const form = document.getElementById('cevreKategoriForm');
            if (form) {
                form.style.display = 'none';
                editingCevreKategoriId = null;
            }
        }

        function saveCevreKategori() {
            const input = document.getElementById('cevreKategoriNameInput');
            const name = input.value.trim();
            
            if (!name) {
                showGenericAlert('cevreKategoriAlert', 'Kategori adı boş olamaz.', 'error');
                return;
            }

            const cevreKategoriRef = database.ref('cevre_kategorisi');
            
            if (editingCevreKategoriId) {
                // Update existing
                cevreKategoriRef.child(editingCevreKategoriId).set({
                    name: name,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('cevreKategoriAlert', 'Çevre kategorisi başarıyla güncellendi.', 'success');
                    hideCevreKategoriForm();
                    loadCevreKategoriList();
                }).catch((error) => {
                    showGenericAlert('cevreKategoriAlert', 'Güncelleme sırasında hata oluştu.', 'error');
                });
            } else {
                // Add new
                cevreKategoriRef.push({
                    name: name,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('cevreKategoriAlert', 'Çevre kategorisi başarıyla eklendi.', 'success');
                    hideCevreKategoriForm();
                    loadCevreKategoriList();
                }).catch((error) => {
                    showGenericAlert('cevreKategoriAlert', 'Ekleme sırasında hata oluştu.', 'error');
                });
            }
        }

        function editCevreKategori(id, name) {
            const form = document.getElementById('cevreKategoriForm');
            const title = document.getElementById('cevreKategoriFormTitle');
            const input = document.getElementById('cevreKategoriNameInput');
            
            if (form && title && input) {
                title.textContent = 'Çevre Kategorisi Düzenle';
                input.value = name;
                form.style.display = 'block';
                editingCevreKategoriId = id;
                input.focus();
            }
        }

        function deleteCevreKategori(id, name) {
            if (confirm(`"${name}" çevre kategorisini silmek istediğinizden emin misiniz?`)) {
                database.ref('cevre_kategorisi').child(id).remove()
                    .then(() => {
                        showGenericAlert('cevreKategoriAlert', 'Çevre kategorisi başarıyla silindi.', 'success');
                        loadCevreKategoriList();
                    })
                    .catch((error) => {
                        showGenericAlert('cevreKategoriAlert', 'Silme sırasında hata oluştu.', 'error');
                    });
            }
        }

        function loadCevreKategoriList() {
            const cevreKategoriList = document.getElementById('cevreKategoriList');
            if (!cevreKategoriList) return;

            cevreKategoriList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">Çevre kategorileri yükleniyor...</p>
                </div>
            `;

            database.ref('cevre_kategorisi').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    console.log('Çevre kategorileri data:', data); // Debug için
                    
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const item = data[key];
                            console.log('Çevre kategori item:', item); // Debug için
                            
                            // Güvenli string escape
                            const safeName = (item.name || '').replace(/'/g, "\\'").replace(/"/g, '\\"');
                            
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                    <div style="flex: 1;">
                                        <span style="font-weight: 500; color: var(--text-primary);">${item.name || 'İsimsiz Kategori'}</span>
                                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            Oluşturulma: ${item.createdAt ? new Date(item.createdAt).toLocaleDateString('tr-TR') : 'Bilinmiyor'}
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-secondary" onclick="editCevreKategori('${key}', '${safeName}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteCevreKategori('${key}', '${safeName}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        cevreKategoriList.innerHTML = html;
                    } else {
                        cevreKategoriList.innerHTML = `
                            <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                <p>Henüz hiç çevre kategorisi eklenmemiş.</p>
                            </div>
                        `;
                    }
                })
                .catch((error) => {
                    console.error('Çevre kategorileri yüklenirken hata:', error);
                    cevreKategoriList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>Çevre kategorileri yüklenirken hata oluştu.</p>
                            <p style="font-size: 0.8rem; margin-top: 0.5rem;">Hata: ${error.message}</p>
                        </div>
                    `;
                });
        }

        // ===== ÇEVRELER CRUD =====
        let editingCevreId = null;

        function showAddCevreForm() {
            const form = document.getElementById('cevreForm');
            const title = document.getElementById('cevreFormTitle');
            const nameInput = document.getElementById('cevreNameInput');
            const kategoriSelect = document.getElementById('cevreKategoriSelect');
            
            if (form && title && nameInput && kategoriSelect) {
                title.textContent = 'Yeni Çevre Ekle';
                nameInput.value = '';
                kategoriSelect.value = '';
                form.style.display = 'block';
                editingCevreId = null;
                loadCevreKategorileriForSelect();
                nameInput.focus();
            }
        }

        function hideCevreForm() {
            const form = document.getElementById('cevreForm');
            if (form) {
                form.style.display = 'none';
                editingCevreId = null;
            }
        }

        function loadCevreKategorileriForSelect() {
            const select = document.getElementById('cevreKategoriSelect');
            if (!select) return;

            // Reset options
            select.innerHTML = '<option value="">Kategori Seçin</option>';

            database.ref('cevre_kategorisi').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        Object.keys(data).forEach(key => {
                            const kategori = data[key];
                            const option = document.createElement('option');
                            option.value = key;
                            option.textContent = kategori.name;
                            select.appendChild(option);
                        });
                    }
                })
                .catch((error) => {
                    console.error('Çevre kategorileri yüklenirken hata:', error);
                });
        }

        function saveCevre() {
            const nameInput = document.getElementById('cevreNameInput');
            const kategoriSelect = document.getElementById('cevreKategoriSelect');
            const name = nameInput.value.trim();
            const kategoriId = kategoriSelect.value;
            
            if (!name) {
                showGenericAlert('cevreAlert', 'Çevre adı boş olamaz.', 'error');
                return;
            }

            if (!kategoriId) {
                showGenericAlert('cevreAlert', 'Lütfen bir kategori seçin.', 'error');
                return;
            }

            // Get kategori name for storage
            const kategoriText = kategoriSelect.options[kategoriSelect.selectedIndex].text;

            const cevreRef = database.ref('cevreler');
            
            if (editingCevreId) {
                // Update existing
                cevreRef.child(editingCevreId).set({
                    name: name,
                    kategoriId: kategoriId,
                    kategoriName: kategoriText,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('cevreAlert', 'Çevre başarıyla güncellendi.', 'success');
                    hideCevreForm();
                    loadCevreList();
                }).catch((error) => {
                    showGenericAlert('cevreAlert', 'Güncelleme sırasında hata oluştu.', 'error');
                });
            } else {
                // Add new
                cevreRef.push({
                    name: name,
                    kategoriId: kategoriId,
                    kategoriName: kategoriText,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('cevreAlert', 'Çevre başarıyla eklendi.', 'success');
                    hideCevreForm();
                    loadCevreList();
                }).catch((error) => {
                    showGenericAlert('cevreAlert', 'Ekleme sırasında hata oluştu.', 'error');
                });
            }
        }

        function editCevre(id, name, kategoriId) {
            const form = document.getElementById('cevreForm');
            const title = document.getElementById('cevreFormTitle');
            const nameInput = document.getElementById('cevreNameInput');
            const kategoriSelect = document.getElementById('cevreKategoriSelect');
            
            if (form && title && nameInput && kategoriSelect) {
                title.textContent = 'Çevre Düzenle';
                nameInput.value = name;
                form.style.display = 'block';
                editingCevreId = id;
                
                // Load categories and set selection
                loadCevreKategorileriForSelect();
                setTimeout(() => {
                    kategoriSelect.value = kategoriId;
                }, 500);
                
                nameInput.focus();
            }
        }

        function deleteCevre(id, name) {
            if (confirm(`"${name}" çevresini silmek istediğinizden emin misiniz?`)) {
                database.ref('cevreler').child(id).remove()
                    .then(() => {
                        showGenericAlert('cevreAlert', 'Çevre başarıyla silindi.', 'success');
                        loadCevreList();
                    })
                    .catch((error) => {
                        showGenericAlert('cevreAlert', 'Silme sırasında hata oluştu.', 'error');
                    });
            }
        }

        function loadCevreList() {
            const cevreList = document.getElementById('cevreList');
            if (!cevreList) return;

            cevreList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">Çevreler yükleniyor...</p>
                </div>
            `;

            database.ref('cevreler').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const item = data[key];
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                    <div>
                                        <span style="font-weight: 500; color: var(--text-primary);">${item.name}</span>
                                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            <span style="background: var(--primary-color); color: white; padding: 0.125rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">${item.kategoriName || 'Kategori'}</span>
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-secondary" onclick="editCevre('${key}', '${item.name}', '${item.kategoriId || ''}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteCevre('${key}', '${item.name}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        cevreList.innerHTML = html;
                    } else {
                        cevreList.innerHTML = `
                            <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                <p>Henüz hiç çevre eklenmemiş.</p>
                            </div>
                        `;
                    }
                })
                .catch((error) => {
                    cevreList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>Çevreler yüklenirken hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // ===== GABARİ CRUD =====
        let editingGabariId = null;

        function showAddGabariForm() {
            const form = document.getElementById('gabariForm');
            const title = document.getElementById('gabariFormTitle');
            const input = document.getElementById('gabariValueInput');
            
            if (form && title && input) {
                title.textContent = 'Yeni Gabari Değeri Ekle';
                input.value = '';
                form.style.display = 'block';
                editingGabariId = null;
                input.focus();
            }
        }

        function hideGabariForm() {
            const form = document.getElementById('gabariForm');
            if (form) {
                form.style.display = 'none';
                editingGabariId = null;
            }
        }

        function saveGabari() {
            const input = document.getElementById('gabariValueInput');
            const value = input.value.trim();
            
            if (!value) {
                showGenericAlert('gabariAlert', 'Gabari değeri boş olamaz.', 'error');
                return;
            }

            // Validate numeric value
            if (isNaN(parseFloat(value))) {
                showGenericAlert('gabariAlert', 'Lütfen geçerli bir sayı girin.', 'error');
                return;
            }

            const gabariRef = database.ref('gabari');
            
            if (editingGabariId) {
                // Update existing
                gabariRef.child(editingGabariId).set({
                    value: value,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('gabariAlert', 'Gabari değeri başarıyla güncellendi.', 'success');
                    hideGabariForm();
                    loadGabariList();
                }).catch((error) => {
                    showGenericAlert('gabariAlert', 'Güncelleme sırasında hata oluştu.', 'error');
                });
            } else {
                // Add new
                gabariRef.push({
                    value: value,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('gabariAlert', 'Gabari değeri başarıyla eklendi.', 'success');
                    hideGabariForm();
                    loadGabariList();
                }).catch((error) => {
                    showGenericAlert('gabariAlert', 'Ekleme sırasında hata oluştu.', 'error');
                });
            }
        }

        function editGabari(id, value) {
            const form = document.getElementById('gabariForm');
            const title = document.getElementById('gabariFormTitle');
            const input = document.getElementById('gabariValueInput');
            
            if (form && title && input) {
                title.textContent = 'Gabari Değeri Düzenle';
                input.value = value;
                form.style.display = 'block';
                editingGabariId = id;
                input.focus();
            }
        }

        function deleteGabari(id, value) {
            if (confirm(`"${value}" gabari değerini silmek istediğinizden emin misiniz?`)) {
                database.ref('gabari').child(id).remove()
                    .then(() => {
                        showGenericAlert('gabariAlert', 'Gabari değeri başarıyla silindi.', 'success');
                        loadGabariList();
                    })
                    .catch((error) => {
                        showGenericAlert('gabariAlert', 'Silme sırasında hata oluştu.', 'error');
                    });
            }
        }

        function loadGabariList() {
            const gabariList = document.getElementById('gabariList');
            if (!gabariList) return;

            gabariList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">Gabari değerleri yükleniyor...</p>
                </div>
            `;

            database.ref('gabari').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const item = data[key];
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                    <span style="font-weight: 500; color: var(--text-primary);">${item.value}</span>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-secondary" onclick="editGabari('${key}', '${item.value}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteGabari('${key}', '${item.value}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        gabariList.innerHTML = html;
                    } else {
                        gabariList.innerHTML = `
                            <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                <p>Henüz hiç gabari değeri eklenmemiş.</p>
                            </div>
                        `;
                    }
                })
                .catch((error) => {
                    gabariList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>Gabari değerleri yüklenirken hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // ===== KAKS CRUD =====
        let editingKaksId = null;

        function showAddKaksForm() {
            const form = document.getElementById('kaksForm');
            const title = document.getElementById('kaksFormTitle');
            const input = document.getElementById('kaksValueInput');
            
            if (form && title && input) {
                title.textContent = 'Yeni KAKS Değeri Ekle';
                input.value = '';
                form.style.display = 'block';
                editingKaksId = null;
                input.focus();
            }
        }

        function hideKaksForm() {
            const form = document.getElementById('kaksForm');
            if (form) {
                form.style.display = 'none';
                editingKaksId = null;
            }
        }

        function saveKaks() {
            const input = document.getElementById('kaksValueInput');
            const value = input.value.trim();
            
            if (!value) {
                showGenericAlert('kaksAlert', 'KAKS değeri boş olamaz.', 'error');
                return;
            }

            // Validate numeric value
            if (isNaN(parseFloat(value))) {
                showGenericAlert('kaksAlert', 'Lütfen geçerli bir sayı girin.', 'error');
                return;
            }

            const kaksRef = database.ref('kaks');
            
            if (editingKaksId) {
                // Update existing
                kaksRef.child(editingKaksId).set({
                    value: value,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('kaksAlert', 'KAKS değeri başarıyla güncellendi.', 'success');
                    hideKaksForm();
                    loadKaksList();
                }).catch((error) => {
                    showGenericAlert('kaksAlert', 'Güncelleme sırasında hata oluştu.', 'error');
                });
            } else {
                // Add new
                kaksRef.push({
                    value: value,
                    createdAt: firebase.database.ServerValue.TIMESTAMP
                }).then(() => {
                    showGenericAlert('kaksAlert', 'KAKS değeri başarıyla eklendi.', 'success');
                    hideKaksForm();
                    loadKaksList();
                }).catch((error) => {
                    showGenericAlert('kaksAlert', 'Ekleme sırasında hata oluştu.', 'error');
                });
            }
        }

        function editKaks(id, value) {
            const form = document.getElementById('kaksForm');
            const title = document.getElementById('kaksFormTitle');
            const input = document.getElementById('kaksValueInput');
            
            if (form && title && input) {
                title.textContent = 'KAKS Değeri Düzenle';
                input.value = value;
                form.style.display = 'block';
                editingKaksId = id;
                input.focus();
            }
        }

        function deleteKaks(id, value) {
            if (confirm(`"${value}" KAKS değerini silmek istediğinizden emin misiniz?`)) {
                database.ref('kaks').child(id).remove()
                    .then(() => {
                        showGenericAlert('kaksAlert', 'KAKS değeri başarıyla silindi.', 'success');
                        loadKaksList();
                    })
                    .catch((error) => {
                        showGenericAlert('kaksAlert', 'Silme sırasında hata oluştu.', 'error');
                    });
            }
        }

        function loadKaksList() {
            const kaksList = document.getElementById('kaksList');
            if (!kaksList) return;

            kaksList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">KAKS değerleri yükleniyor...</p>
                </div>
            `;

            database.ref('kaks').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const item = data[key];
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 6px; border: 1px solid var(--border-color);">
                                    <span style="font-weight: 500; color: var(--text-primary);">${item.value}</span>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn btn-secondary" onclick="editKaks('${key}', '${item.value}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteKaks('${key}', '${item.value}')" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        kaksList.innerHTML = html;
                    } else {
                        kaksList.innerHTML = `
                            <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                                <p>Henüz hiç KAKS değeri eklenmemiş.</p>
                            </div>
                        `;
                    }
                })
                .catch((error) => {
                    kaksList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>KAKS değerleri yüklenirken hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // ===== İLAN FORM FUNCTIONS =====
        function showAddIlanForm() {
            const form = document.getElementById('ilanForm');
            if (form) {
                form.style.display = 'block';
                loadKaksForSelect();
                loadGabariForSelect();
                loadTapuDurumuForSelect();
                loadImarDurumuForSelect();
            }
        }

        function hideIlanForm() {
            const form = document.getElementById('ilanForm');
            if (form) {
                form.style.display = 'none';
                document.getElementById('ilanFormContent').reset();
                document.getElementById('ilanToplamFiyat').value = '';
                
                // Düzenleme modundan çık
                if (window.editingIlanId) {
                    window.editingIlanId = null;
                    
                    // Form başlığını sıfırla
                    document.getElementById('ilanFormTitle').textContent = 'Yeni İlan Ekle';
                    
                    // Save butonunu sıfırla
                    const saveBtn = document.querySelector('#ilanFormContent button[onclick="updateIlan()"]');
                    if (saveBtn) {
                        saveBtn.innerHTML = `
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                            İlanı Kaydet
                        `;
                        saveBtn.onclick = saveIlan;
                    }
                    
                    // Fotoğrafları temizle
                    uploadedPhotos = [];
                    const photosContainer = document.getElementById('photosContainer');
                    if (photosContainer) photosContainer.style.display = 'none';
                    
                    // Özellikleri temizle
                    selectedFeatures.clear();
                    const allToggles = document.querySelectorAll('.feature-toggle');
                    allToggles.forEach(toggle => {
                        toggle.classList.remove('active');
                    });
                    updateFeaturesSummary();
                    
                    // Çevreleri temizle
                    selectedCevreler.clear();
                    updateCevrelerSummary();
                    
                    // Editor'ü temizle
                    const editor = document.getElementById('ilanAciklama');
                    if (editor) {
                        editor.innerHTML = '';
                        updateEditorStats();
                    }
                    
                    // Harita konumunu temizle
                    clearMapLocation();
                }
            }
        }

        // Fiyat hesaplama
        function calculateTotalPrice() {
            const metrekare = parseFloat(document.getElementById('ilanMetrekare').value) || 0;
            const metrekareFiyat = parseFloat(document.getElementById('ilanMetrekareFiyat').value) || 0;
            const toplamFiyat = metrekare * metrekareFiyat;
            
            const toplamFiyatInput = document.getElementById('ilanToplamFiyat');
            if (toplamFiyat > 0) {
                toplamFiyatInput.value = new Intl.NumberFormat('tr-TR', {
                    style: 'currency',
                    currency: 'TRY',
                    minimumFractionDigits: 0
                }).format(toplamFiyat);
            } else {
                toplamFiyatInput.value = '';
            }
        }

        // Selectbox loaders
        function loadKaksForSelect() {
            const select = document.getElementById('ilanKaks');
            if (!select) return;
            select.innerHTML = '<option value="">KAKS Seçin</option>';
            database.ref('kaks').once('value').then((snapshot) => {
                const data = snapshot.val();
                if (data) {
                    Object.keys(data).forEach(key => {
                        const option = document.createElement('option');
                        option.value = key;
                        option.textContent = data[key].value;
                        select.appendChild(option);
                    });
                }
            });
        }

        function loadGabariForSelect() {
            const select = document.getElementById('ilanGabari');
            if (!select) return;
            select.innerHTML = '<option value="">Gabari Seçin</option>';
            database.ref('gabari').once('value').then((snapshot) => {
                const data = snapshot.val();
                if (data) {
                    Object.keys(data).forEach(key => {
                        const option = document.createElement('option');
                        option.value = key;
                        option.textContent = data[key].value;
                        select.appendChild(option);
                    });
                }
            });
        }

        function loadTapuDurumuForSelect() {
            const select = document.getElementById('ilanTapuDurumu');
            if (!select) return;
            select.innerHTML = '<option value="">Tapu Durumu Seçin</option>';
            database.ref('tapu_durumu').once('value').then((snapshot) => {
                const data = snapshot.val();
                if (data) {
                    Object.keys(data).forEach(key => {
                        const option = document.createElement('option');
                        option.value = key;
                        option.textContent = data[key].name;
                        select.appendChild(option);
                    });
                }
            });
        }

        function loadImarDurumuForSelect() {
            const select = document.getElementById('ilanImarDurumu');
            if (!select) return;
            select.innerHTML = '<option value="">İmar Durumu Seçin</option>';
            database.ref('imar_durumu').once('value').then((snapshot) => {
                const data = snapshot.val();
                if (data) {
                    Object.keys(data).forEach(key => {
                        const option = document.createElement('option');
                        option.value = key;
                        option.textContent = data[key].name;
                        select.appendChild(option);
                    });
                }
            });
        }

        // Şehir İlçe Mahalle
        const sehirIlceData = {
            istanbul: {
                name: 'İstanbul',
                ilceler: {
                    besiktas: { name: 'Beşiktaş', mahalleler: ['Levent', 'Etiler', 'Bebek', 'Ortaköy'] },
                    sisli: { name: 'Şişli', mahalleler: ['Mecidiyeköy', 'Gayrettepe', 'Fülya'] },
                    kadikoy: { name: 'Kadıköy', mahalleler: ['Moda', 'Caferağa', 'Hasanpaşa'] }
                }
            },
            ankara: {
                name: 'Ankara',
                ilceler: {
                    cankaya: { name: 'Çankaya', mahalleler: ['Kızılay', 'Bahçelievler', 'GOP'] },
                    kecioren: { name: 'Keçiören', mahalleler: ['Etlik', 'Kuşcağız', 'Ovacık'] }
                }
            }
        };

        function loadIlceler() {
            const sehirSelect = document.getElementById('ilanSehir');
            const ilceSelect = document.getElementById('ilanIlce');
            const mahalleSelect = document.getElementById('ilanMahalle');
            const selectedSehir = sehirSelect.value;
            
            ilceSelect.innerHTML = '<option value="">İlçe Seçin</option>';
            mahalleSelect.innerHTML = '<option value="">Mahalle Seçin</option>';
            mahalleSelect.disabled = true;
            
            if (selectedSehir && sehirIlceData[selectedSehir]) {
                ilceSelect.disabled = false;
                const ilceler = sehirIlceData[selectedSehir].ilceler;
                Object.keys(ilceler).forEach(ilceKey => {
                    const option = document.createElement('option');
                    option.value = ilceKey;
                    option.textContent = ilceler[ilceKey].name;
                    ilceSelect.appendChild(option);
                });
            } else {
                ilceSelect.disabled = true;
            }
        }

        function loadMahalleler() {
            const sehirSelect = document.getElementById('ilanSehir');
            const ilceSelect = document.getElementById('ilanIlce');
            const mahalleSelect = document.getElementById('ilanMahalle');
            const selectedSehir = sehirSelect.value;
            const selectedIlce = ilceSelect.value;
            
            mahalleSelect.innerHTML = '<option value="">Mahalle Seçin</option>';
            
            if (selectedSehir && selectedIlce && sehirIlceData[selectedSehir]?.ilceler[selectedIlce]) {
                mahalleSelect.disabled = false;
                const mahalleler = sehirIlceData[selectedSehir].ilceler[selectedIlce].mahalleler;
                mahalleler.forEach(mahalle => {
                    const option = document.createElement('option');
                    option.value = mahalle.toLowerCase().replace(/\s+/g, '-');
                    option.textContent = mahalle;
                    mahalleSelect.appendChild(option);
                });
            } else {
                mahalleSelect.disabled = true;
            }
        }

        // İlan kaydetme
        function saveIlan() {
            const requiredFields = [
                { id: 'ilanBaslik', name: 'Başlık' },
                { id: 'ilanNo', name: 'İlan No' },
                { id: 'ilanMetrekare', name: 'Metrekare' },
                { id: 'ilanMetrekareFiyat', name: 'Metrekare Fiyat' },
                { id: 'ilanAdaNo', name: 'Ada No' },
                { id: 'ilanParselNo', name: 'Parsel No' },
                { id: 'ilanKaks', name: 'KAKS' },
                { id: 'ilanGabari', name: 'Gabari' },
                { id: 'ilanTapuDurumu', name: 'Tapu Durumu' },
                { id: 'ilanImarDurumu', name: 'İmar Durumu' },
                { id: 'ilanSehir', name: 'Şehir' },
                { id: 'ilanIlce', name: 'İlçe' },
                { id: 'ilanMahalle', name: 'Mahalle' },
                { id: 'ilanLats', name: 'Enlem (Latitude)' },
                { id: 'ilanLangs', name: 'Boylam (Longitude)' }
            ];
            
            for (const field of requiredFields) {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    showGenericAlert('ilanAlert', `${field.name} alanı boş olamaz.`, 'error');
                    element.focus();
                    return;
                }
            }
            
            const ilanData = {
                baslik: document.getElementById('ilanBaslik').value.trim(),
                ilanNo: document.getElementById('ilanNo').value.trim(),
                proje: document.getElementById('ilanProje').value,
                metrekare: parseFloat(document.getElementById('ilanMetrekare').value),
                metrekareFiyat: parseFloat(document.getElementById('ilanMetrekareFiyat').value),
                toplamFiyat: parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value),
                adaNo: document.getElementById('ilanAdaNo').value.trim(),
                parselNo: document.getElementById('ilanParselNo').value.trim(),
                kaksId: document.getElementById('ilanKaks').value,
                gabariId: document.getElementById('ilanGabari').value,
                tapuDurumuId: document.getElementById('ilanTapuDurumu').value,
                imarDurumuId: document.getElementById('ilanImarDurumu').value,
                sehir: document.getElementById('ilanSehir').value,
                ilce: document.getElementById('ilanIlce').value,
                mahalle: document.getElementById('ilanMahalle').value,
                latitude: parseFloat(document.getElementById('ilanLats').value),
                longitude: parseFloat(document.getElementById('ilanLangs').value),
                location: {
                    lat: parseFloat(document.getElementById('ilanLats').value),
                    lng: parseFloat(document.getElementById('ilanLangs').value)
                },
                // Fiyat artış tahminleri
                priceProjections: {
                    year1: {
                        increaseRate: parseFloat(document.getElementById('ilan1SeneArtis').value) || 0,
                        projectedPrice: calculateProjectedPrice(parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value), parseFloat(document.getElementById('ilan1SeneArtis').value) || 0)
                    },
                    year2: {
                        increaseRate: parseFloat(document.getElementById('ilan2SeneArtis').value) || 0,
                        projectedPrice: calculateProjectedPrice(parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value), parseFloat(document.getElementById('ilan1SeneArtis').value) || 0, parseFloat(document.getElementById('ilan2SeneArtis').value) || 0)
                    },
                    year3: {
                        increaseRate: parseFloat(document.getElementById('ilan3SeneArtis').value) || 0,
                        projectedPrice: calculateProjectedPrice(parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value), parseFloat(document.getElementById('ilan1SeneArtis').value) || 0, parseFloat(document.getElementById('ilan2SeneArtis').value) || 0, parseFloat(document.getElementById('ilan3SeneArtis').value) || 0)
                    }
                },
                // Fotoğraflar
                photos: uploadedPhotos.map((photo, index) => ({
                    id: photo.id,
                    fileName: photo.fileName,
                    url: photo.url,
                    name: photo.name,
                    size: photo.size,
                    order: index + 1,
                    isPrimary: index === 0, // İlk fotoğraf ana fotoğraf
                    uploadedAt: photo.uploadedAt
                })),
                // İlan Özellikleri - Kategorilere göre ayrı
                altyapi_ozellikleri: getAltyapiFeatures(),
                konum_ozellikleri: getKonumFeatures(),
                genel_ozellikler: getGenelFeatures(),
                // İlan Çevreleri
                cevreler: getSelectedCevreler(),
                // İlan Açıklaması
                aciklama: getEditorContent(),
                createdAt: firebase.database.ServerValue.TIMESTAMP,
                status: 'aktif'
            };
            
            database.ref('ilanlar').push(ilanData)
                .then(() => {
                    showGenericAlert('ilanAlert', 'İlan başarıyla eklendi!', 'success');
                    hideIlanForm();
                    loadIlanList();
                })
                .catch((error) => {
                    console.error('İlan kaydetme hatası:', error);
                    showGenericAlert('ilanAlert', 'İlan kaydedilirken hata oluştu.', 'error');
                });
        }

        // İlan listeleme (basic)
        function loadIlanList() {
            const ilanList = document.getElementById('ilanList');
            if (!ilanList) return;

            ilanList.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">İlanlar yükleniyor...</p>
                </div>
            `;

            database.ref('ilanlar').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    console.log('İlanlar data:', data); // Debug için
                    
                    if (data) {
                        let html = '';
                        Object.keys(data).forEach(key => {
                            const ilan = data[key];
                            console.log('İlan verisi:', ilan); // Debug için
                            
                            const tarih = ilan.createdAt ? new Date(ilan.createdAt).toLocaleDateString('tr-TR') : 'Bilinmiyor';
                            const fiyat = ilan.toplamFiyat ? new Intl.NumberFormat('tr-TR', {
                                style: 'currency',
                                currency: 'TRY',
                                minimumFractionDigits: 0
                            }).format(ilan.toplamFiyat) : 'Fiyat Yok';
                            
                            // Güvenli string escape
                            const safeBaslik = (ilan.baslik || 'Başlık Yok').replace(/'/g, "\\'").replace(/"/g, '\\"');
                            
                            html += `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 0.5rem; background: var(--main-bg); border-radius: 8px; border: 1px solid var(--border-color); transition: all 0.2s ease; box-shadow: var(--shadow-sm);">
                                    <div style="flex: 1;">
                                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                                            <h4 style="margin: 0; color: var(--text-primary); font-size: 1rem;">${ilan.baslik || 'Başlık Yok'}</h4>
                                            <span style="background: var(--primary-color); color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 500;">${ilan.ilanNo || 'No Yok'}</span>
                                        </div>
                                        <div style="display: flex; gap: 1rem; font-size: 0.85rem; color: var(--text-secondary); flex-wrap: wrap;">
                                            <span>📍 ${ilan.sehir || ''}, ${ilan.ilce || ''}, ${ilan.mahalle || ''}</span>
                                            <span>📏 ${ilan.metrekare || 0} m²</span>
                                            <span>💰 ${fiyat}</span>
                                            <span>📅 ${tarih}</span>
                                        </div>
                                        <div style="margin-top: 0.5rem;">
                                            <span style="background: var(--success-color); color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: 500;">
                                                ${ilan.status === 'aktif' ? 'Aktif' : ilan.status || 'Aktif'}
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; margin-left: 1rem; flex-shrink: 0;">
                                        <button class="btn btn-secondary" onclick="editIlan('${key}')" style="padding: 0.5rem 1rem; font-size: 0.85rem; white-space: nowrap;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20" style="margin-right: 0.25rem;">
                                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                            </svg>
                                            Düzenle
                                        </button>
                                        <button class="btn-delete" onclick="deleteIlan('${key}', '${safeBaslik}')" style="padding: 0.5rem 1rem; font-size: 0.85rem; white-space: nowrap;">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20" style="margin-right: 0.25rem;">
                                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                                            </svg>
                                            Sil
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        ilanList.innerHTML = html;
                        console.log('İlan listesi yüklendi. Toplam:', Object.keys(data).length, 'ilan');
                    } else {
                        ilanList.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: 2rem;"><p>Henüz hiç ilan eklenmemiş.</p></div>';
                        console.log('İlan verisi bulunamadı');
                    }
                })
                .catch((error) => {
                    console.error('İlanlar yüklenirken hata:', error);
                    ilanList.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>İlanlar yüklenirken hata oluştu.</p>
                            <p style="font-size: 0.8rem; margin-top: 0.5rem;">Hata: ${error.message}</p>
                        </div>
                    `;
                });
        }

        // İlan düzenleme fonksiyonu
        function editIlan(ilanId) {
            // İlan verisini Firebase'den al
            database.ref(`ilanlar/${ilanId}`).once('value')
                .then((snapshot) => {
                    const ilan = snapshot.val();
                    if (!ilan) {
                        showGenericAlert('ilanAlert', 'İlan bulunamadı!', 'error');
                        return;
                    }

                    // Form başlığını güncelle
                    document.getElementById('ilanFormTitle').textContent = 'İlan Düzenle';
                    
                    // Form alanlarını doldur
                    document.getElementById('ilanBaslik').value = ilan.baslik || '';
                    document.getElementById('ilanNo').value = ilan.ilanNo || '';
                    document.getElementById('ilanProje').value = ilan.proje || '';
                    document.getElementById('ilanMetrekare').value = ilan.metrekare || '';
                    document.getElementById('ilanMetrekareFiyat').value = ilan.metrekareFiyat || '';
                    document.getElementById('ilanAdaNo').value = ilan.adaNo || '';
                    document.getElementById('ilanParselNo').value = ilan.parselNo || '';
                    document.getElementById('ilanSehir').value = ilan.sehir || '';
                    document.getElementById('ilanLats').value = ilan.latitude || ilan.location?.lat || '';
                    document.getElementById('ilanLangs').value = ilan.longitude || ilan.location?.lng || '';
                    
                    // Fiyat artış oranlarını doldur
                    if (ilan.priceProjections) {
                        document.getElementById('ilan1SeneArtis').value = ilan.priceProjections.year1?.increaseRate || '';
                        document.getElementById('ilan2SeneArtis').value = ilan.priceProjections.year2?.increaseRate || '';
                        document.getElementById('ilan3SeneArtis').value = ilan.priceProjections.year3?.increaseRate || '';
                    }
                    
                    // İlan açıklamasını doldur
                    const editor = document.getElementById('ilanAciklama');
                    if (editor && ilan.aciklama) {
                        editor.innerHTML = ilan.aciklama;
                        updateEditorStats();
                    }
                    
                    // Fotoğrafları yükle
                    if (ilan.photos && Array.isArray(ilan.photos)) {
                        uploadedPhotos = ilan.photos.map(photo => ({
                            id: photo.id || generatePhotoId(),
                            fileName: photo.fileName,
                            url: photo.url,
                            name: photo.name,
                            size: photo.size,
                            order: photo.order,
                            isPrimary: photo.isPrimary,
                            uploadedAt: photo.uploadedAt
                        }));
                        showPhotosContainer();
                        refreshPhotosGrid();
                        updatePhotosCount();
                    }
                    
                    // Özellikleri işaretle
                    selectedFeatures.clear();
                    if (ilan.altyapi_ozellikleri) {
                        Object.keys(ilan.altyapi_ozellikleri).forEach(key => {
                            if (ilan.altyapi_ozellikleri[key]) {
                                selectedFeatures.add(key);
                                const toggle = document.querySelector(`[data-feature="${key}"]`);
                                if (toggle) toggle.classList.add('active');
                            }
                        });
                    }
                    if (ilan.konum_ozellikleri) {
                        Object.keys(ilan.konum_ozellikleri).forEach(key => {
                            if (ilan.konum_ozellikleri[key]) {
                                selectedFeatures.add(key);
                                const toggle = document.querySelector(`[data-feature="${key}"]`);
                                if (toggle) toggle.classList.add('active');
                            }
                        });
                    }
                    if (ilan.genel_ozellikler) {
                        Object.keys(ilan.genel_ozellikler).forEach(key => {
                            if (ilan.genel_ozellikler[key]) {
                                selectedFeatures.add(key);
                                const toggle = document.querySelector(`[data-feature="${key}"]`);
                                if (toggle) toggle.classList.add('active');
                            }
                        });
                    }
                    updateFeaturesSummary();
                    
                    // Çevreleri işaretle
                    selectedCevreler.clear();
                    if (ilan.cevreler) {
                        Object.keys(ilan.cevreler).forEach(cevreId => {
                            const cevre = ilan.cevreler[cevreId];
                            if (cevre.active) {
                                selectedCevreler.set(cevreId, {
                                    active: true,
                                    distance: cevre.distance || 0
                                });
                            }
                        });
                    }
                    
                    // Selectbox'ları yükle ve değerleri ayarla
                    loadKaksForSelect();
                    loadGabariForSelect();
                    loadTapuDurumuForSelect();
                    loadImarDurumuForSelect();
                    
                    setTimeout(() => {
                        document.getElementById('ilanKaks').value = ilan.kaksId || '';
                        document.getElementById('ilanGabari').value = ilan.gabariId || '';
                        document.getElementById('ilanTapuDurumu').value = ilan.tapuDurumuId || '';
                        document.getElementById('ilanImarDurumu').value = ilan.imarDurumuId || '';
                        
                        // İlçe ve mahalle yükle
                        if (ilan.sehir) {
                            loadIlceler();
                            setTimeout(() => {
                                document.getElementById('ilanIlce').value = ilan.ilce || '';
                                loadMahalleler();
                                setTimeout(() => {
                                    document.getElementById('ilanMahalle').value = ilan.mahalle || '';
                                }, 100);
                            }, 100);
                        }
                        
                        // Haritayı başlat ve konumu göster
                        initializeIlanMap();
                        setTimeout(() => {
                            if (ilan.latitude && ilan.longitude) {
                                setMapLocation(ilan.latitude, ilan.longitude);
                            }
                        }, 1000);
                        
                        // Çevreleri yükle
                        loadCevreler();
                        setTimeout(() => {
                            selectedCevreler.forEach((data, cevreId) => {
                                const toggle = document.querySelector(`[data-cevre-id="${cevreId}"]`);
                                if (toggle) {
                                    toggle.classList.add('active');
                                    const distanceInput = document.getElementById(`cevre-distance-${cevreId}`);
                                    if (distanceInput) {
                                        distanceInput.style.display = 'inline-block';
                                        distanceInput.value = data.distance;
                                    }
                                }
                            });
                            updateCevrelerSummary();
                        }, 1000);
                        
                        // Fiyat hesaplamalarını yap
                        calculateTotalPrice();
                        calculateFuturePrices();
                    }, 500);
                    
                    // Formu göster
                    document.getElementById('ilanForm').style.display = 'block';
                    
                    // Düzenleme modunu aktif et
                    window.editingIlanId = ilanId;
                    
                    // Save butonunu güncelle
                    const saveBtn = document.querySelector('#ilanFormContent button[onclick="saveIlan()"]');
                    if (saveBtn) {
                        saveBtn.innerHTML = `
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                            İlanı Güncelle
                        `;
                        saveBtn.onclick = () => updateIlan(ilanId);
                    }
                })
                .catch((error) => {
                    console.error('İlan yüklenirken hata:', error);
                    showGenericAlert('ilanAlert', 'İlan yüklenirken hata oluştu!', 'error');
                });
        }

        // İlan güncelleme fonksiyonu
        function updateIlan(ilanId) {
            const requiredFields = [
                { id: 'ilanBaslik', name: 'Başlık' },
                { id: 'ilanNo', name: 'İlan No' },
                { id: 'ilanMetrekare', name: 'Metrekare' },
                { id: 'ilanMetrekareFiyat', name: 'Metrekare Fiyat' },
                { id: 'ilanAdaNo', name: 'Ada No' },
                { id: 'ilanParselNo', name: 'Parsel No' },
                { id: 'ilanKaks', name: 'KAKS' },
                { id: 'ilanGabari', name: 'Gabari' },
                { id: 'ilanTapuDurumu', name: 'Tapu Durumu' },
                { id: 'ilanImarDurumu', name: 'İmar Durumu' },
                { id: 'ilanSehir', name: 'Şehir' },
                { id: 'ilanIlce', name: 'İlçe' },
                { id: 'ilanMahalle', name: 'Mahalle' },
                { id: 'ilanLats', name: 'Enlem (Latitude)' },
                { id: 'ilanLangs', name: 'Boylam (Longitude)' }
            ];
            
            for (const field of requiredFields) {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    showGenericAlert('ilanAlert', `${field.name} alanı boş olamaz.`, 'error');
                    element.focus();
                    return;
                }
            }
            
            const ilanData = {
                baslik: document.getElementById('ilanBaslik').value.trim(),
                ilanNo: document.getElementById('ilanNo').value.trim(),
                proje: document.getElementById('ilanProje').value,
                metrekare: parseFloat(document.getElementById('ilanMetrekare').value),
                metrekareFiyat: parseFloat(document.getElementById('ilanMetrekareFiyat').value),
                toplamFiyat: parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value),
                adaNo: document.getElementById('ilanAdaNo').value.trim(),
                parselNo: document.getElementById('ilanParselNo').value.trim(),
                kaksId: document.getElementById('ilanKaks').value,
                gabariId: document.getElementById('ilanGabari').value,
                tapuDurumuId: document.getElementById('ilanTapuDurumu').value,
                imarDurumuId: document.getElementById('ilanImarDurumu').value,
                sehir: document.getElementById('ilanSehir').value,
                ilce: document.getElementById('ilanIlce').value,
                mahalle: document.getElementById('ilanMahalle').value,
                latitude: parseFloat(document.getElementById('ilanLats').value),
                longitude: parseFloat(document.getElementById('ilanLangs').value),
                location: {
                    lat: parseFloat(document.getElementById('ilanLats').value),
                    lng: parseFloat(document.getElementById('ilanLangs').value)
                },
                // Fiyat artış tahminleri
                priceProjections: {
                    year1: {
                        increaseRate: parseFloat(document.getElementById('ilan1SeneArtis').value) || 0,
                        projectedPrice: calculateProjectedPrice(parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value), parseFloat(document.getElementById('ilan1SeneArtis').value) || 0)
                    },
                    year2: {
                        increaseRate: parseFloat(document.getElementById('ilan2SeneArtis').value) || 0,
                        projectedPrice: calculateProjectedPrice(parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value), parseFloat(document.getElementById('ilan1SeneArtis').value) || 0, parseFloat(document.getElementById('ilan2SeneArtis').value) || 0)
                    },
                    year3: {
                        increaseRate: parseFloat(document.getElementById('ilan3SeneArtis').value) || 0,
                        projectedPrice: calculateProjectedPrice(parseFloat(document.getElementById('ilanMetrekare').value) * parseFloat(document.getElementById('ilanMetrekareFiyat').value), parseFloat(document.getElementById('ilan1SeneArtis').value) || 0, parseFloat(document.getElementById('ilan2SeneArtis').value) || 0, parseFloat(document.getElementById('ilan3SeneArtis').value) || 0)
                    }
                },
                // Fotoğraflar
                photos: uploadedPhotos.map((photo, index) => ({
                    id: photo.id,
                    fileName: photo.fileName,
                    url: photo.url,
                    name: photo.name,
                    size: photo.size,
                    order: index + 1,
                    isPrimary: index === 0,
                    uploadedAt: photo.uploadedAt
                })),
                // İlan Özellikleri
                altyapi_ozellikleri: getAltyapiFeatures(),
                konum_ozellikleri: getKonumFeatures(),
                genel_ozellikler: getGenelFeatures(),
                // İlan Çevreleri
                cevreler: getSelectedCevreler(),
                // İlan Açıklaması
                aciklama: getEditorContent(),
                updatedAt: firebase.database.ServerValue.TIMESTAMP,
                status: 'aktif'
            };
            
            database.ref(`ilanlar/${ilanId}`).update(ilanData)
                .then(() => {
                    showGenericAlert('ilanAlert', 'İlan başarıyla güncellendi!', 'success');
                    hideIlanForm();
                    loadIlanList();
                    window.editingIlanId = null;
                })
                .catch((error) => {
                    console.error('İlan güncelleme hatası:', error);
                    showGenericAlert('ilanAlert', 'İlan güncellenirken hata oluştu.', 'error');
                });
        }

        // İlan silme fonksiyonu
        function deleteIlan(ilanId, ilanBaslik) {
            if (confirm(`"${ilanBaslik}" ilanını silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.`)) {
                // Önce ilan verisini al (fotoğrafları silmek için)
                database.ref(`ilanlar/${ilanId}`).once('value')
                    .then((snapshot) => {
                        const ilan = snapshot.val();
                        
                        // Fotoğrafları Firebase Storage'dan sil
                        if (ilan.photos && Array.isArray(ilan.photos)) {
                            const deletePromises = ilan.photos.map(photo => {
                                if (photo.fileName) {
                                    return storageRef.child(photo.fileName).delete().catch(error => {
                                        console.error('Fotoğraf silinirken hata:', error);
                                    });
                                }
                                return Promise.resolve();
                            });
                            
                            Promise.all(deletePromises).then(() => {
                                // İlanı veritabanından sil
                                return database.ref(`ilanlar/${ilanId}`).remove();
                            });
                        } else {
                            // Fotoğraf yoksa direkt sil
                            return database.ref(`ilanlar/${ilanId}`).remove();
                        }
                    })
                    .then(() => {
                        showGenericAlert('ilanAlert', 'İlan başarıyla silindi!', 'success');
                        loadIlanList();
                    })
                    .catch((error) => {
                        console.error('İlan silme hatası:', error);
                        showGenericAlert('ilanAlert', 'İlan silinirken hata oluştu.', 'error');
                    });
            }
        }

        // Global fonksiyonlar
        window.showAddIlanForm = showAddIlanForm;
        window.hideIlanForm = hideIlanForm;
        window.calculateTotalPrice = calculateTotalPrice;
        window.loadIlceler = loadIlceler;
        window.loadMahalleler = loadMahalleler;
        window.saveIlan = saveIlan;
        window.editIlan = editIlan;
        window.updateIlan = updateIlan;
        window.deleteIlan = deleteIlan;

        // Firebase bağlantısını test et
        function testFirebaseConnection() {
            console.log('Admin paneli - Firebase bağlantısı test ediliyor...');
            
            const testRef = database.ref('test-connection');
            testRef.set({
                timestamp: Date.now(),
                message: 'Admin paneli Firebase bağlantısı çalışıyor'
            })
            .then(() => {
                console.log('✅ Admin Firebase yazma testi başarılı');
                showGenericAlert('ilanAlert', 'Firebase bağlantısı başarılı!', 'success');
            })
            .catch((error) => {
                console.error('❌ Admin Firebase test hatası:', error);
                showGenericAlert('ilanAlert', 'Firebase bağlantı hatası: ' + error.message, 'error');
            });
        }

        // Test butonu ekle
        window.testFirebaseConnection = testFirebaseConnection;

        // ===== GOOGLE MAPS INTEGRATION =====
        let ilanMap;
        let mapMarker;
        let isMapInitialized = false;

        // Google Maps callback function
        function initMap() {
            console.log('Google Maps API loaded');
            isMapInitialized = true;
        }

        // İlan haritasını başlat
        function initializeIlanMap() {
            if (typeof google === 'undefined' || !isMapInitialized) {
                setTimeout(initializeIlanMap, 500);
                return;
            }

            const mapElement = document.getElementById('ilanMap');
            if (!mapElement) return;

            // İstanbul merkezli başlangıç
            const defaultCenter = { lat: 41.0082, lng: 28.9784 };

            ilanMap = new google.maps.Map(mapElement, {
                zoom: 10,
                center: defaultCenter,
                mapTypeControl: true,
                streetViewControl: false,
                fullscreenControl: false,
                styles: [
                    {
                        featureType: 'poi',
                        elementType: 'labels',
                        stylers: [{ visibility: 'off' }]
                    }
                ]
            });

            // Haritaya tıklama eventi
            ilanMap.addListener('click', function(event) {
                const lat = event.latLng.lat();
                const lng = event.latLng.lng();
                
                setMapLocation(lat, lng);
            });

            console.log('İlan haritası başlatıldı');
        }

        // Haritada konum ayarla
        function setMapLocation(lat, lng) {
            if (!ilanMap) return;

            const position = { lat: lat, lng: lng };

            // Mevcut marker'ı temizle
            if (mapMarker) {
                mapMarker.setMap(null);
            }

            // Yeni marker ekle
            mapMarker = new google.maps.Marker({
                position: position,
                map: ilanMap,
                title: 'Seçilen Konum',
                animation: google.maps.Animation.DROP,
                icon: {
                    url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="#2563eb"/>
                        </svg>
                    `),
                    scaledSize: new google.maps.Size(32, 32),
                    anchor: new google.maps.Point(16, 32)
                }
            });

            // Input alanlarını güncelle
            document.getElementById('ilanLats').value = lat.toFixed(6);
            document.getElementById('ilanLangs').value = lng.toFixed(6);

            // Koordinat görüntüsünü güncelle
            updateCoordinatesDisplay(lat, lng);

            // Haritayı konuma yakınlaştır
            ilanMap.setCenter(position);
            if (ilanMap.getZoom() < 15) {
                ilanMap.setZoom(15);
            }
        }

        // Input alanlarından haritayı güncelle
        function updateMapFromInputs() {
            const latInput = document.getElementById('ilanLats');
            const lngInput = document.getElementById('ilanLangs');
            
            const lat = parseFloat(latInput.value);
            const lng = parseFloat(lngInput.value);

            if (isNaN(lat) || isNaN(lng)) {
                hideCoordinatesDisplay();
                return;
            }

            // Türkiye sınırları kontrolü (yaklaşık)
            if (lat < 35.8 || lat > 42.1 || lng < 25.6 || lng > 44.8) {
                hideCoordinatesDisplay();
                return;
            }

            if (ilanMap) {
                setMapLocation(lat, lng);
            } else {
                // Harita henüz yüklenmemişse koordinat görüntüsünü güncelle
                updateCoordinatesDisplay(lat, lng);
            }
        }

        // Koordinat görüntüsünü güncelle
        function updateCoordinatesDisplay(lat, lng) {
            const display = document.getElementById('coordinatesDisplay');
            const coordinates = document.getElementById('selectedCoordinates');
            
            if (display && coordinates) {
                coordinates.innerHTML = `
                    <strong>Enlem:</strong> ${lat.toFixed(6)}<br>
                    <strong>Boylam:</strong> ${lng.toFixed(6)}
                `;
                display.style.display = 'flex';
            }
        }

        // Koordinat görüntüsünü gizle
        function hideCoordinatesDisplay() {
            const display = document.getElementById('coordinatesDisplay');
            if (display) {
                display.style.display = 'none';
            }
        }

        // Harita konumunu temizle
        function clearMapLocation() {
            // Input alanlarını temizle
            document.getElementById('ilanLats').value = '';
            document.getElementById('ilanLangs').value = '';

            // Marker'ı kaldır
            if (mapMarker) {
                mapMarker.setMap(null);
                mapMarker = null;
            }

            // Koordinat görüntüsünü gizle
            hideCoordinatesDisplay();

            // Haritayı varsayılan konuma döndür
            if (ilanMap) {
                const defaultCenter = { lat: 41.0082, lng: 28.9784 };
                ilanMap.setCenter(defaultCenter);
                ilanMap.setZoom(10);
            }
        }

        // showAddIlanForm fonksiyonunu harita başlatma ile güncelle
        const originalShowAddIlanForm = showAddIlanForm;
        showAddIlanForm = function() {
            originalShowAddIlanForm();
            
            // Haritayı başlat (biraz gecikme ile)
            setTimeout(() => {
                initializeIlanMap();
            }, 500);
        };

        // Global fonksiyonları dışa aktar
        window.updateMapFromInputs = updateMapFromInputs;
        window.clearMapLocation = clearMapLocation;
        window.initMap = initMap;

        // ===== FİYAT HESAPLAMA FONKSİYONLARI =====
        
        // Gelecek fiyat hesaplama (bileşik faiz mantığı)
        function calculateProjectedPrice(currentPrice, ...yearlyRates) {
            if (!currentPrice || currentPrice <= 0) return 0;
            
            let projectedPrice = currentPrice;
            for (let rate of yearlyRates) {
                if (rate && rate > 0) {
                    projectedPrice = projectedPrice * (1 + rate / 100);
                }
            }
            return projectedPrice;
        }

        // Fiyat formatı
        function formatPrice(price) {
            if (!price || price <= 0) return 'Hesaplanacak';
            
            return new Intl.NumberFormat('tr-TR', {
                style: 'currency',
                currency: 'TRY',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(price);
        }

        // Gelecek fiyatları hesapla ve göster
        function calculateFuturePrices() {
            const metrekare = parseFloat(document.getElementById('ilanMetrekare').value) || 0;
            const metrekareFiyat = parseFloat(document.getElementById('ilanMetrekareFiyat').value) || 0;
            const currentPrice = metrekare * metrekareFiyat;
            
            const rate1 = parseFloat(document.getElementById('ilan1SeneArtis').value) || 0;
            const rate2 = parseFloat(document.getElementById('ilan2SeneArtis').value) || 0;
            const rate3 = parseFloat(document.getElementById('ilan3SeneArtis').value) || 0;

            // Her yıl için ayrı hesaplama
            const price1Year = calculateProjectedPrice(currentPrice, rate1);
            const price2Year = calculateProjectedPrice(currentPrice, rate1, rate2);
            const price3Year = calculateProjectedPrice(currentPrice, rate1, rate2, rate3);

            // Bireysel görüntüleme
            document.getElementById('fiyat1Sene').textContent = formatPrice(price1Year);
            document.getElementById('fiyat2Sene').textContent = formatPrice(price2Year);
            document.getElementById('fiyat3Sene').textContent = formatPrice(price3Year);

            // Özet görüntüleme
            document.getElementById('mevcutFiyatOzet').textContent = formatPrice(currentPrice);
            document.getElementById('birSeneOzet').textContent = formatPrice(price1Year);
            document.getElementById('ikiSeneOzet').textContent = formatPrice(price2Year);
            document.getElementById('ucSeneOzet').textContent = formatPrice(price3Year);
        }

        // Fiyat projeksiyonlarını sıfırla
        function resetPriceProjections() {
            // Input alanlarını temizle
            document.getElementById('ilan1SeneArtis').value = '';
            document.getElementById('ilan2SeneArtis').value = '';
            document.getElementById('ilan3SeneArtis').value = '';
            
            // Görüntüleri sıfırla
            document.getElementById('fiyat1Sene').textContent = 'Hesaplanacak';
            document.getElementById('fiyat2Sene').textContent = 'Hesaplanacak';
            document.getElementById('fiyat3Sene').textContent = 'Hesaplanacak';
            
            document.getElementById('mevcutFiyatOzet').textContent = '-';
            document.getElementById('birSeneOzet').textContent = '-';
            document.getElementById('ikiSeneOzet').textContent = '-';
            document.getElementById('ucSeneOzet').textContent = '-';
        }

        // calculateTotalPrice fonksiyonunu genişlet
        const originalCalculateTotalPrice = calculateTotalPrice;
        calculateTotalPrice = function() {
            originalCalculateTotalPrice();
            // Fiyat değiştiğinde future prices'ı da güncelle
            setTimeout(calculateFuturePrices, 100);
        };

        // Global fonksiyonları dışa aktar
        window.calculateFuturePrices = calculateFuturePrices;
        window.resetPriceProjections = resetPriceProjections;
        window.calculateProjectedPrice = calculateProjectedPrice;

        // ===== FOTOĞRAF YÖNETİM SİSTEMİ =====
        let uploadedPhotos = [];
        let currentIlanId = null;

        // Fotoğraf yükleme alanını başlat
        function initializePhotoUpload() {
            const uploadArea = document.getElementById('photoUploadArea');
            const photoInput = document.getElementById('photoInput');
            
            if (!uploadArea || !photoInput) return;

            // Click to upload
            uploadArea.addEventListener('click', () => {
                photoInput.click();
            });

            // File input change
            photoInput.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                if (files.length > 0) {
                    handleMultiplePhotoUpload(files);
                }
                photoInput.value = ''; // Reset input
            });

            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
                if (files.length > 0) {
                    handleMultiplePhotoUpload(files);
                }
            });
        }

        // Birden fazla fotoğraf yükleme
        function handleMultiplePhotoUpload(files) {
            // Dosya sayısı kontrolü
            if (uploadedPhotos.length + files.length > 20) {
                showGenericAlert('ilanAlert', 'Maksimum 20 fotoğraf yükleyebilirsiniz.', 'error');
                return;
            }

            // Dosya boyutu kontrolü
            for (let file of files) {
                if (!file.type.startsWith('image/')) {
                    showGenericAlert('ilanAlert', 'Sadece resim dosyaları yükleyebilirsiniz.', 'error');
                    return;
                }
                if (file.size > 10 * 1024 * 1024) { // 10MB
                    showGenericAlert('ilanAlert', `${file.name} dosyası çok büyük (Max 10MB).`, 'error');
                    return;
                }
            }

            // Her dosya için yükleme başlat
            files.forEach(file => {
                uploadSinglePhoto(file);
            });

            // Fotoğraf konteynerini göster
            showPhotosContainer();
        }

        // Tek fotoğraf yükleme
        function uploadSinglePhoto(file) {
            const photoId = generatePhotoId();
            const timestamp = new Date().getTime();
            const fileName = `listing-photos/${timestamp}-${photoId}-${sanitizeFileName(file.name)}`;

            // Önizleme için temporary photo objesi oluştur
            const tempPhoto = {
                id: photoId,
                file: file,
                fileName: fileName,
                name: file.name,
                size: file.size,
                uploading: true,
                progress: 0
            };

            // Fotoğraf listesine ekle
            uploadedPhotos.push(tempPhoto);
            
            // UI'da göster
            addPhotoToGrid(tempPhoto);
            updatePhotosCount();

            // Firebase Storage'a yükle
            const uploadTask = storageRef.child(fileName).put(file);

            uploadTask.on('state_changed',
                (snapshot) => {
                    // Progress tracking
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    tempPhoto.progress = progress;
                    updatePhotoProgress(photoId, progress);
                },
                (error) => {
                    // Error handling
                    console.error('Photo upload error:', error);
                    removePhotoFromList(photoId);
                    showGenericAlert('ilanAlert', `${file.name} yüklenirken hata oluştu.`, 'error');
                },
                () => {
                    // Upload completed successfully
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        // Update photo object
                        const photoIndex = uploadedPhotos.findIndex(p => p.id === photoId);
                        if (photoIndex !== -1) {
                            uploadedPhotos[photoIndex] = {
                                ...tempPhoto,
                                url: downloadURL,
                                uploading: false,
                                uploadedAt: firebase.database.ServerValue.TIMESTAMP
                            };
                            
                            // Update UI
                            updatePhotoItem(photoId, uploadedPhotos[photoIndex]);
                            showGenericAlert('ilanAlert', `${file.name} başarıyla yüklendi.`, 'success');
                        }
                    });
                }
            );
        }

        // Fotoğraf ID üret
        function generatePhotoId() {
            return 'photo_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // Dosya adını temizle
        function sanitizeFileName(fileName) {
            return fileName.replace(/[^a-zA-Z0-9.-]/g, '_').toLowerCase();
        }

        // Fotoğraf konteynerini göster
        function showPhotosContainer() {
            const container = document.getElementById('photosContainer');
            if (container) {
                container.style.display = 'block';
            }
        }

        // Grid'e fotoğraf ekle
        function addPhotoToGrid(photo) {
            const grid = document.getElementById('photosGrid');
            if (!grid) return;

            const photoElement = createPhotoElement(photo);
            grid.appendChild(photoElement);
        }

        // Fotoğraf elementi oluştur
        function createPhotoElement(photo) {
            const photoDiv = document.createElement('div');
            photoDiv.className = 'photo-item' + (photo.uploading ? ' uploading' : '');
            photoDiv.id = `photo-${photo.id}`;

            // Önizleme URL'i oluştur
            const previewUrl = photo.url || (photo.file ? URL.createObjectURL(photo.file) : '');

            photoDiv.innerHTML = `
                <div class="photo-order">${uploadedPhotos.indexOf(photo) + 1}</div>
                ${uploadedPhotos.indexOf(photo) === 0 ? '<div class="photo-primary-badge">Ana Foto</div>' : ''}
                <img src="${previewUrl}" alt="${photo.name}" class="photo-preview" loading="lazy">
                <div class="photo-overlay">
                    <div class="photo-actions">
                        <button class="photo-action-btn" onclick="setAsPrimary('${photo.id}')" title="Ana fotoğraf yap">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                        <button class="photo-action-btn" onclick="movePhotoUp('${photo.id}')" title="Yukarı taşı">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                        <button class="photo-action-btn" onclick="movePhotoDown('${photo.id}')" title="Aşağı taşı">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                        <button class="photo-action-btn delete" onclick="removePhoto('${photo.id}')" title="Sil">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2h8a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 2a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h.01a1 1 0 100-2H10zm3 0a1 1 0 000 2h.01a1 1 0 100-2H13z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="photo-info">
                    <div class="photo-name">${photo.name}</div>
                    <div class="photo-size">${formatFileSize(photo.size)}</div>
                </div>
                ${photo.uploading ? `<div class="photo-progress"><div class="photo-progress-bar" style="width: ${photo.progress || 0}%"></div></div>` : ''}
            `;

            return photoDiv;
        }

        // Dosya boyutunu formatla
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Fotoğraf progress güncelle
        function updatePhotoProgress(photoId, progress) {
            const photoElement = document.getElementById(`photo-${photoId}`);
            if (photoElement) {
                const progressBar = photoElement.querySelector('.photo-progress-bar');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
            }
        }

        // Fotoğraf elementi güncelle
        function updatePhotoItem(photoId, photo) {
            const photoElement = document.getElementById(`photo-${photoId}`);
            if (photoElement) {
                photoElement.classList.remove('uploading');
                const progressDiv = photoElement.querySelector('.photo-progress');
                if (progressDiv) {
                    progressDiv.remove();
                }
            }
        }

        // Fotoğraf sayısını güncelle
        function updatePhotosCount() {
            const countElement = document.getElementById('photosCount');
            if (countElement) {
                const count = uploadedPhotos.length;
                countElement.innerHTML = `<strong>${count}</strong> fotoğraf yüklendi`;
            }
        }

        // Fotoğrafı listeden kaldır
        function removePhotoFromList(photoId) {
            const index = uploadedPhotos.findIndex(p => p.id === photoId);
            if (index !== -1) {
                uploadedPhotos.splice(index, 1);
            }
            
            const photoElement = document.getElementById(`photo-${photoId}`);
            if (photoElement) {
                photoElement.remove();
            }
            
            updatePhotosCount();
            refreshPhotosGrid();
        }

        // Fotoğraf grid'ini yenile
        function refreshPhotosGrid() {
            const grid = document.getElementById('photosGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            uploadedPhotos.forEach(photo => {
                addPhotoToGrid(photo);
            });
        }

        // Ana fotoğraf olarak ayarla
        function setAsPrimary(photoId) {
            const index = uploadedPhotos.findIndex(p => p.id === photoId);
            if (index !== -1 && index !== 0) {
                // Fotoğrafı en başa taşı
                const photo = uploadedPhotos.splice(index, 1)[0];
                uploadedPhotos.unshift(photo);
                refreshPhotosGrid();
                updatePhotosCount();
            }
        }

        // Fotoğrafı yukarı taşı
        function movePhotoUp(photoId) {
            const index = uploadedPhotos.findIndex(p => p.id === photoId);
            if (index > 0) {
                [uploadedPhotos[index], uploadedPhotos[index - 1]] = [uploadedPhotos[index - 1], uploadedPhotos[index]];
                refreshPhotosGrid();
            }
        }

        // Fotoğrafı aşağı taşı
        function movePhotoDown(photoId) {
            const index = uploadedPhotos.findIndex(p => p.id === photoId);
            if (index !== -1 && index < uploadedPhotos.length - 1) {
                [uploadedPhotos[index], uploadedPhotos[index + 1]] = [uploadedPhotos[index + 1], uploadedPhotos[index]];
                refreshPhotosGrid();
            }
        }

        // Fotoğrafı sil
        function removePhoto(photoId) {
            if (confirm('Bu fotoğrafı silmek istediğinizden emin misiniz?')) {
                const photo = uploadedPhotos.find(p => p.id === photoId);
                
                // Firebase Storage'dan sil
                if (photo && photo.fileName && !photo.uploading) {
                    storageRef.child(photo.fileName).delete().catch(error => {
                        console.error('Error deleting photo from storage:', error);
                    });
                }
                
                removePhotoFromList(photoId);
            }
        }

        // Tüm fotoğrafları sil
        function clearAllPhotos() {
            if (uploadedPhotos.length === 0) return;
            
            if (confirm('Tüm fotoğrafları silmek istediğinizden emin misiniz?')) {
                // Firebase Storage'dan sil
                uploadedPhotos.forEach(photo => {
                    if (photo.fileName && !photo.uploading) {
                        storageRef.child(photo.fileName).delete().catch(error => {
                            console.error('Error deleting photo from storage:', error);
                        });
                    }
                });
                
                uploadedPhotos = [];
                const grid = document.getElementById('photosGrid');
                if (grid) grid.innerHTML = '';
                
                const container = document.getElementById('photosContainer');
                if (container) container.style.display = 'none';
                
                updatePhotosCount();
            }
        }

        // Fotoğrafları sırala
        function sortPhotos() {
            uploadedPhotos.sort((a, b) => a.name.localeCompare(b.name));
            refreshPhotosGrid();
        }

        // Daha fazla fotoğraf ekle
        function addMorePhotos() {
            document.getElementById('photoInput').click();
        }

        // showAddIlanForm fonksiyonunu fotoğraf sistemi ile güncelle
        const originalShowAddIlanFormWithPhotos = showAddIlanForm;
        showAddIlanForm = function() {
            originalShowAddIlanFormWithPhotos();
            
            // Fotoğraf sistemini başlat
            setTimeout(() => {
                initializePhotoUpload();
                uploadedPhotos = []; // Reset photos
                const container = document.getElementById('photosContainer');
                if (container) container.style.display = 'none';
            }, 500);
        };

        // Global fonksiyonları dışa aktar
        window.setAsPrimary = setAsPrimary;
        window.movePhotoUp = movePhotoUp;
        window.movePhotoDown = movePhotoDown;
        window.removePhoto = removePhoto;
        window.clearAllPhotos = clearAllPhotos;
        window.sortPhotos = sortPhotos;
        window.addMorePhotos = addMorePhotos;

        // ===== ÖZELLİK YÖNETİM SİSTEMİ =====
        let selectedFeatures = new Set();

        // Özellik toggle fonksiyonu
        function toggleFeature(featureKey) {
            const toggle = document.querySelector(`[data-feature="${featureKey}"]`);
            if (!toggle) return;

            if (selectedFeatures.has(featureKey)) {
                selectedFeatures.delete(featureKey);
                toggle.classList.remove('active');
            } else {
                selectedFeatures.add(featureKey);
                toggle.classList.add('active');
            }

            updateFeaturesSummary();
        }

        // Alt yapı özelliklerini al
        function getAltyapiFeatures() {
            const altyapiFeatures = [
                'elektrik', 'sanayi_elektrik', 'su', 'telefon', 'doganlaz', 'kanalizasyon', 
                'aritma', 'sondaj_kuyu', 'zemin_etudu', 'yolu_acilmis', 'yolu_var'
            ];
            
            const features = {};
            altyapiFeatures.forEach(feature => {
                features[feature] = selectedFeatures.has(feature);
            });
            
            return features;
        }

        // Konum özelliklerini al
        function getKonumFeatures() {
            const konumFeatures = [
                'ana_yola_yakin', 'denize_sifir', 'itfaiyeye_yakin', 'havalimanina_yakin', 
                'toplu_tasimaya_yakin', 'denize_yakin', 'hastaneye_yakin', 'su_kaynagina_yakin'
            ];
            
            const features = {};
            konumFeatures.forEach(feature => {
                features[feature] = selectedFeatures.has(feature);
            });
            
            return features;
        }

        // Genel özellikleri al
        function getGenelFeatures() {
            const genelFeatures = [
                'ifrazli', 'parselli', 'projeli', 'kose_parselli'
            ];
            
            const features = {};
            genelFeatures.forEach(feature => {
                features[feature] = selectedFeatures.has(feature);
            });
            
            return features;
        }

        // Özellik özetini güncelle
        function updateFeaturesSummary() {
            const summaryContainer = document.getElementById('featuresSummary');
            if (!summaryContainer) return;

            if (selectedFeatures.size === 0) {
                summaryContainer.innerHTML = `
                    <div class="feature-summary-item">
                        <div class="feature-summary-indicator"></div>
                        <span>Henüz özellik seçilmedi</span>
                    </div>
                `;
                return;
            }

            const featureLabels = {
                'elektrik': 'Elektrik',
                'sanayi_elektrik': 'Sanayi Elektriği',
                'su': 'Su',
                'telefon': 'Telefon',
                'doganlaz': 'Doğalgaz',
                'kanalizasyon': 'Kanalizasyon',
                'aritma': 'Arıtma',
                'sondaj_kuyu': 'Sondaj Kuyu',
                'zemin_etudu': 'Zemin Etüdü',
                'yolu_acilmis': 'Yolu Açılmış',
                'yolu_var': 'Yolu Var',
                'ana_yola_yakin': 'Ana Yola Yakın',
                'denize_sifir': 'Denize Sıfır',
                'itfaiyeye_yakin': 'İtfaiyeye Yakın',
                'havalimanina_yakin': 'Havalimanına Yakın',
                'toplu_tasimaya_yakin': 'Toplu Taşımaya Yakın',
                'denize_yakin': 'Denize Yakın',
                'hastaneye_yakin': 'Hastaneye Yakın',
                'su_kaynagina_yakin': 'Su Kaynağına Yakın',
                'ifrazli': 'İfrazlı',
                'parselli': 'Parselli',
                'projeli': 'Projeli',
                'kose_parselli': 'Köşe Parselli'
            };

            const summaryHTML = Array.from(selectedFeatures).map(feature => `
                <div class="feature-summary-item">
                    <div class="feature-summary-indicator active"></div>
                    <span>${featureLabels[feature] || feature}</span>
                </div>
            `).join('');

            summaryContainer.innerHTML = summaryHTML;
        }

        // Tüm özellikleri seç
        function selectAllFeatures() {
            const allToggles = document.querySelectorAll('.feature-toggle');
            allToggles.forEach(toggle => {
                const featureKey = toggle.getAttribute('data-feature');
                if (featureKey) {
                    selectedFeatures.add(featureKey);
                    toggle.classList.add('active');
                }
            });
            updateFeaturesSummary();
        }

        // Tüm özellikleri kaldır
        function deselectAllFeatures() {
            const allToggles = document.querySelectorAll('.feature-toggle');
            allToggles.forEach(toggle => {
                const featureKey = toggle.getAttribute('data-feature');
                if (featureKey) {
                    selectedFeatures.delete(featureKey);
                    toggle.classList.remove('active');
                }
            });
            updateFeaturesSummary();
        }

        // Özellikleri sıfırla
        function resetFeatures() {
            if (confirm('Tüm özellik seçimlerini sıfırlamak istediğinizden emin misiniz?')) {
                selectedFeatures.clear();
                const allToggles = document.querySelectorAll('.feature-toggle');
                allToggles.forEach(toggle => {
                    toggle.classList.remove('active');
                });
                updateFeaturesSummary();
            }
        }

        // showAddIlanForm fonksiyonunu özellik sistemi ile güncelle
        const originalShowAddIlanFormWithFeatures = showAddIlanForm;
        showAddIlanForm = function() {
            originalShowAddIlanFormWithFeatures();
            
            // Özellik sistemini başlat
            setTimeout(() => {
                selectedFeatures.clear();
                updateFeaturesSummary();
                const allToggles = document.querySelectorAll('.feature-toggle');
                allToggles.forEach(toggle => {
                    toggle.classList.remove('active');
                });
            }, 500);
        };

        // Global fonksiyonları dışa aktar
        window.toggleFeature = toggleFeature;
        window.selectAllFeatures = selectAllFeatures;
        window.deselectAllFeatures = deselectAllFeatures;
        window.resetFeatures = resetFeatures;
        window.getAltyapiFeatures = getAltyapiFeatures;
        window.getKonumFeatures = getKonumFeatures;
        window.getGenelFeatures = getGenelFeatures;

        // ===== ÇEVRE YÖNETİM SİSTEMİ =====
        let selectedCevreler = new Map(); // cevreId -> {active: boolean, distance: number}
        let cevrelerData = []; // Firebase'den gelen çevre verileri

        // Çevreleri Firebase'den yükle
        function loadCevreler() {
            const loadingDiv = document.getElementById('cevrelerLoading');
            const contentDiv = document.getElementById('cevrelerContent');
            const errorDiv = document.getElementById('cevrelerError');

            loadingDiv.style.display = 'block';
            contentDiv.style.display = 'none';
            errorDiv.style.display = 'none';

            database.ref('cevreler').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        cevrelerData = Object.keys(data).map(key => ({
                            id: key,
                            ...data[key]
                        }));
                        
                        // Kategorilere göre grupla
                        const groupedCevreler = groupCevrelerByKategori(cevrelerData);
                        renderCevreler(groupedCevreler);
                        
                        loadingDiv.style.display = 'none';
                        contentDiv.style.display = 'block';
                    } else {
                        throw new Error('Çevre verisi bulunamadı');
                    }
                })
                .catch((error) => {
                    console.error('Çevreler yüklenirken hata:', error);
                    loadingDiv.style.display = 'none';
                    errorDiv.style.display = 'block';
                });
        }

        // Çevreleri kategorilere göre grupla
        function groupCevrelerByKategori(cevreler) {
            const grouped = {};
            
            cevreler.forEach(cevre => {
                const kategoriName = cevre.kategoriName || 'Diğer';
                if (!grouped[kategoriName]) {
                    grouped[kategoriName] = [];
                }
                grouped[kategoriName].push(cevre);
            });
            
            return grouped;
        }

        // Çevreleri render et
        function renderCevreler(groupedCevreler) {
            const contentDiv = document.getElementById('cevrelerContent');
            
            let html = '';
            
            Object.keys(groupedCevreler).forEach(kategoriName => {
                const cevreler = groupedCevreler[kategoriName];
                
                html += `
                    <div class="cevre-kategori">
                        <div class="cevre-kategori-header">
                            <div class="cevre-kategori-title">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                                </svg>
                                ${kategoriName}
                            </div>
                        </div>
                        <div class="cevre-list">
                `;
                
                cevreler.forEach(cevre => {
                    html += `
                        <div class="cevre-item">
                            <div class="cevre-info">
                                <span class="cevre-name">${cevre.name}</span>
                            </div>
                            <div class="cevre-toggle" data-cevre-id="${cevre.id}" onclick="toggleCevre('${cevre.id}')"></div>
                            <div class="cevre-distance">
                                <input type="number" 
                                       id="cevre-distance-${cevre.id}" 
                                       placeholder="0.0" 
                                       step="0.1" 
                                       min="0" 
                                       max="100"
                                       oninput="updateCevreDistance('${cevre.id}', this.value)"
                                       style="display: none;">
                                <span class="cevre-distance-label">km</span>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            contentDiv.innerHTML = html;
        }

        // Çevre toggle fonksiyonu
        function toggleCevre(cevreId) {
            const toggle = document.querySelector(`[data-cevre-id="${cevreId}"]`);
            const distanceInput = document.getElementById(`cevre-distance-${cevreId}`);
            
            if (!toggle) return;

            if (selectedCevreler.has(cevreId)) {
                // Çevreyi kaldır
                selectedCevreler.delete(cevreId);
                toggle.classList.remove('active');
                if (distanceInput) {
                    distanceInput.style.display = 'none';
                    distanceInput.value = '';
                }
            } else {
                // Çevreyi ekle
                selectedCevreler.set(cevreId, {
                    active: true,
                    distance: 0
                });
                toggle.classList.add('active');
                if (distanceInput) {
                    distanceInput.style.display = 'inline-block';
                    distanceInput.focus();
                }
            }

            updateCevrelerSummary();
        }

        // Çevre mesafesini güncelle
        function updateCevreDistance(cevreId, distance) {
            if (selectedCevreler.has(cevreId)) {
                const cevreData = selectedCevreler.get(cevreId);
                cevreData.distance = parseFloat(distance) || 0;
                selectedCevreler.set(cevreId, cevreData);
                updateCevrelerSummary();
            }
        }

        // Seçili çevreleri al
        function getSelectedCevreler() {
            const cevreler = {};
            
            selectedCevreler.forEach((data, cevreId) => {
                const cevre = cevrelerData.find(c => c.id === cevreId);
                if (cevre) {
                    cevreler[cevreId] = {
                        id: cevreId,
                        name: cevre.name,
                        kategoriId: cevre.kategoriId,
                        kategoriName: cevre.kategoriName,
                        active: data.active,
                        distance: data.distance
                    };
                }
            });
            
            return cevreler;
        }

        // Çevreler özetini güncelle
        function updateCevrelerSummary() {
            const summaryContainer = document.getElementById('cevrelerSummary');
            if (!summaryContainer) return;

            if (selectedCevreler.size === 0) {
                summaryContainer.innerHTML = `
                    <div class="cevre-summary-item">
                        <div class="cevre-summary-indicator"></div>
                        <span>Henüz çevre seçilmedi</span>
                    </div>
                `;
                return;
            }

            const summaryHTML = Array.from(selectedCevreler.entries()).map(([cevreId, data]) => {
                const cevre = cevrelerData.find(c => c.id === cevreId);
                if (!cevre) return '';
                
                return `
                    <div class="cevre-summary-item">
                        <div class="cevre-summary-indicator active"></div>
                        <span>${cevre.name}</span>
                        ${data.distance > 0 ? `<span class="cevre-summary-distance">(${data.distance} km)</span>` : ''}
                    </div>
                `;
            }).join('');

            summaryContainer.innerHTML = summaryHTML;
        }

        // showAddIlanForm fonksiyonunu çevre sistemi ile güncelle
        const originalShowAddIlanFormWithCevreler = showAddIlanForm;
        showAddIlanForm = function() {
            originalShowAddIlanFormWithCevreler();
            
            // Çevre sistemini başlat
            setTimeout(() => {
                selectedCevreler.clear();
                updateCevrelerSummary();
                loadCevreler();
            }, 500);
        };

        // Global fonksiyonları dışa aktar
        window.toggleCevre = toggleCevre;
        window.updateCevreDistance = updateCevreDistance;
        window.getSelectedCevreler = getSelectedCevreler;
        window.loadCevreler = loadCevreler;

        // ===== RICH TEXT EDITOR SİSTEMİ =====
        
        // Editor komutlarını çalıştır
        function execCommand(command, value = null) {
            document.execCommand(command, false, value);
            updateEditorStats();
            updateToolbarState();
        }

        // Editor istatistiklerini güncelle
        function updateEditorStats() {
            const editor = document.getElementById('ilanAciklama');
            const wordCountElement = document.getElementById('wordCount');
            
            if (editor && wordCountElement) {
                const text = editor.innerText || editor.textContent || '';
                const words = text.trim() ? text.trim().split(/\s+/).length : 0;
                wordCountElement.textContent = `${words} kelime`;
            }
        }

        // Toolbar durumunu güncelle
        function updateToolbarState() {
            const editor = document.getElementById('ilanAciklama');
            if (!editor) return;

            // Bold durumu
            const boldBtn = document.querySelector('[onclick="execCommand(\'bold\')"]');
            if (boldBtn) {
                boldBtn.classList.toggle('active', document.queryCommandState('bold'));
            }

            // Italic durumu
            const italicBtn = document.querySelector('[onclick="execCommand(\'italic\')"]');
            if (italicBtn) {
                italicBtn.classList.toggle('active', document.queryCommandState('italic'));
            }

            // Underline durumu
            const underlineBtn = document.querySelector('[onclick="execCommand(\'underline\')"]');
            if (underlineBtn) {
                underlineBtn.classList.toggle('active', document.queryCommandState('underline'));
            }
        }

        // Editor klavye kısayolları
        function handleEditorKeydown(event) {
            // Ctrl+B: Bold
            if (event.ctrlKey && event.key === 'b') {
                event.preventDefault();
                execCommand('bold');
            }
            // Ctrl+I: Italic
            else if (event.ctrlKey && event.key === 'i') {
                event.preventDefault();
                execCommand('italic');
            }
            // Ctrl+U: Underline
            else if (event.ctrlKey && event.key === 'u') {
                event.preventDefault();
                execCommand('underline');
            }
            // Ctrl+L: Unordered List
            else if (event.ctrlKey && event.key === 'l') {
                event.preventDefault();
                execCommand('insertUnorderedList');
            }
            // Ctrl+O: Ordered List
            else if (event.ctrlKey && event.key === 'o') {
                event.preventDefault();
                execCommand('insertOrderedList');
            }
        }

        // Paste işlemini temizle
        function handleEditorPaste(event) {
            event.preventDefault();
            
            // Sadece metin içeriğini al
            const text = event.clipboardData.getData('text/plain');
            
            // Seçili metni değiştir
            document.execCommand('insertText', false, text);
            
            updateEditorStats();
        }

        // Editor içeriğini al
        function getEditorContent() {
            const editor = document.getElementById('ilanAciklama');
            if (!editor) return '';
            
            return editor.innerHTML;
        }

        // Editor'ü temizle
        function clearEditor() {
            if (confirm('Editor içeriğini temizlemek istediğinizden emin misiniz?')) {
                const editor = document.getElementById('ilanAciklama');
                if (editor) {
                    editor.innerHTML = '';
                    updateEditorStats();
                }
            }
        }

        // Örnek metin ekle
        function insertSampleText() {
            const sampleText = `
                <h3>🏠 İlan Açıklaması</h3>
                <p>Bu <strong>mükemmel arsa</strong> satışa sunulmuştur. <em>Merkezi konumda</em> bulunan bu arsa, yatırım için ideal bir fırsattır.</p>
                
                <h4>📍 Konum Özellikleri:</h4>
                <ul>
                    <li>Ana yola yakın</li>
                    <li>Toplu taşıma imkanı</li>
                    <li>Alışveriş merkezlerine kolay erişim</li>
                </ul>
                
                <h4>🏗️ Alt Yapı Durumu:</h4>
                <ul>
                    <li>Elektrik bağlantısı mevcut</li>
                    <li>Su şebekesi hazır</li>
                    <li>Doğalgaz hattı mevcut</li>
                </ul>
                
                <p><strong>Not:</strong> Bu arsa için detaylı bilgi almak isterseniz bizimle iletişime geçebilirsiniz.</p>
            `;
            
            const editor = document.getElementById('ilanAciklama');
            if (editor) {
                editor.innerHTML = sampleText;
                updateEditorStats();
            }
        }

        // Editor'ü başlat
        function initializeEditor() {
            const editor = document.getElementById('ilanAciklama');
            if (editor) {
                // Focus event
                editor.addEventListener('focus', updateToolbarState);
                
                // Mouse up event (seçim değiştiğinde)
                editor.addEventListener('mouseup', updateToolbarState);
                editor.addEventListener('keyup', updateToolbarState);
                
                // İlk istatistik güncellemesi
                updateEditorStats();
            }
        }

        // showAddIlanForm fonksiyonunu editor sistemi ile güncelle
        const originalShowAddIlanFormWithEditor = showAddIlanForm;
        showAddIlanForm = function() {
            originalShowAddIlanFormWithEditor();
            
            // Editor sistemini başlat
            setTimeout(() => {
                initializeEditor();
                const editor = document.getElementById('ilanAciklama');
                if (editor) {
                    editor.innerHTML = '';
                    updateEditorStats();
                }
            }, 500);
        };

        // Global fonksiyonları dışa aktar
        window.execCommand = execCommand;
        window.updateEditorStats = updateEditorStats;
        window.handleEditorKeydown = handleEditorKeydown;
        window.handleEditorPaste = handleEditorPaste;
        window.getEditorContent = getEditorContent;
        window.clearEditor = clearEditor;
        window.insertSampleText = insertSampleText;

        // ===== PROJE YÖNETİMİ FONKSİYONLARI =====
        
        let selectedProjeIlanlar = new Set(); // Seçilen ilan ID'leri
        let activeIlanlarData = []; // Aktif ilanlar verisi
        let isEditingProje = false;
        let editingProjeId = null;

        // Proje formu göster
        function showAddProjeForm() {
            const form = document.getElementById('projeForm');
            const title = document.getElementById('projeFormTitle');
            
            if (form && title) {
                // Formu temizle
                clearProjeForm();
                
                // Başlığı güncelle
                title.textContent = 'Yeni Proje Ekle';
                
                // Form görünürlüğü
                form.style.display = 'block';
                form.scrollIntoView({ behavior: 'smooth' });
                
                // Aktif ilanları yükle
                loadAktifIlanlar();
                
                // Düzenleme durumunu sıfırla
                isEditingProje = false;
                editingProjeId = null;
            }
        }

        // Proje formu gizle
        function hideProjeForm() {
            const form = document.getElementById('projeForm');
            if (form) {
                form.style.display = 'none';
            }
            clearProjeForm();
        }

        // Proje formu temizle
        function clearProjeForm() {
            // Input alanlarını temizle
            const baslik = document.getElementById('projeBaslik');
            const aciklama = document.getElementById('projeAciklama');
            
            if (baslik) baslik.value = '';
            if (aciklama) aciklama.value = '';
            
            // Checkbox'ları temizle
            const checkboxes = document.querySelectorAll('#projeFormContent input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
            
            // Seçili ilanları temizle
            selectedProjeIlanlar.clear();
            updateProjeIlanlariDisplay();
        }

        // Aktif ilanları yükle
        function loadAktifIlanlar() {
            const container = document.getElementById('aktifIlanlar');
            if (!container) return;
            
            container.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">İlanlar yükleniyor...</p>
                </div>
            `;
            
            // Firebase'den aktif ilanları getir
            database.ref('ilanlar').once('value')
                .then(snapshot => {
                    activeIlanlarData = [];
                    const data = snapshot.val();
                    
                    console.log('Firebase ilanlar data:', data); // Debug için
                    
                    if (data) {
                        Object.keys(data).forEach(key => {
                            const ilan = { ...data[key], id: key };
                            console.log('İlan verisi:', ilan); // Debug için
                            // Durum kontrolü yapmadan tüm ilanları ekle (durum alanı yoksa)
                            if (!ilan.durum || ilan.durum === 'aktif' || ilan.durum === undefined) {
                                activeIlanlarData.push(ilan);
                            }
                        });
                    }
                    
                    console.log('Yüklenen ilan sayısı:', activeIlanlarData.length); // Debug için
                    renderAktifIlanlar();
                })
                .catch(error => {
                    console.error('Aktif ilanlar yüklenirken hata:', error);
                    container.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>İlanlar yüklenirken bir hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // Aktif ilanları render et
        function renderAktifIlanlar() {
            const container = document.getElementById('aktifIlanlar');
            if (!container) return;
            
            if (activeIlanlarData.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                        <p>Henüz aktif ilan bulunmuyor.</p>
                    </div>
                `;
                return;
            }
            
            const ilanlarHTML = activeIlanlarData
                .filter(ilan => !selectedProjeIlanlar.has(ilan.id)) // Seçili olmayan ilanlar
                .map(ilan => `
                    <div class="ilan-card" draggable="true" data-ilan-id="${ilan.id}" ondragstart="dragStart(event)">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                            <h6 style="margin: 0; font-size: 0.9rem; color: var(--text-primary); line-height: 1.3;">${ilan.baslik || 'Başlık Yok'}</h6>
                            <span style="background: var(--success-color); color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.7rem;">Aktif</span>
                        </div>
                        <p style="margin: 0; font-size: 0.8rem; color: var(--text-secondary);">İlan No: ${ilan.ilanNo || 'N/A'}</p>
                        <p style="margin: 0; font-size: 0.8rem; color: var(--text-secondary);">${ilan.sehir || ''}, ${ilan.ilce || ''}</p>
                        <p style="margin: 0.5rem 0 0 0; font-size: 0.8rem; color: var(--primary-color); font-weight: 600;">
                            ${ilan.toplamFiyat ? new Intl.NumberFormat('tr-TR').format(ilan.toplamFiyat) + '₺' : 'Fiyat Yok'}
                        </p>
                    </div>
                `).join('');
            
            container.innerHTML = ilanlarHTML || `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <p>Tüm ilanlar proje içerisinde.</p>
                </div>
            `;
        }

        // Proje ilanları display güncelle
        function updateProjeIlanlariDisplay() {
            const container = document.getElementById('projeIlanlari');
            if (!container) return;
            
            if (selectedProjeIlanlar.size === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                        <svg width="48" height="48" fill="currentColor" viewBox="0 0 20 20" style="opacity: 0.3;">
                            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                        </svg>
                        <p>İlanları buraya sürükleyin</p>
                    </div>
                `;
                return;
            }
            
            const secilenIlanlar = activeIlanlarData.filter(ilan => selectedProjeIlanlar.has(ilan.id));
            const ilanlarHTML = secilenIlanlar.map(ilan => `
                <div class="ilan-card selected" data-ilan-id="${ilan.id}">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                        <h6 style="margin: 0; font-size: 0.9rem; color: var(--text-primary); line-height: 1.3;">${ilan.baslik || 'Başlık Yok'}</h6>
                        <button onclick="removeIlanFromProje('${ilan.id}')" style="background: var(--danger-color); color: white; border: none; border-radius: 4px; padding: 0.2rem 0.4rem; font-size: 0.7rem; cursor: pointer;">
                            ✕
                        </button>
                    </div>
                    <p style="margin: 0; font-size: 0.8rem; color: var(--text-secondary);">İlan No: ${ilan.ilanNo || 'N/A'}</p>
                    <p style="margin: 0; font-size: 0.8rem; color: var(--text-secondary);">${ilan.sehir || ''}, ${ilan.ilce || ''}</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.8rem; color: var(--primary-color); font-weight: 600;">
                        ${ilan.toplamFiyat ? new Intl.NumberFormat('tr-TR').format(ilan.toplamFiyat) + '₺' : 'Fiyat Yok'}
                    </p>
                </div>
            `).join('');
            
            container.innerHTML = ilanlarHTML;
            
            // Aktif ilanları da güncelle
            renderAktifIlanlar();
        }

        // Drag & Drop fonksiyonları
        function allowDrop(event) {
            event.preventDefault();
        }

        function dragStart(event) {
            event.dataTransfer.setData("text/plain", event.target.dataset.ilanId);
        }

        function dropIlan(event) {
            event.preventDefault();
            const ilanId = event.dataTransfer.getData("text/plain");
            
            if (ilanId && !selectedProjeIlanlar.has(ilanId)) {
                selectedProjeIlanlar.add(ilanId);
                updateProjeIlanlariDisplay();
            }
        }

        // İlanı projeden çıkar
        function removeIlanFromProje(ilanId) {
            selectedProjeIlanlar.delete(ilanId);
            updateProjeIlanlariDisplay();
        }

        // Proje kaydet
        function saveProje() {
            const baslik = document.getElementById('projeBaslik').value.trim();
            const aciklama = document.getElementById('projeAciklama').value.trim();
            
            // Validation
            if (!baslik) {
                showAlert('projeAlert', 'Proje başlığı zorunludur!', 'error');
                return;
            }
            
            if (!aciklama) {
                showAlert('projeAlert', 'Proje açıklaması zorunludur!', 'error');
                return;
            }
            
            if (selectedProjeIlanlar.size === 0) {
                showAlert('projeAlert', 'En az bir ilan seçmelisiniz!', 'error');
                return;
            }
            
            // Özellik verilerini topla
            const altyapi_ozellikleri = {
                elektrik: document.getElementById('proje_elektrik').checked,
                sanayi_elektrik: document.getElementById('proje_sanayi_elektrik').checked,
                su: document.getElementById('proje_su').checked,
                telefon: document.getElementById('proje_telefon').checked,
                dogalgaz: document.getElementById('proje_dogalgaz').checked,
                kanalizasyon: document.getElementById('proje_kanalizasyon').checked,
                aritma: document.getElementById('proje_aritma').checked,
                sondaj_kuyu: document.getElementById('proje_sondaj_kuyu').checked,
                zemin_etudu: document.getElementById('proje_zemin_etudu').checked,
                yolu_acilmis: document.getElementById('proje_yolu_acilmis').checked
            };
            
            const konum_ozellikleri = {
                ana_yola_yakin: document.getElementById('proje_ana_yola_yakin').checked,
                denize_sifir: document.getElementById('proje_denize_sifir').checked,
                itfaiyeye_yakin: document.getElementById('proje_itfaiyeye_yakin').checked,
                havalimanina_yakin: document.getElementById('proje_havalimanina_yakin').checked,
                toplu_tasimaya_yakin: document.getElementById('proje_toplu_tasimaya_yakin').checked,
                denize_yakin: document.getElementById('proje_denize_yakin').checked,
                hastaneye_yakin: document.getElementById('proje_hastaneye_yakin').checked,
                su_kaynagina_yakin: document.getElementById('proje_su_kaynagina_yakin').checked
            };
            
            const genel_ozellikler = {
                ifrazli: document.getElementById('proje_ifrazli').checked,
                parselli: document.getElementById('proje_parselli').checked,
                projeli: document.getElementById('proje_projeli').checked,
                kose_parselli: document.getElementById('proje_kose_parselli').checked
            };
            
            // İlanları obje formatına çevir
            const ilanlar = {};
            selectedProjeIlanlar.forEach(ilanId => {
                ilanlar[ilanId] = true; // Firebase için sadece key olarak kullanıyoruz
            });
            
            const projeData = {
                baslik: baslik,
                aciklama: aciklama,
                altyapi_ozellikleri: altyapi_ozellikleri,
                konum_ozellikleri: konum_ozellikleri,
                genel_ozellikler: genel_ozellikler,
                ilanlar: ilanlar,
                olusturulmaTarihi: firebase.database.ServerValue.TIMESTAMP,
                durum: 'aktif'
            };
            
            // Firebase'e kaydet
            const projeRef = isEditingProje ? 
                database.ref(`projeler/${editingProjeId}`) : 
                database.ref('projeler').push();
            
            projeRef.set(projeData)
                .then(() => {
                    const message = isEditingProje ? 'Proje başarıyla güncellendi!' : 'Proje başarıyla kaydedildi!';
                    showAlert('projeAlert', message, 'success');
                    hideProjeForm();
                    loadProjeList(); // Listeyi yenile
                })
                .catch(error => {
                    console.error('Proje kaydedilirken hata:', error);
                    showAlert('projeAlert', 'Proje kaydedilirken bir hata oluştu!', 'error');
                });
        }

        // Proje listesi yükle
        function loadProjeList() {
            const container = document.getElementById('projeList');
            if (!container) return;
            
            container.innerHTML = `
                <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    <div class="loading"></div>
                    <p style="margin-top: 1rem;">Projeler yükleniyor...</p>
                </div>
            `;
            
            database.ref('projeler').once('value')
                .then(snapshot => {
                    const data = snapshot.val();
                    const projeler = [];
                    
                    if (data) {
                        Object.keys(data).forEach(key => {
                            projeler.push({ ...data[key], id: key });
                        });
                    }
                    
                    renderProjeList(projeler);
                })
                .catch(error => {
                    console.error('Projeler yüklenirken hata:', error);
                    container.innerHTML = `
                        <div style="text-align: center; color: var(--danger-color); padding: 2rem;">
                            <p>Projeler yüklenirken bir hata oluştu.</p>
                        </div>
                    `;
                });
        }

        // Proje listesi render et
        function renderProjeList(projeler) {
            const container = document.getElementById('projeList');
            if (!container) return;
            
            if (projeler.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                        <p>Henüz proje eklenmemiş.</p>
                    </div>
                `;
                return;
            }
            
            const projeHTML = projeler.map(proje => {
                const ilanSayisi = proje.ilanlar ? Object.keys(proje.ilanlar).length : 0;
                const tarih = proje.olusturulmaTarihi ? new Date(proje.olusturulmaTarihi).toLocaleDateString('tr-TR') : 'Bilinmiyor';
                
                return `
                    <div class="admin-card" style="margin-bottom: 1rem;">
                        <div class="admin-card-header">
                            <div>
                                <h4 style="margin: 0; color: var(--text-primary);">${proje.baslik}</h4>
                                <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary); font-size: 0.9rem;">${ilanSayisi} ilan • ${tarih}</p>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-sm btn-secondary" onclick="editProje('${proje.id}')" title="Düzenle">
                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                    </svg>
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="deleteProje('${proje.id}')" title="Sil">
                                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"/>
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="admin-card-body">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">${proje.aciklama}</p>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = projeHTML;
        }

        // Proje düzenle
        function editProje(projeId) {
            database.ref(`projeler/${projeId}`).once('value')
                .then(snapshot => {
                    const proje = snapshot.val();
                    if (!proje) {
                        showAlert('projeAlert', 'Proje bulunamadı!', 'error');
                        return;
                    }
                    
                    // Form alanlarını doldur
                    document.getElementById('projeBaslik').value = proje.baslik || '';
                    document.getElementById('projeAciklama').value = proje.aciklama || '';
                    
                    // Özellikleri işaretle
                    if (proje.altyapi_ozellikleri) {
                        Object.keys(proje.altyapi_ozellikleri).forEach(key => {
                            const checkbox = document.getElementById(`proje_${key}`);
                            if (checkbox) checkbox.checked = proje.altyapi_ozellikleri[key];
                        });
                    }
                    
                    if (proje.konum_ozellikleri) {
                        Object.keys(proje.konum_ozellikleri).forEach(key => {
                            const checkbox = document.getElementById(`proje_${key}`);
                            if (checkbox) checkbox.checked = proje.konum_ozellikleri[key];
                        });
                    }
                    
                    if (proje.genel_ozellikler) {
                        Object.keys(proje.genel_ozellikler).forEach(key => {
                            const checkbox = document.getElementById(`proje_${key}`);
                            if (checkbox) checkbox.checked = proje.genel_ozellikler[key];
                        });
                    }
                    
                    // Seçili ilanları ayarla
                    selectedProjeIlanlar.clear();
                    if (proje.ilanlar) {
                        Object.keys(proje.ilanlar).forEach(ilanId => {
                            selectedProjeIlanlar.add(ilanId);
                        });
                    }
                    
                    // Düzenleme modunu aktif et
                    isEditingProje = true;
                    editingProjeId = projeId;
                    
                    // Form başlığını güncelle ve göster
                    document.getElementById('projeFormTitle').textContent = 'Proje Düzenle';
                    document.getElementById('projeForm').style.display = 'block';
                    document.getElementById('projeForm').scrollIntoView({ behavior: 'smooth' });
                    
                    // Aktif ilanları yükle
                    loadAktifIlanlar();
                })
                .catch(error => {
                    console.error('Proje yüklenirken hata:', error);
                    showAlert('projeAlert', 'Proje yüklenirken bir hata oluştu!', 'error');
                });
        }

        // Proje sil
        function deleteProje(projeId) {
            if (!confirm('Bu projeyi silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.')) {
                return;
            }
            
            database.ref(`projeler/${projeId}`).remove()
                .then(() => {
                    showAlert('projeAlert', 'Proje başarıyla silindi!', 'success');
                    loadProjeList(); // Listeyi yenile
                })
                .catch(error => {
                    console.error('Proje silinirken hata:', error);
                    showAlert('projeAlert', 'Proje silinirken bir hata oluştu!', 'error');
                });
        }

        // CSS için ilan kartı stilleri ekle
        const projeStyles = document.createElement('style');
        projeStyles.textContent = `
            .ilan-card {
                background: white;
                border: 1px solid var(--border-color);
                border-radius: 8px;
                padding: 1rem;
                margin-bottom: 0.5rem;
                cursor: move;
                transition: all 0.3s ease;
            }
            
            .ilan-card:hover {
                border-color: var(--primary-color);
                box-shadow: 0 2px 8px rgba(37, 99, 235, 0.1);
            }
            
            .ilan-card.selected {
                border-color: var(--success-color);
                background-color: rgba(16, 185, 129, 0.05);
            }
            
            .ilan-card.selected:hover {
                border-color: var(--success-color);
                background-color: rgba(16, 185, 129, 0.1);
            }
        `;
        document.head.appendChild(projeStyles);

        // Global fonksiyonları dışa aktar
        window.showAddProjeForm = showAddProjeForm;
        window.hideProjeForm = hideProjeForm;
        window.saveProje = saveProje;
        window.loadProjeList = loadProjeList;
        window.editProje = editProje;
        window.deleteProje = deleteProje;
        window.allowDrop = allowDrop;
        window.dragStart = dragStart;
        window.dropIlan = dropIlan;
        window.removeIlanFromProje = removeIlanFromProje;
    </script>
</body>
</html>
